## æè¿°

### how to store token in React?

1. ç”±æ–¼é€šéç™»å…¥é©—è­‰å¾Œçš„tokenæœƒç‰½æ¶‰åˆ°è¨±å¤šé é¢å…ƒä»¶å’Œå…¶ä»–å…ƒä»¶çš„å­˜å–ï¼Œæ‰€ä»¥å¾—ä»¥app-wideå½¢å¼çš„ç‹€æ…‹ä¾†çµ¦äºˆå„å€‹å…ƒä»¶ä¾†å­˜å–


#### å…·é«”å¯¦ç¾
ä»¥app-wideå½¢å¼çš„ç‹€æ…‹ï¼Œåœ¨å¯¦ä½œä¸Šæœƒè€ƒé‡åˆ°æ¶‰åŠçš„é é¢å…ƒä»¶å’Œå…ƒä»¶æ•¸é‡è¼ƒå¤šï¼Œè‹¥è²¿ç„¶ä½¿ç”¨prop drillingå¯èƒ½ä½¿ç¼ºå¤±å› çˆ²è¦æ¨¡é—œä¿‚è€Œæ”¾å¤§ï¼Œæœƒä½¿ç”¨é›†ä¸­å„²å­˜ç‹€æ…‹å’Œè³‡è¨Šçš„å…ƒä»¶ä¾†å…±äº«tokençµ¦å„å€‹å…ƒä»¶ï¼Œå¦‚
1. ä½¿ç”¨context
2. ä½¿ç”¨Redux

å¦å¤–èªè­‰ç‹€æ…‹(å«token) æœ¬èº«ä¸¦ä¸æœƒé »ç¹åœ°æ›´æ–°ï¼Œæ‰€ä»¥å¾ˆé©åˆä½¿ç”¨åœ¨ä¸åˆ©æ–¼é »ç¹æ›´æ–°å ´æ™¯çš„Context API


### å®šç¾©èªè­‰ç‹€æ…‹çš„context object

context æœƒæœ‰çš„ç‹€æ…‹ï¼š
1. tokenï¼š
	- å‹åˆ¥ï¼šå­—ä¸²
	- ç”¨é€”ï¼šå¾ä¼ºæœå™¨çš„ç™»å…¥é©—è­‰ç²å–å‡ºä¾†çš„token
	- åˆå§‹å€¼ï¼šç©ºå­—ä¸²
2. isLoggedIn ï¼š
	- å‹åˆ¥ï¼šå¸ƒæ—å€¼
	- ç”¨é€”ï¼šè‹¥æ“æœ‰ä»»æ„tokenï¼Œå°±ç‚ºtrueï¼›è‹¥æ²’æœ‰ä»»æ„tokenï¼Œå°±ç‚ºfalseã€‚ä¸»è¦è®“å…ƒä»¶å¾é€™ç‹€æ…‹åˆ‡æ›ç™»å…¥æ™‚æˆ–è€…æœªç™»å…¥æ™‚çš„å…§å®¹ã€‚
	- åˆå§‹å€¼ï¼šfalse
4. ç”¨ä¾†æ›´æ”¹ç‹€æ…‹çš„å‡½å¼ï¼Œå¦‚æ›´æ”¹ç™»å…¥ç‹€æ…‹çš„å‡½å¼ï¼Œlogin/logout

```
import React from 'react';

const AuthContext = React.createContext({
  token: '',
  isLoggedIn: false,
  login: (token) => {},
  logout: () => {},
});

export default AuthContext;
```


#### isLoggedIn çš„åˆ¤å®šé‚è¼¯

isLoggedIn ï¼šè‹¥æ“æœ‰ä»»æ„tokenï¼Œå°±ç‚ºtrueï¼›è‹¥æ²’æœ‰ä»»æ„tokenï¼Œå°±ç‚ºfalse

åŸå› ç‚ºï¼š
1. åœ¨é€™è£¡çš„ä»»æ„tokenéƒ½ç‚ºåˆæ³•ï¼Œå› ç‚ºå–å¾—ä»»æ„tokençš„å”¯ä¸€æ¢ä»¶å°±æ˜¯é€éä¼ºæœå™¨é©—è­‰æˆåŠŸä¸¦ç²å–åˆ°çš„tokenï¼Œæ‰€ä»¥åªè¦ä¸ç‚ºnullå°±ç‚ºåˆæ³•ç™»å…¥æˆ–è€…trueï¼›å¦å‰‡ç‚ºæœªç™»å…¥ç‹€æ…‹æˆ–è€…false


#### å…·é«”å¯¦ç¾

1. è¨»å†Štokenã€isLoggedInç‹€æ…‹
```
const [token, setToken] = useState(null)
const [isLoggedIn, setIsLoggedIn] = useState(false)
```

2. å®šç¾©login å‡½å¼ï¼šè¨­å®štokenç‚ºä»»æ„token
```
1.  const loginHandler = (token) => {
2.     setToken(token);
3.  }
```

3. å®šç¾©logout å‡½å¼ï¼šè¨­å®štokenç‚ºnull
```
1.  const logoutHandler = () => {
2.      setToken(null);
3.  }
```


### ç¸½çµ

1. å¾serverç²å–permission/accessï¼Œæœƒå°‡permission/accessä»¥Reactç³»çµ±ä¾†å„²å­˜
2. åˆ©ç”¨Reactç³»çµ±æ‰€å„²å­˜çš„permission/accessä¾†åˆ·æ–°ç›®å‰ä»‹é¢ï¼Œå¦‚navigationã€header



## è¤‡ç¿’

#ğŸ§  åœ¨client-serveré–“çš„authenticationéç¨‹ä¸­ç²å–åˆ°tokenï¼Œå®¢æˆ¶ç«¯çš„Reactè©²å¦‚ä½•å„²å­˜ï¼Ÿå…ˆèªªæ¦‚å¿µ ->->-> `æœƒä»¥app-wideå½¢å¼çš„ç‹€æ…‹ä¾†å„²å­˜tokenå’Œå…¶ç™»å…¥ç‹€æ…‹`

#ğŸ§  åœ¨client-serveré–“çš„authenticationéç¨‹ä¸­ç²å–åˆ°tokenï¼Œå®¢æˆ¶ç«¯çš„Reactè©²å¦‚ä½•å„²å­˜tokenï¼Œæ¦‚å¿µä¸Šæœƒæ˜¯æœƒä»¥app-wideå½¢å¼çš„ç‹€æ…‹ä¾†å„²å­˜tokenå’Œå…¶ç™»å…¥ç‹€æ…‹ï¼Œå…·é«”æœƒæ˜¯ç”¨ä»€éº¼ï¼Ÿ ->->-> `æœƒä½¿ç”¨é›†ä¸­å„²å­˜ç‹€æ…‹å’Œè³‡è¨Šçš„å…ƒä»¶ä¾†å…±äº«tokençµ¦å„å€‹å…ƒä»¶ï¼Œå¦‚ 1. ä½¿ç”¨context 2. ä½¿ç”¨Redux`

#ğŸ§   åœ¨client-serveré–“çš„authenticationéç¨‹ä¸­ç²å–åˆ°tokenï¼Œå®¢æˆ¶ç«¯çš„Reactè©²å¦‚ä½•å„²å­˜tokenï¼Œå…¶ä¸­ç‚ºä½•æœƒä½¿ç”¨é›†ä¸­å„²å­˜ç‹€æ…‹å’Œè³‡è¨Šçš„å…ƒä»¶ä¾†å…±äº«tokençµ¦å„å€‹å…ƒä»¶ï¼Ÿ ->->-> `ä»¥app-wideå½¢å¼çš„ç‹€æ…‹ï¼Œåœ¨å¯¦ä½œä¸Šæœƒè€ƒé‡åˆ°æ¶‰åŠçš„é é¢å…ƒä»¶å’Œå…ƒä»¶æ•¸é‡è¼ƒå¤šï¼Œè‹¥è²¿ç„¶ä½¿ç”¨prop drillingå¯èƒ½ä½¿ç¼ºå¤±å› çˆ²è¦æ¨¡é—œä¿‚è€Œæ”¾å¤§`

#ğŸ§  åœ¨client-serveré–“çš„authenticationéç¨‹ä¸­ç²å–åˆ°tokenï¼Œå®¢æˆ¶ç«¯çš„Reactè©²å¦‚ä½•å„²å­˜tokenï¼Œå…¶ä¸­tokené©åˆå„²å­˜åœ¨Reactçš„Context APIæ§‹å»ºçš„å„²å­˜ç©ºé–“å—ï¼Ÿ ç‚ºä½•ï¼Ÿ->->-> `é©åˆï¼Œç”±æ–¼èªè­‰ç‹€æ…‹(å«token) æœ¬èº«ä¸¦ä¸æœƒé »ç¹åœ°æ›´æ–°ï¼Œæ‰€ä»¥å¾ˆé©åˆä½¿ç”¨åœ¨ä¸åˆ©æ–¼é »ç¹æ›´æ–°å ´æ™¯çš„Context API`


#ğŸ§  åœ¨client-serveré–“çš„authenticationéç¨‹ä¸­ç²å–åˆ°tokenï¼Œè‹¥å®šç¾©context objectçš„è©±ï¼Œæœƒæœ‰ä»€éº¼æ¨£çš„ç‹€æ…‹å’Œç‹€æ…‹æ›´æ–°å‡½å¼ï¼Ÿ ->->-> `tokenã€isLoggedInã€æ›´æ–°ç‹€æ…‹å‡½å¼æœ‰loginã€logout`

#ğŸ§  åœ¨client-serveré–“çš„authenticationéç¨‹ä¸­ç²å–åˆ°tokenï¼Œè‹¥å®šç¾©context objectçš„è©±ï¼Œæœƒæœ‰ä»€éº¼æ¨£çš„ç‹€æ…‹å’Œç‹€æ…‹æ›´æ–°å‡½å¼ï¼Ÿ ä»¥ç¨‹å¼ç¢¼ä¾†è¡¨ç¤º->->-> `tokenã€isLoggedInã€æ›´æ–°ç‹€æ…‹å‡½å¼æœ‰loginã€logout`


---
Status: #ğŸŒ± 
Tags:
[[React]] - [[Authentication]]
Links:
References: