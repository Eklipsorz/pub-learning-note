

## æè¿°

[[@LiJieOAuthRuanYiFengDeWangLuoRiZhi]]
> æŽˆæƒç æ¨¡å¼ï¼ˆauthorization codeï¼‰æ˜¯åŠŸèƒ½æœ€å®Œæ•´ã€æµç¨‹æœ€ä¸¥å¯†çš„æŽˆæƒæ¨¡å¼ã€‚å®ƒçš„ç‰¹ç‚¹å°±æ˜¯é€šè¿‡å®¢æˆ·ç«¯çš„åŽå°æœåŠ¡å™¨ï¼Œä¸Ž"æœåŠ¡æä¾›å•†"çš„è®¤è¯æœåŠ¡å™¨è¿›è¡Œäº’åŠ¨ã€‚

![æŽˆæƒç æ¨¡å¼](https://www.ruanyifeng.com/blogimg/asset/2014/bg2014051204.png)

> å®ƒçš„æ­¥éª¤å¦‚ä¸‹ï¼š

> ï¼ˆAï¼‰ç”¨æˆ·è®¿é—®å®¢æˆ·ç«¯ï¼ŒåŽè€…å°†å‰è€…å¯¼å‘è®¤è¯æœåŠ¡å™¨ã€‚
> ï¼ˆBï¼‰ç”¨æˆ·é€‰æ‹©æ˜¯å¦ç»™äºˆå®¢æˆ·ç«¯æŽˆæƒã€‚
> ï¼ˆCï¼‰å‡è®¾ç”¨æˆ·ç»™äºˆæŽˆæƒï¼Œè®¤è¯æœåŠ¡å™¨å°†ç”¨æˆ·å¯¼å‘å®¢æˆ·ç«¯äº‹å…ˆæŒ‡å®šçš„"é‡å®šå‘URI"ï¼ˆredirection URIï¼‰ï¼ŒåŒæ—¶é™„ä¸Šä¸€ä¸ªæŽˆæƒç ã€‚
> ï¼ˆDï¼‰å®¢æˆ·ç«¯æ”¶åˆ°æŽˆæƒç ï¼Œé™„ä¸Šæ—©å…ˆçš„"é‡å®šå‘URI"ï¼Œå‘è®¤è¯æœåŠ¡å™¨ç”³è¯·ä»¤ç‰Œã€‚è¿™ä¸€æ­¥æ˜¯åœ¨å®¢æˆ·ç«¯çš„åŽå°çš„æœåŠ¡å™¨ä¸Šå®Œæˆçš„ï¼Œå¯¹ç”¨æˆ·ä¸å¯è§ã€‚
> ï¼ˆEï¼‰è®¤è¯æœåŠ¡å™¨æ ¸å¯¹äº†æŽˆæƒç å’Œé‡å®šå‘URIï¼Œç¡®è®¤æ— è¯¯åŽï¼Œå‘å®¢æˆ·ç«¯å‘é€è®¿é—®ä»¤ç‰Œï¼ˆaccess tokenï¼‰å’Œæ›´æ–°ä»¤ç‰Œï¼ˆrefresh tokenï¼‰ã€‚

é‡é»žï¼š
- åœ¨é€™è£¡æœƒä»¥authorization codeå’Œç”³è«‹å…¶codeä¾†åˆ†åˆ¥ä½œç‚ºèªè­‰æŽˆæ¬Šä¼ºæœå™¨èƒ½å¤ èªå¯ä½¿ç”¨è€…æŽˆæ¬Šçš„çš„çµæžœç‰©å’Œæµç¨‹
- ç•¶ä½¿ç”¨è€…æŽˆèˆ‡å­˜å–ç¶²è·¯æœå‹™æä¾›å•†çš„æ¬Šåˆ©çµ¦æ‡‰ç”¨æœå‹™Aä¾†å­˜å–æ™‚ï¼Œå…¶æµç¨‹ç‚ºï¼š
	- A. ä½¿ç”¨è€…è¨ªå•èº«ç‚ºå®¢æˆ¶ç«¯çš„æ‡‰ç”¨æœå‹™Aï¼Œæ‡‰ç”¨æœå‹™Aå°‡ä½¿ç”¨è€…å°Žå‘ç¶²è·¯æœå‹™æä¾›å•†ä¹‹èªè­‰æŽˆæ¬Šä¼ºæœå™¨ä¾†èªè­‰ä½¿ç”¨è€…ã€è©¢å•æŽˆæ¬Šç¯„ç–‡ã€æ˜¯å¦æŽˆæ¬Š
		- ä¸»è¦ç›®çš„ï¼šé€éŽå°Žå‘æ–¹å¼ä¾†é–“æŽ¥è¦æ±‚ä½¿ç”¨è€…ç™¼é€ç›¸åŒåŒæ¨£è«‹æ±‚ä¾†å‘èªè­‰æŽˆæ¬Šä¼ºæœå™¨è¡¨ç¤ºæŽˆæ¬Šç”³è«‹
		- å…¶å°Žå‘è«‹æ±‚æœƒä»¥URL (å«URLåƒæ•¸)ã€å°åŒ… ä¾†é€²è¡Œï¼Œä¸»è¦å…§å®¹ç‚ºæŽˆæ¬Šç¨®é¡žã€æ¬Šé™ã€ç”³è«‹æŽˆæ¬Šä½œç‚ºèªè­‰ç”¨çš„é‡å°Žå‘URLï¼Œä¸¦ä¸”è½‰ç”±ä½¿ç”¨è€…ç™¼é€åŒæ¨£çš„è«‹æ±‚è‡³èªè­‰æŽˆæ¬Šä¼ºæœå™¨
	- B. ä½¿ç”¨è€…åœ¨èªè­‰é é¢åŒæ„æŽˆæ¬Šçµ¦æ‡‰ç”¨æœå‹™A
	- C. å‡è¨­ä½¿ç”¨è€…åŒæ„æŽˆæ¬Šï¼Œèªè­‰æŽˆæ¬Šä¼ºæœå™¨æœƒå°‡ä½¿ç”¨è€…å°Žå‘å®¢æˆ¶ç«¯äº‹å…ˆæŒ‡å®šçš„URIä¸¦é™„ä¸ŠæŽˆæ¬Šç¢¼
		- ä¸»è¦ç›®çš„ï¼šé€éŽå°Žå‘æ–¹å¼ä¾†é–“æŽ¥è¦æ±‚ä½¿ç”¨è€…ç™¼é€æŽˆæ¬ŠæˆåŠŸçš„çµæžœè³‡æ–™å‚³éžçµ¦æ‡‰ç”¨æœå‹™A
		- å…¶å°Žå‘è«‹æ±‚æœƒæ˜¯ä»¥URL (å«URLåƒæ•¸)ã€å°åŒ… ä¾†é€²è¡Œï¼Œä¸»è¦å…§å®¹ç‚ºæŽˆæ¬Šç¢¼ï¼Œä¸¦ä¸”è½‰ç”±ä½¿ç”¨è€…ç™¼é€åŒæ¨£çš„è«‹æ±‚è‡³å®¢æˆ¶ç«¯çš„æ‡‰ç”¨æœå‹™A
	- D. èº«ç‚ºå®¢æˆ¶ç«¯çš„æ‡‰ç”¨æœå‹™Aæœƒå¾žURIæŽ¥æ”¶åˆ°æŽˆæ¬Šç¢¼ï¼Œä¸¦å‘èªè­‰æŽˆæ¬Šä¼ºæœå™¨ä»¥è©²tokenã€redirect_uriã€client_idç™¼é€ç´¢è¦tokenè«‹æ±‚
		- ä¸»è¦ç›®çš„ï¼šè®“æ‡‰ç”¨æœå‹™Aå‘èªè­‰æŽˆæ¬Šä¼ºæœå™¨ç™¼é€ç´¢è¦tokençš„è«‹æ±‚
		- å…¶è«‹æ±‚æœƒæ˜¯ä»¥URLå’Œå…¶URLåƒæ•¸ã€å°åŒ…ä¾†é€²è¡Œï¼Œä¸»è¦æœƒé™„åŠ æŽˆæ¬Šç¢¼ã€ç•¶åˆç”³è«‹æŽˆæ¬Šç¢¼çš„é‡å°Žå‘URLã€ç•¶åˆç”³è«‹æŽˆæ¬Šç¢¼çš„client_id
	- E. èªè­‰æŽˆæ¬Šç”¨çš„ä¼ºæœå™¨æœƒå¾žä¸­é©—è­‰æŽˆæ¬Šç¢¼å’Œç•¶åˆç”³è«‹æŽˆæ¬Šç¢¼çš„é‡å°Žå‘URLæ˜¯å¦æ­£ç¢ºç„¡èª¤ï¼Œè‹¥ç„¡èª¤ï¼Œå°±æœƒå‘å®¢æˆ¶ç«¯çš„æ‡‰ç”¨æœå‹™Aç™¼é€access tokenå’Œrefresh tokenã€‚


###  æ­¥é©ŸAæ‰€éœ€çš„åƒæ•¸

[[@LiJieOAuthRuanYiFengDeWangLuoRiZhi]]
> Aæ­¥éª¤ä¸­ï¼Œå®¢æˆ·ç«¯ç”³è¯·è®¤è¯çš„URIï¼ŒåŒ…å«ä»¥ä¸‹å‚æ•°ï¼š

> -   response_typeï¼šè¡¨ç¤ºæŽˆæƒç±»åž‹ï¼Œå¿…é€‰é¡¹ï¼Œæ­¤å¤„çš„å€¼å›ºå®šä¸º"code"
> -   client_idï¼šè¡¨ç¤ºå®¢æˆ·ç«¯çš„IDï¼Œå¿…é€‰é¡¹
> -   redirect_uriï¼šè¡¨ç¤ºé‡å®šå‘URIï¼Œå¯é€‰é¡¹
> -   scopeï¼šè¡¨ç¤ºç”³è¯·çš„æƒé™èŒƒå›´ï¼Œå¯é€‰é¡¹
> -   stateï¼šè¡¨ç¤ºå®¢æˆ·ç«¯çš„å½“å‰çŠ¶æ€ï¼Œå¯ä»¥æŒ‡å®šä»»æ„å€¼ï¼Œè®¤è¯æœåŠ¡å™¨ä¼šåŽŸå°ä¸åŠ¨åœ°è¿”å›žè¿™ä¸ªå€¼ã€‚

> ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚
```http 
GET /authorize?response_type=code&client_id=s6BhdRkqt3&state=xyz
         &redirect_uri=https%3A%2F%2Fclient%2Eexample%2Ecom%2Fcb HTTP/1.1

Host: server.example.com
```


é‡é»žï¼š
- æ­¥é©ŸAï¼š ä½¿ç”¨è€…è¨ªå•èº«ç‚ºå®¢æˆ¶ç«¯çš„æ‡‰ç”¨æœå‹™Aï¼Œæ‡‰ç”¨æœå‹™Aå°‡ä½¿ç”¨è€…å°Žå‘ç¶²è·¯æœå‹™æä¾›å•†ä¹‹èªè­‰æŽˆæ¬Šä¼ºæœå™¨
- é¦–å…ˆç•¶ä½¿ç”¨è€…è¨ªå•æ‡‰ç”¨æœå‹™Aï¼Œæ‡‰ç”¨æœå‹™Aå°±æœƒä»¥ä¸‹é¢å°Žå‘è«‹æ±‚ä¾†è¦æ±‚ä½¿ç”¨è€…ç™¼é€å…¶è«‹æ±‚è‡³èªè­‰æŽˆæ¬Šä¼ºæœå™¨
	- è«‹æ±‚å½¢å¼ç‚ºï¼šURI(URIåƒæ•¸)ã€å°åŒ…
	- åƒæ•¸æœƒæœ‰ï¼š
		- response_typeï¼šç”³è«‹ä»€éº¼æ¨£çš„æŽˆæ¬Šé¡žåž‹
		- client_idï¼šæŒ‡å®šå®¢æˆ¶ç«¯çš„æ‡‰ç”¨ç¨‹å¼Aåœ¨ç¶²è·¯æœå‹™æä¾›å•†æ‰€è¨»å†Šçš„client_id
		- redirect_uriï¼šç”³è«‹ä¹‹å¾Œæ‡‰ç”¨ç¨‹å¼æŽ¥æ”¶codeçš„é‡å°Žå‘é é¢
		- scopeï¼šç”³è«‹æŽˆæ¬Šè³‡æ–™æ‰€èƒ½æ“æœ‰çš„æ¬Šé™ç‚ºä½•
		- stateï¼šè¡¨ç¤ºå®¢æˆ¶ç«¯çš„æ‡‰ç”¨ç¨‹å¼Aæ‰€æ“æœ‰çš„ç‹€æ…‹
	- ç´°ç¯€ï¼š
		- åªæœ‰response_typeã€client_idæœƒæ˜¯å¿…å¡«
		- redirect_uriç‚ºå¯é¸ï¼Œå¯ä»¥åœ¨ç¶²è·¯æœå‹™æä¾›å•†é‚£é‚Šäº‹å…ˆç”³è«‹
		- scopeç‚ºå¯é¸ï¼Œä¸»è¦æœƒä»¥æä¾›ä½¿ç”¨è€…æ±ºå®šæ¬Šé™çš„è¡¨å–®ç‚ºä¸»
		- stateç‚ºå¯é¸
```
// URL
GET /authorize?response_type=type1&client_id=id1&redirect_uri=uri1
HOST: server.example.com
```

###  æ­¥é©ŸCæ‰€éœ€çš„åƒæ•¸
> Cæ­¥éª¤ä¸­ï¼ŒæœåŠ¡å™¨å›žåº”å®¢æˆ·ç«¯çš„URIï¼ŒåŒ…å«ä»¥ä¸‹å‚æ•°ï¼š

> -   codeï¼šè¡¨ç¤ºæŽˆæƒç ï¼Œå¿…é€‰é¡¹ã€‚è¯¥ç çš„æœ‰æ•ˆæœŸåº”è¯¥å¾ˆçŸ­ï¼Œé€šå¸¸è®¾ä¸º10åˆ†é’Ÿï¼Œå®¢æˆ·ç«¯åªèƒ½ä½¿ç”¨è¯¥ç ä¸€æ¬¡ï¼Œå¦åˆ™ä¼šè¢«æŽˆæƒæœåŠ¡å™¨æ‹’ç»ã€‚è¯¥ç ä¸Žå®¢æˆ·ç«¯IDå’Œé‡å®šå‘URIï¼Œæ˜¯ä¸€ä¸€å¯¹åº”å…³ç³»ã€‚
> -   stateï¼šå¦‚æžœå®¢æˆ·ç«¯çš„è¯·æ±‚ä¸­åŒ…å«è¿™ä¸ªå‚æ•°ï¼Œè®¤è¯æœåŠ¡å™¨çš„å›žåº”ä¹Ÿå¿…é¡»ä¸€æ¨¡ä¸€æ ·åŒ…å«è¿™ä¸ªå‚æ•°ã€‚

> ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚
 ```http
HTTP/1.1 302 Found
Location: https://client.example.com/cb?code=SplxlOBeZQQYbYS6WxSbIA&state=xyz
```

é‡é»žï¼š
- æ­¥é©ŸCï¼šå‡è¨­ä½¿ç”¨è€…åŒæ„æŽˆæ¬Šï¼Œèªè­‰æŽˆæ¬Šä¼ºæœå™¨æœƒå°‡ä½¿ç”¨è€…å°Žå‘å®¢æˆ¶ç«¯äº‹å…ˆæŒ‡å®šçš„URIä¸¦é™„ä¸ŠæŽˆæ¬Šç¢¼
	- è«‹æ±‚å½¢å¼ç‚ºï¼šURI(å«URIåƒæ•¸)ã€å°åŒ…
	- åƒæ•¸æœƒæœ‰ï¼š
		- codeï¼šè¡¨ç¤ºèªè­‰æŽˆæ¬Šä¼ºæœå™¨æŽˆèˆ‡çš„æŽˆæ¬Šç¢¼ï¼Œä¸»è¦æ˜¯è¦è®“æ‡‰ç”¨æœå‹™Aç”³è«‹token
		- stateï¼šå®¢æˆ¶ç«¯ç›®å‰æ‰€è™•çš„ç‹€æ…‹ï¼Œæœƒå»¶çºŒä¸Šä¸€å€‹æ­¥é©ŸAæ‰€å‚³éžéŽä¾†çš„
	```
	HTTP/1.1 302 Found
	Location: https://client.example.com/cb?code=SplxlOBeZQQYbYS6WxSbIA&state=xyz
	```
	- åƒæ•¸ç´°ç¯€ï¼š
		- å°Žå‘çš„ç«¯é»žæ­£æ˜¯ç‚ºå®¢æˆ¶ç«¯ç”¨ä¾†æŽ¥æ”¶codeçš„é‡å°Žå‘URI
		- æŽˆæ¬Šç¢¼code å’Œ ä»£è¡¨æ¬Šé™çš„ token æ˜¯ä¸ä¸€æ¨£ï¼Œå‰è€…æ˜¯ç”¨ä¾†ç”³è«‹tokenã€‚
		- æŽˆæ¬Šç¢¼çš„é™åˆ¶ç‚ºï¼šæœ‰æ•ˆæ™‚é–“é€šå¸¸å¾ˆçŸ­ï¼Œå¦‚10åˆ†é˜ã€ç”¨ç¢¼ç”³è«‹tokençš„æ¬¡æ•¸æ˜¯æœ‰é™çš„ï¼Œå¦‚1æ¬¡ï¼Œè‹¥é•åé™åˆ¶ï¼Œå°±æœƒåœ¨ç”³è«‹tokenéŽç¨‹ä¸­è¢«æ‹’çµ•

### æ­¥é©ŸDæ‰€éœ€çš„åƒæ•¸
> Dæ­¥éª¤ä¸­ï¼Œå®¢æˆ·ç«¯å‘è®¤è¯æœåŠ¡å™¨ç”³è¯·ä»¤ç‰Œçš„HTTPè¯·æ±‚ï¼ŒåŒ…å«ä»¥ä¸‹å‚æ•°ï¼š

> -   grant_typeï¼šè¡¨ç¤ºä½¿ç”¨çš„æŽˆæƒæ¨¡å¼ï¼Œå¿…é€‰é¡¹ï¼Œæ­¤å¤„çš„å€¼å›ºå®šä¸º"authorization_code"ã€‚
> -   codeï¼šè¡¨ç¤ºä¸Šä¸€æ­¥èŽ·å¾—çš„æŽˆæƒç ï¼Œå¿…é€‰é¡¹ã€‚
> -   redirect_uriï¼šè¡¨ç¤ºé‡å®šå‘URIï¼Œå¿…é€‰é¡¹ï¼Œä¸”å¿…é¡»ä¸ŽAæ­¥éª¤ä¸­çš„è¯¥å‚æ•°å€¼ä¿æŒä¸€è‡´ã€‚
> -   client_idï¼šè¡¨ç¤ºå®¢æˆ·ç«¯IDï¼Œå¿…é€‰é¡¹ã€‚

> ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚

```http
POST /token HTTP/1.1
Host: server.example.com
Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW
Content-Type: application/x-www-form-urlencoded

grant_type=authorization_code&code=SplxlOBeZQQYbYS6WxSbIA&redirect_uri=https%3A%2F%2Fclient%2Eexample%2Ecom%2Fcb 
```

é‡é»žï¼š
- æ­¥é©ŸDï¼šèº«ç‚ºå®¢æˆ¶ç«¯çš„æ‡‰ç”¨æœå‹™Aæœƒå¾žURLæŽ¥æ”¶åˆ°æŽˆæ¬Šç¢¼ï¼Œä¸¦å‘èªè­‰æŽˆæ¬Šä¼ºæœå™¨ç™¼é€è«‹æ±‚
	- è«‹æ±‚å½¢å¼ç‚ºï¼šURI(å«URIåƒæ•¸)ã€å°åŒ…
	- åƒæ•¸æœƒæœ‰ï¼š
		- grant_typeï¼šå®šç¾©è¦ä½¿ç”¨ä½•ç¨®æ–¹å¼ä¾†æŽˆæ¬Šï¼Œé€™è£¡æœƒæ˜¯authorization_code
		- codeï¼šç”¨ä¾†ç”³è«‹tokenç”¨çš„æŽˆæ¬Šç¢¼
		- redirect_uriï¼šæ˜¯æŒ‡ç•¶åˆæ‡‰ç”¨ç¨‹å¼AæŽ¥æ”¶codeç”¨çš„é‡å°Žå‘URIï¼Œä¸»è¦æœƒèˆ‡æ­¥é©ŸAã€æ­¥é©ŸCçš„é‡å°Žå‘URIä¿æŒä¸€è‡´
		- client_idï¼šæ‡‰ç”¨ç¨‹å¼Aåœ¨èªè­‰æŽˆæ¬Šä¼ºæœå™¨ä¸­æ‰€è¨»å†Šçš„client_id
	```
	POST /token HTTP/1.1
	Host: server.example.com
	Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW
	Content-Type: application/x-www-form-urlencoded
	
	grant_type=authorization_code&code=SplxlOBeZQQYbYS6WxSbIA&redirect_uri=https%3A%2F%2Fclient%2Eexample%2Ecom%2Fcb 
	```


### æ­¥é©ŸEæ‰€éœ€çš„åƒæ•¸
> Eæ­¥éª¤ä¸­ï¼Œè®¤è¯æœåŠ¡å™¨å‘é€çš„HTTPå›žå¤ï¼ŒåŒ…å«ä»¥ä¸‹å‚æ•°ï¼š

> -   access_tokenï¼šè¡¨ç¤ºè®¿é—®ä»¤ç‰Œï¼Œå¿…é€‰é¡¹ã€‚
> -   token_typeï¼šè¡¨ç¤ºä»¤ç‰Œç±»åž‹ï¼Œè¯¥å€¼å¤§å°å†™ä¸æ•æ„Ÿï¼Œå¿…é€‰é¡¹ï¼Œå¯ä»¥æ˜¯bearerç±»åž‹æˆ–macç±»åž‹ã€‚
> -   expires_inï¼šè¡¨ç¤ºè¿‡æœŸæ—¶é—´ï¼Œå•ä½ä¸ºç§’ã€‚å¦‚æžœçœç•¥è¯¥å‚æ•°ï¼Œå¿…é¡»å…¶ä»–æ–¹å¼è®¾ç½®è¿‡æœŸæ—¶é—´ã€‚
> -   refresh_tokenï¼šè¡¨ç¤ºæ›´æ–°ä»¤ç‰Œï¼Œç”¨æ¥èŽ·å–ä¸‹ä¸€æ¬¡çš„è®¿é—®ä»¤ç‰Œï¼Œå¯é€‰é¡¹ã€‚
> -   scopeï¼šè¡¨ç¤ºæƒé™èŒƒå›´ï¼Œå¦‚æžœä¸Žå®¢æˆ·ç«¯ç”³è¯·çš„èŒƒå›´ä¸€è‡´ï¼Œæ­¤é¡¹å¯çœç•¥ã€‚

ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚

```http
HTTP/1.1 200 OK
Content-Type: application/json;charset=UTF-8
Cache-Control: no-store
Pragma: no-cache
{
	"access_token":"2YotnFZFEjr1zCsicMWpAA",
	"token_type":"example",
	"expires_in":3600,
	"refresh_token":"tGzv3JOkF0XG5Qx2TlKWIA",
	"example_parameter":"example_value"
} 
```

> ä»Žä¸Šé¢ä»£ç å¯ä»¥çœ‹åˆ°ï¼Œç›¸å…³å‚æ•°ä½¿ç”¨JSONæ ¼å¼å‘é€ï¼ˆContent-Type: application/jsonï¼‰ã€‚æ­¤å¤–ï¼ŒHTTPå¤´ä¿¡æ¯ä¸­æ˜Žç¡®æŒ‡å®šä¸å¾—ç¼“å­˜ã€‚

é‡é»žï¼š
- æ­¥é©ŸEï¼šèªè­‰æŽˆæ¬Šç”¨çš„ä¼ºæœå™¨æœƒå¾žä¸­é©—è­‰æŽˆæ¬Šç¢¼å’Œç•¶åˆç”³è«‹æŽˆæ¬Šç¢¼çš„é‡å°Žå‘URLæ˜¯å¦æ­£ç¢ºç„¡èª¤ï¼Œè‹¥ç„¡èª¤ï¼Œå°±æœƒå‘å®¢æˆ¶ç«¯çš„æ‡‰ç”¨æœå‹™Aç™¼é€access tokenå’Œrefresh tokenã€‚
- ä¸»è¦æœƒå›žå‚³ä¸€ä»½å›žæ‡‰å°åŒ…ï¼Œè£¡é¢æœƒæœ‰ï¼š
	- access_tokenï¼šè¡¨ç¤ºå…¶ä½¿ç”¨è€…æŽˆäºˆæ¬Šé™çš„token
	- token_typeï¼šè¡¨ç¤ºtokenç¨®é¡žï¼Œå¯ä»¥æ˜¯beareré¡žåž‹
	- expires_inï¼šè¡¨ç¤ºéŽæœŸæ™‚é–“ï¼Œå–®ä½ç‚ºç§’
	- refresh_tokenï¼šè¡¨ç¤ºç”¨ä¾†ç”³è«‹access-tokençš„token
	- scopeï¼šè¡¨ç¤ºaccess_tokenè¢«æŽˆèˆ‡çš„æ¬Šé™ç‚ºä½•
```
HTTP/1.1 200 OK
Content-Type: application/json;charset=UTF-8
Cache-Control: no-store
Pragma: no-cache
{
	"access_token":"2YotnFZFEjr1zCsicMWpAA",
	"token_type":"example",
	"expires_in":3600,
	"refresh_token":"tGzv3JOkF0XG5Qx2TlKWIA",
	"example_parameter":"example_value"
} 
```

## è¤‡ç¿’

#ðŸ§  authorization code grant type åœ¨OAuth ä¸Šæ˜¯ä»¥ä»€éº¼å½¢å¼ä¾†è®“èªè­‰æŽˆæ¬Šä¼ºæœå™¨èªå¯ç‚ºä½¿ç”¨è€…åˆæ³•æŽˆæ¬Šçš„çµæžœä»¥åŠå…¶æŽˆæ¬Šçµæžœçš„æµç¨‹å¤§ç¶±ï¼Ÿ ->->-> `ä»¥authorization codeçš„å½¢å¼ä»¥åŠç”³è«‹å…¶code`

#ðŸ§  authorization code grant type åœ¨OAuth ä¸Šçš„æŽˆæ¬Šæµç¨‹ç‚ºä½•ï¼Ÿåœ¨é€™è£¡æœƒæœ‰(ç¶²è·¯æœå‹™æä¾›å•†)Authorization Serverã€(æ‡‰ç”¨æœå‹™A)Clientã€(ä½¿ç”¨è€…)Resource Ownerã€User Agent ä»¥åŠ ç•¶ä½¿ç”¨è€…æŽˆèˆ‡å­˜å–ç¶²è·¯æœå‹™æä¾›å•†çš„æ¬Šåˆ©çµ¦æ‡‰ç”¨æœå‹™Aä¾†å­˜å–æ™‚->->-> `ä½¿ç”¨è€…è¨ªå•èº«ç‚ºå®¢æˆ¶ç«¯çš„æ‡‰ç”¨æœå‹™Aï¼Œæ‡‰ç”¨æœå‹™Aå°‡ä½¿ç”¨è€…å°Žå‘ç¶²è·¯æœå‹™æä¾›å•†ä¹‹èªè­‰æŽˆæ¬Šä¼ºæœå™¨ä¾†èªè­‰ä½¿ç”¨è€…ã€è©¢å•æŽˆæ¬Šç¯„ç–‡ã€æ˜¯å¦æŽˆæ¬Š -> ä½¿ç”¨è€…åœ¨èªè­‰é é¢åŒæ„æŽˆæ¬Šçµ¦æ‡‰ç”¨æœå‹™A -> å‡è¨­ä½¿ç”¨è€…åŒæ„æŽˆæ¬Šï¼Œèªè­‰æŽˆæ¬Šä¼ºæœå™¨æœƒå°‡ä½¿ç”¨è€…å°Žå‘å®¢æˆ¶ç«¯äº‹å…ˆæŒ‡å®šçš„URIä¸¦é™„ä¸ŠæŽˆæ¬Šç¢¼ -> èº«ç‚ºå®¢æˆ¶ç«¯çš„æ‡‰ç”¨æœå‹™Aæœƒå¾žURIæŽ¥æ”¶åˆ°æŽˆæ¬Šç¢¼ï¼Œä¸¦å‘èªè­‰æŽˆæ¬Šä¼ºæœå™¨ä»¥è©²tokenã€redirect_uriã€client_idç™¼é€ç´¢è¦tokemè«‹æ±‚ -> èªè­‰æŽˆæ¬Šç”¨çš„ä¼ºæœå™¨æœƒå¾žä¸­é©—è­‰æŽˆæ¬Šç¢¼å’Œç•¶åˆç”³è«‹æŽˆæ¬Šç¢¼çš„é‡å°Žå‘URLæ˜¯å¦æ­£ç¢ºç„¡èª¤ï¼Œè‹¥ç„¡èª¤ï¼Œå°±æœƒå‘å®¢æˆ¶ç«¯çš„æ‡‰ç”¨æœå‹™Aç™¼é€access tokenå’Œrefresh tokenã€‚`

#ðŸ§  authorization code grant type åœ¨OAuth ä¸Šçš„æŽˆæ¬Šæµç¨‹ä¸­ï¼š"ä½¿ç”¨è€…è¨ªå•èº«ç‚ºå®¢æˆ¶ç«¯çš„æ‡‰ç”¨æœå‹™Aï¼Œæ‡‰ç”¨æœå‹™Aå°‡ä½¿ç”¨è€…å°Žå‘ç¶²è·¯æœå‹™æä¾›å•†ä¹‹èªè­‰æŽˆæ¬Šä¼ºæœå™¨ä¾†èªè­‰ä½¿ç”¨è€…ã€è©¢å•æŽˆæ¬Šç¯„ç–‡ã€æ˜¯å¦æŽˆæ¬Š"ï¼Œå°Žå‘å’Œä¸»è¦ç›®çš„çš„é—œä¿‚æ˜¯å¦‚ä½•ï¼Ÿ ->->-> `é€éŽå°Žå‘æ–¹å¼ä¾†é–“æŽ¥è¦æ±‚ä½¿ç”¨è€…ç™¼é€ç›¸åŒåŒæ¨£è«‹æ±‚ä¾†å‘èªè­‰æŽˆæ¬Šä¼ºæœå™¨è¡¨ç¤ºæŽˆæ¬Šç”³è«‹`

#ðŸ§  authorization code grant type åœ¨OAuth ä¸Šçš„æŽˆæ¬Šæµç¨‹ä¸­ï¼š"å‡è¨­ä½¿ç”¨è€…åŒæ„æŽˆæ¬Šï¼Œèªè­‰æŽˆæ¬Šä¼ºæœå™¨æœƒå°‡ä½¿ç”¨è€…å°Žå‘å®¢æˆ¶ç«¯äº‹å…ˆæŒ‡å®šçš„URIä¸¦é™„ä¸ŠæŽˆæ¬Šç¢¼"ï¼Œå°Žå‘å’Œä¸»è¦ç›®çš„çš„é—œä¿‚æ˜¯å¦‚ä½•ï¼Ÿ->->-> `é€éŽå°Žå‘æ–¹å¼ä¾†é–“æŽ¥è¦æ±‚ä½¿ç”¨è€…ç™¼é€æŽˆæ¬ŠæˆåŠŸçš„çµæžœè³‡æ–™å‚³éžçµ¦æ‡‰ç”¨æœå‹™A`

#ðŸ§  authorization code grant type åœ¨OAuth ä¸Šçš„æŽˆæ¬Šæµç¨‹ä¸­ï¼š"èº«ç‚ºå®¢æˆ¶ç«¯çš„æ‡‰ç”¨æœå‹™Aæœƒå¾žURIæŽ¥æ”¶åˆ°æŽˆæ¬Šç¢¼ï¼Œä¸¦å‘èªè­‰æŽˆæ¬Šä¼ºæœå™¨ä»¥è©²tokenã€redirect_uriã€client_idç™¼é€ç´¢è¦tokenè«‹æ±‚"ï¼Œå°Žå‘å’Œä¸»è¦ç›®çš„çš„é—œä¿‚æ˜¯å¦‚ä½•ï¼Ÿ->->-> `è®“æ‡‰ç”¨æœå‹™Aå‘èªè­‰æŽˆæ¬Šä¼ºæœå™¨ç™¼é€ç´¢è¦tokençš„è«‹æ±‚`

#ðŸ§  authorization code grant type åœ¨OAuth ä¸Šçš„æŽˆæ¬Šæµç¨‹ä¸­ï¼š"ä½¿ç”¨è€…è¨ªå•èº«ç‚ºå®¢æˆ¶ç«¯çš„æ‡‰ç”¨æœå‹™Aï¼Œæ‡‰ç”¨æœå‹™Aå°‡ä½¿ç”¨è€…å°Žå‘ç¶²è·¯æœå‹™æä¾›å•†ä¹‹èªè­‰æŽˆæ¬Šä¼ºæœå™¨ä¾†èªè­‰ä½¿ç”¨è€…ã€è©¢å•æŽˆæ¬Šç¯„ç–‡ã€æ˜¯å¦æŽˆæ¬Š"ï¼Œæ‡‰ç”¨æœå‹™Aç™¼é€éŽä¾†çš„å°Žå‘è«‹æ±‚å½¢å¼æœƒæ˜¯ä»€éº¼ï¼Ÿå…§å®¹åˆæœƒæ˜¯ä»€éº¼ï¼Ÿå°æ–¼ä½¿ç”¨è€…ä¾†èªªæ˜¯ä»€éº¼æ„æ€ ->->-> `å…¶å°Žå‘è«‹æ±‚æœƒæ˜¯ä»¥URL (å«URLåƒæ•¸)ã€å°åŒ… ä¾†é€²è¡Œï¼Œä¸»è¦å…§å®¹ç‚ºæŽˆæ¬Šç¢¼ï¼Œä¸¦ä¸”è½‰ç”±ä½¿ç”¨è€…ç™¼é€åŒæ¨£çš„è«‹æ±‚è‡³å®¢æˆ¶ç«¯çš„æ‡‰ç”¨æœå‹™A`

#ðŸ§  authorization code grant type åœ¨OAuth ä¸Šçš„æŽˆæ¬Šæµç¨‹ä¸­ï¼š"å‡è¨­ä½¿ç”¨è€…åŒæ„æŽˆæ¬Šï¼Œèªè­‰æŽˆæ¬Šä¼ºæœå™¨æœƒå°‡ä½¿ç”¨è€…å°Žå‘å®¢æˆ¶ç«¯äº‹å…ˆæŒ‡å®šçš„URIä¸¦é™„ä¸ŠæŽˆæ¬Šç¢¼"ï¼Œèªè­‰æŽˆæ¬Šä¼ºæœå™¨ç™¼é€éŽä¾†çš„å°Žå‘è«‹æ±‚å½¢å¼æœƒæ˜¯ä»€éº¼ï¼Ÿå…§å®¹åˆæœƒæ˜¯ä»€éº¼ï¼Ÿå°æ–¼ä½¿ç”¨è€…ä¾†èªªæ˜¯ä»€éº¼æ„æ€?->->-> ` å…¶å°Žå‘è«‹æ±‚æœƒæ˜¯ä»¥URL (å«URLåƒæ•¸)ã€å°åŒ… ä¾†é€²è¡Œï¼Œä¸»è¦å…§å®¹ç‚ºæŽˆæ¬Šç¢¼ï¼Œä¸¦ä¸”è½‰ç”±ä½¿ç”¨è€…ç™¼é€åŒæ¨£çš„è«‹æ±‚è‡³å®¢æˆ¶ç«¯çš„æ‡‰ç”¨æœå‹™A`


#ðŸ§  authorization code grant type åœ¨OAuth ä¸Šçš„æŽˆæ¬Šæµç¨‹ä¸­ï¼š"èº«ç‚ºå®¢æˆ¶ç«¯çš„æ‡‰ç”¨æœå‹™Aæœƒå¾žURIæŽ¥æ”¶åˆ°æŽˆæ¬Šç¢¼ï¼Œä¸¦å‘èªè­‰æŽˆæ¬Šä¼ºæœå™¨ä»¥è©²tokenã€redirect_uriã€client_idç™¼é€ç´¢è¦tokenè«‹æ±‚"ï¼Œæ‡‰ç”¨æœå‹™Aç™¼é€éŽä¾†çš„å°Žå‘è«‹æ±‚å½¢å¼æœƒæ˜¯ä»€éº¼ï¼Ÿå…§å®¹åˆæœƒæ˜¯ä»€éº¼ï¼Ÿ->->-> `å…¶è«‹æ±‚æœƒæ˜¯ä»¥URLå’Œå…¶URLåƒæ•¸ã€å°åŒ…ä¾†é€²è¡Œï¼Œä¸»è¦æœƒé™„åŠ æŽˆæ¬Šç¢¼ã€ç•¶åˆç”³è«‹æŽˆæ¬Šç¢¼çš„é‡å°Žå‘URLã€ç•¶åˆç”³è«‹æŽˆæ¬Šç¢¼çš„client_id`

#ðŸ§  authorization code grant type åœ¨OAuth ä¸Šçš„æŽˆæ¬Šæµç¨‹ä¸­ï¼š"ä½¿ç”¨è€…è¨ªå•èº«ç‚ºå®¢æˆ¶ç«¯çš„æ‡‰ç”¨æœå‹™Aï¼Œæ‡‰ç”¨æœå‹™Aå°‡ä½¿ç”¨è€…å°Žå‘ç¶²è·¯æœå‹™æä¾›å•†ä¹‹èªè­‰æŽˆæ¬Šä¼ºæœå™¨ä¾†èªè­‰ä½¿ç”¨è€…ã€è©¢å•æŽˆæ¬Šç¯„ç–‡ã€æ˜¯å¦æŽˆæ¬Š"ï¼Œé€™æ­¥é©Ÿæ‰€ç™¼é€çš„è«‹æ±‚æ˜¯å¾žä½•è€Œä¾† ->->-> `å¾žæ‡‰ç”¨æœå‹™Aç™¼é€éŽä¾†çš„è«‹æ±‚ï¼Œä»¥æŒ‡å®šçš„è«‹æ±‚å°åŒ…å…§å®¹ä¾†è¦æ±‚ä½¿ç”¨è€…å‘èªè­‰æŽˆæ¬Šä¼ºæœå™¨ç™¼é€`

#ðŸ§  authorization code grant type åœ¨OAuth ä¸Šçš„æŽˆæ¬Šæµç¨‹ä¸­ï¼š"ä½¿ç”¨è€…è¨ªå•èº«ç‚ºå®¢æˆ¶ç«¯çš„æ‡‰ç”¨æœå‹™Aï¼Œæ‡‰ç”¨æœå‹™Aå°‡ä½¿ç”¨è€…å°Žå‘ç¶²è·¯æœå‹™æä¾›å•†ä¹‹èªè­‰æŽˆæ¬Šä¼ºæœå™¨ä¾†èªè­‰ä½¿ç”¨è€…ã€è©¢å•æŽˆæ¬Šç¯„ç–‡ã€æ˜¯å¦æŽˆæ¬Š"ï¼Œé€™æ­¥é©Ÿæ‰€éœ€è¦çš„åƒæ•¸ç‚ºä½•ï¼Ÿ ->->-> `response_typeï¼šç”³è«‹ä»€éº¼æ¨£çš„æŽˆæ¬Šé¡žåž‹ - client_idï¼šæŒ‡å®šå®¢æˆ¶ç«¯çš„æ‡‰ç”¨ç¨‹å¼Aåœ¨ç¶²è·¯æœå‹™æä¾›å•†æ‰€è¨»å†Šçš„client_id - redirect_uriï¼šç”³è«‹ä¹‹å¾Œæ‡‰ç”¨ç¨‹å¼æŽ¥æ”¶codeçš„é‡å°Žå‘é é¢ - scopeï¼šç”³è«‹æŽˆæ¬Šè³‡æ–™æ‰€èƒ½æ“æœ‰çš„æ¬Šé™ç‚ºä½• - stateï¼šè¡¨ç¤ºå®¢æˆ¶ç«¯çš„æ‡‰ç”¨ç¨‹å¼Aæ‰€æ“æœ‰çš„ç‹€æ…‹`


#ðŸ§  authorization code grant type åœ¨OAuth ä¸Šçš„æŽˆæ¬Šæµç¨‹ä¸­ï¼š"ä½¿ç”¨è€…è¨ªå•èº«ç‚ºå®¢æˆ¶ç«¯çš„æ‡‰ç”¨æœå‹™Aï¼Œæ‡‰ç”¨æœå‹™Aå°‡ä½¿ç”¨è€…å°Žå‘ç¶²è·¯æœå‹™æä¾›å•†ä¹‹èªè­‰æŽˆæ¬Šä¼ºæœå™¨ä¾†èªè­‰ä½¿ç”¨è€…ã€è©¢å•æŽˆæ¬Šç¯„ç–‡ã€æ˜¯å¦æŽˆæ¬Š"ï¼Œé€™æ­¥é©Ÿæ‰€éœ€è¦çš„å¿…å¡«åƒæ•¸æœƒæ˜¯ä»€éº¼ï¼Ÿ ->->-> `response_typeã€client_id`

#ðŸ§  authorization code grant type åœ¨OAuth ä¸Šçš„æŽˆæ¬Šæµç¨‹ä¸­ï¼š"ä½¿ç”¨è€…è¨ªå•èº«ç‚ºå®¢æˆ¶ç«¯çš„æ‡‰ç”¨æœå‹™Aï¼Œæ‡‰ç”¨æœå‹™Aå°‡ä½¿ç”¨è€…å°Žå‘ç¶²è·¯æœå‹™æä¾›å•†ä¹‹èªè­‰æŽˆæ¬Šä¼ºæœå™¨ä¾†èªè­‰ä½¿ç”¨è€…ã€è©¢å•æŽˆæ¬Šç¯„ç–‡ã€æ˜¯å¦æŽˆæ¬Š"ï¼Œé€™æ­¥é©Ÿæ‰€éœ€è¦çš„åƒæ•¸-redirect_uriç‚ºä½•æ˜¯å¯é¸å¡«åƒæ•¸ï¼Ÿ ->->-> `redirect_uriç‚ºå¯é¸ï¼Œå¯ä»¥åœ¨ç¶²è·¯æœå‹™æä¾›å•†é‚£é‚Šäº‹å…ˆç”³è«‹`

#ðŸ§  authorization code grant type åœ¨OAuth ä¸Šçš„æŽˆæ¬Šæµç¨‹ä¸­ï¼š"ä½¿ç”¨è€…è¨ªå•èº«ç‚ºå®¢æˆ¶ç«¯çš„æ‡‰ç”¨æœå‹™Aï¼Œæ‡‰ç”¨æœå‹™Aå°‡ä½¿ç”¨è€…å°Žå‘ç¶²è·¯æœå‹™æä¾›å•†ä¹‹èªè­‰æŽˆæ¬Šä¼ºæœå™¨ä¾†èªè­‰ä½¿ç”¨è€…ã€è©¢å•æŽˆæ¬Šç¯„ç–‡ã€æ˜¯å¦æŽˆæ¬Š"ï¼Œé€™æ­¥é©Ÿæ‰€éœ€è¦çš„åƒæ•¸-scopeç‚ºä½•æ˜¯å¯é¸å¡«åƒæ•¸ï¼Ÿ ->->-> `ç”³è«‹æŽˆæ¬Šè³‡æ–™æ‰€èƒ½æ“æœ‰çš„æ¬Šé™ç‚ºä½•`


#ðŸ§  authorization code grant type åœ¨OAuth ä¸Šçš„æŽˆæ¬Šæµç¨‹ä¸­ï¼š"ä½¿ç”¨è€…è¨ªå•èº«ç‚ºå®¢æˆ¶ç«¯çš„æ‡‰ç”¨æœå‹™Aï¼Œæ‡‰ç”¨æœå‹™Aå°‡ä½¿ç”¨è€…å°Žå‘ç¶²è·¯æœå‹™æä¾›å•†ä¹‹èªè­‰æŽˆæ¬Šä¼ºæœå™¨ä¾†èªè­‰ä½¿ç”¨è€…ã€è©¢å•æŽˆæ¬Šç¯„ç–‡ã€æ˜¯å¦æŽˆæ¬Š"ï¼Œå¾žæ‡‰ç”¨æœå‹™Aç™¼é€éŽä¾†çš„å°Žå‘è«‹æ±‚æœƒæ˜¯ä»€éº¼ï¼Ÿèˆ‰ä¾‹ä¾†èªªï¼Œå‡å¦‚èªè­‰æŽˆæ¬Šä¼ºæœå™¨ç‚ºserver.example.comï¼Œç«¯é»žç‚ºauthorize ->->-> ``





---
Status: #ðŸŒ± 
Tags:
[[OAuth]]
Links:
References:
[[@OAuthGrantTypes]]
[[@LiJieOAuthRuanYiFengDeWangLuoRiZhi]]




