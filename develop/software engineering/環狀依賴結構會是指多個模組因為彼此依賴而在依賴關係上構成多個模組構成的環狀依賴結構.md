## æè¿°
[[@wikidataCircularDependency2021]] æ‰€æè¿°ï¼š
> In software engineering, a circular dependency is a relation between two or more modules which either directly or indirectly depend on each other to function properly.

é‡é»ï¼š
- åœ¨è»Ÿé«”å·¥ç¨‹æ˜¯æŒ‡ï¼Œç’°ç‹€ä¾è³´çµæ§‹æœƒæ˜¯æŒ‡å¤šå€‹æ¨¡çµ„å› ç‚ºå½¼æ­¤ä¾è³´è€Œåœ¨ä¾è³´é—œä¿‚ä¸Šæ§‹æˆå¤šå€‹æ¨¡çµ„æ§‹æˆçš„ç’°ç‹€ä¾è³´çµæ§‹(circular dependency)
- èƒŒæ™¯ï¼š
	- æ¨¡çµ„ä¾è³´é€šå¸¸é‹ç”¨åšåˆ†ææ¨¡çµ„ä¹‹é–“çš„ä¾è³´é—œä¿‚ï¼Œè€Œè½‰æ›æˆæ¨¡çµ„ä¾è³´åœ–ä¾†è¡¨ç¤ºï¼Œç”±æ¨¡çµ„Aå’Œè©²æ¨¡çµ„Aæ‰€ä¾è³´çš„æ¨¡çµ„Bæ§‹æˆåœ–ç‹€ä¾†é€£æ¥ï¼Œç„¶å¾Œåœ¨ç”±æ¨¡çµ„Bä¾è³´çš„æ¨¡çµ„Cä¾†é€£æ¥ï¼Œå¾ŒçºŒä¾æ­¤é¡æ¨

![](https://res.cloudinary.com/dqfxgtyoi/image/upload/v1659203325/blog/javascript/module/cyclic-dependecy-example_dmfgnv.png)



![](https://res.cloudinary.com/dqfxgtyoi/image/upload/v1659203324/blog/javascript/module/cyclic-dependecy-solution-example_y97fcp.png)



### cyclic dependency detect & solve

è§£æ³•å¯åƒè€ƒ[[@DetectCycleDirected2012]]

ç•¶æ¨¡çµ„ä¾è³´é—œä¿‚åœ–ä¸Šç™¼ç”Ÿç’°ç‹€ä¾è³´çš„è©±
- èƒŒæ™¯ï¼šç”±æ–¼é—œä¿‚åœ–æœƒæ˜¯ä¾æ“šDepth First Post-Order Traversalä¾†æ‰¾åˆ°åœ–ä¸­æœ€åº•éƒ¨çš„æ¨¡çµ„-æ²’ä¾è³´å…¶ä»–æ¨¡çµ„çš„æ¨¡çµ„ä¾†å„ªå…ˆå»ºç«‹å°æ‡‰å¯¦ä¾‹/åŸ·è¡Œæ¨¡çµ„å…§å®¹ä¾†è³¦äºˆå¯¦éš›å€¼çµ¦è©²æ¨¡çµ„æ‰€è¦è¼¸å‡ºçš„å…§å®¹
- å•é¡Œï¼šç’°ç‹€ä¾è³´æœƒä½¿ç®—æ³•ç„¡é™å¾ªç’°å»éæ­·è€Œç„¡æ³•æ­£ç¢ºæ‰¾åˆ°æœ€åº•éƒ¨çš„æ¨¡çµ„-æ²’ä¾è³´å…¶ä»–æ¨¡çµ„çš„æ¨¡çµ„
[![A commonJS module, with a variable being exported from main.js after a require statement to counter.js, which depends on that import](https://2r4s9p1yi1fa2jd7j43zph8r-wpengine.netdna-ssl.com/files/2018/03/41_cyclic_graph-500x281.png)](https://2r4s9p1yi1fa2jd7j43zph8r-wpengine.netdna-ssl.com/files/2018/03/41_cyclic_graph.png)
- è§£æ³•ï¼š
	- å…ˆä½¿ç”¨DFSç‚ºä¸»çš„ç’°ç‹€ä¾è³´åµæ¸¬ç®—æ³•
	- è‹¥ç®—æ³•å¾—å‡ºæœ‰å¾ªç’°ï¼Œå°±ä»¥æœ€å¾Œä¸€å€‹å¾æœªéæ­·çš„æ¨¡çµ„ä½œç‚ºæœ€å¾Œä¸€å€‹æ¨¡çµ„
	- è‹¥ç®—æ³•å¾—å‡ºæ²’å¾ªç’°ï¼Œå°±çµæŸ
- èˆ‰ä¾‹ï¼š
	- case1 æ˜¯main.jså’ŒM2äº’ç›¸ä¾è³´çš„æ¨¡çµ„
	- case2 æ˜¯mainã€M1ã€M2ã€M3ä¹‹é–“æ‰€æ§‹æˆçš„ç’°ç‹€ä¾è³´
	- case3 æ˜¯è¼ƒç‚ºè¤‡é›œä¾è³´çš„æ¨¡çµ„


![](https://res.cloudinary.com/dqfxgtyoi/image/upload/v1659203325/blog/javascript/module/cyclic-dependecy-example_dmfgnv.png)


èˆ‰ä¾‹è§£æ³•ï¼š
	- case1ä¸­æœƒè¢«åˆ¤å®šæœ‰å¾ªç’°ï¼Œä¸¦ä¸”æŒ‘M2ä½œç‚ºæœ€å¾Œä¸€å€‹å¾æœªéæ­·çš„æ¨¡çµ„è€Œæ‹†è§£M2å°æ–¼mainçš„å–®æ–¹é¢ä¾è³´é—œä¿‚ï¼Œæœ€å¾Œçµæœå¦‚case1
	- case2ä¸­æœƒè¢«åˆ¤å®šæœ‰å¾ªç’°ï¼Œä¸¦ä¸”æŒ‘M3ä½œç‚ºæœ€å¾Œä¸€å€‹å¾æœªéæ­·çš„æ¨¡çµ„è€Œæ‹†è§£M3å°æ–¼mainçš„å–®æ–¹é¢ä¾è³´é—œä¿‚ï¼Œæœ€å¾Œçµæœå¦‚case2
	- case3ä¸­æœƒè¢«åˆ¤å®šæœ‰å¾ªç’°ï¼Œä¸¦ä¸”æŒ‘M3ä½œç‚ºæœ€å¾Œä¸€å€‹å¾æœªéæ­·çš„æ¨¡çµ„è€Œæ‹†è§£M3å°æ–¼mainçš„å–®æ–¹é¢ä¾è³´é—œä¿‚ï¼Œæœ€å¾Œçµæœå¦‚case3


![](https://res.cloudinary.com/dqfxgtyoi/image/upload/v1659203324/blog/javascript/module/cyclic-dependecy-solution-example_y97fcp.png)



## è¤‡ç¿’
#ğŸ§  circular dependencyæ˜¯ä»€éº¼ï¼Ÿ ->->-> `ç’°ç‹€ä¾è³´çµæ§‹æœƒæ˜¯æŒ‡å¤šå€‹æ¨¡çµ„å› ç‚ºå½¼æ­¤ä¾è³´è€Œåœ¨ä¾è³´é—œä¿‚ä¸Šæ§‹æˆå¤šå€‹æ¨¡çµ„æ§‹æˆçš„ç’°ç‹€ä¾è³´çµæ§‹(circular dependency)`
<!--SR:!2022-11-23,74,250-->
#ğŸ§  ç•«å€‹åœ–ä¾†èªªæ˜circular dependencyï¼Œè«‹ç”¨mainæ¨¡çµ„å’ŒM2æ¨¡çµ„ ->->-> `![](https://res.cloudinary.com/dqfxgtyoi/image/upload/v1659203325/blog/javascript/module/cyclic-dependecy-example_dmfgnv.png)`
<!--SR:!2022-11-13,66,250-->

#ğŸ§  ç•«å€‹åœ–ä¾†èªªæ˜circular dependencyï¼Œè«‹ç”¨mainæ¨¡çµ„ã€M1æ¨¡çµ„ã€M2æ¨¡çµ„ã€M3æ¨¡çµ„ ->->-> `![](https://res.cloudinary.com/dqfxgtyoi/image/upload/v1659203325/blog/javascript/module/cyclic-dependecy-example_dmfgnv.png)`
<!--SR:!2022-11-23,74,250-->

#ğŸ§  ç•«å€‹åœ–ä¾†èªªæ˜circular dependencyï¼Œè«‹ç”¨mainæ¨¡çµ„ã€M1æ¨¡çµ„ã€M2æ¨¡çµ„ã€M3æ¨¡çµ„ã€M4æ¨¡çµ„ï¼Œå…¶ä¸­M4æ¨¡çµ„ä¸¦ä¸åœ¨ç’°ç‹€çµæ§‹ ->->-> `![](https://res.cloudinary.com/dqfxgtyoi/image/upload/v1659203325/blog/javascript/module/cyclic-dependecy-example_dmfgnv.png)`
<!--SR:!2022-11-20,72,250-->

#ğŸ§  æ¨¡çµ„ä¾è³´èƒ½ç”¨ä»€éº¼çµæ§‹ä¾†è¡¨ç¤ºï¼Ÿå…·é«”å¦‚ä½•è¡¨ç¤ºï¼Ÿ->->-> `æ¨¡çµ„ä¾è³´é€šå¸¸é‹ç”¨åšåˆ†ææ¨¡çµ„ä¹‹é–“çš„ä¾è³´é—œä¿‚ï¼Œè€Œè½‰æ›æˆæ¨¡çµ„ä¾è³´åœ–ä¾†è¡¨ç¤ºï¼Œç”±æ¨¡çµ„Aå’Œè©²æ¨¡çµ„Aæ‰€ä¾è³´çš„æ¨¡çµ„Bæ§‹æˆåœ–ç‹€ä¾†é€£æ¥ï¼Œç„¶å¾Œåœ¨ç”±æ¨¡çµ„Bä¾è³´çš„æ¨¡çµ„Cä¾†é€£æ¥ï¼Œå¾ŒçºŒä¾æ­¤é¡æ¨`
<!--SR:!2022-09-11,27,250-->


#ğŸ§  æ¨¡çµ„ä¾è³´çš„ç”¨é€”æ˜¯ä»€éº¼ ->->-> `åˆ†ææ¨¡çµ„é–“çš„ä¾è³´é—œä¿‚`
<!--SR:!2022-11-21,72,250-->


#ğŸ§  è‹¥ä½¿ç”¨æ¨¡çµ„ä¾è³´åœ–ä¾†å„ªå…ˆå°æ²’ä¾è³´ä»»ä½•æ¨¡çµ„çš„æ¨¡çµ„é€²è¡Œå¯¦ä¾‹åŒ–ï¼Œä½†ç™¼ç”Ÿç’°ç‹€ä¾è³´çµæ§‹ï¼Œè‹¥ä¸è™•ç†æœƒç™¼ç”Ÿä»€éº¼ï¼Ÿ->->-> `ç’°ç‹€ä¾è³´æœƒä½¿ç®—æ³•ç„¡é™å¾ªç’°å»éæ­·è€Œç„¡æ³•æ­£ç¢ºæ‰¾åˆ°æœ€åº•éƒ¨çš„æ¨¡çµ„-æ²’ä¾è³´å…¶ä»–æ¨¡çµ„çš„æ¨¡çµ„`
<!--SR:!2022-11-11,65,250-->




---
Status: #ğŸŒ± 
Tags:
 [[Software Engineering]]
Links:
[[es-modules-a-cartoon-deep-dive(5) - Evaluation ç­†è¨˜]]
References:
[[@DetectCycleDirected2012]]
[[@wikidataCircularDependency2021]]