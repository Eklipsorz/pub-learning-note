## æè¿°


åœ¨Promise APIæ™‚ä»£å‰ï¼Œcallbackäº¤çµ¦ä»»å‹™Aä¾†åŸ·è¡Œæ‰€å¸¶æœ‰çš„ç–‘æ…®ï¼š
- å¤ªæ—©åŸ·è¡Œcallbackï¼šç•¶åŸ·è¡Œä»»å‹™Aæ™‚ï¼Œcallbackæ˜¯å¦å°±è·Ÿè‘—ä»»å‹™Açš„åŸ·è¡Œè€Œè·Ÿè‘—åŸ·è¡Œï¼Ÿ
- å¤ªæ™šåŸ·è¡Œcallbackï¼šè‹¥ä»»å‹™Aæ˜¯ä»¥éžåŒæ­¥ä¾†åŸ·è¡Œcallbackï¼Œé€™æœƒå› çˆ²æŽ’ç¨‹ç·£æ•…è€Œä½¿callbackçš„åŸ·è¡Œè¢«æŽ’åˆ°å¾ˆå¾Œé ­ï¼Œç”šè‡³è¢«å…¶ä»–ä»»å‹™çµ¦æ’éšŠåŸ·è¡Œï¼Œç„¡æ³•åŠæ™‚ä»¥é©ç•¶çš„æ™‚æ©Ÿé»žåŸ·è¡Œã€‚
- å‘¼å«callbackçš„æ¬¡æ•¸è¶…éŽä¸€æ¬¡æˆ–è€…æ²’å‘¼å«callback
- æ²’æœ‰å‚³å…¥ä»»ä½•å¿…è¦çš„åƒæ•¸å’Œç’°å¢ƒçµ¦callbackï¼šè‹¥callbackæ˜¯ä»¥éžåŒæ­¥ä»»å‹™ä¾†åŸ·è¡Œï¼Œå…¶åƒæ•¸æ˜¯å¦æœƒä»¥ä»»å‹™Açš„åŸ·è¡Œçµæžœç‚ºä¸»ä¸¦åŠ ä»¥è™•ç†ï¼Ÿ
- å› callbackåŸ·è¡Œæ™‚æ‹‹å‡ºéŒ¯èª¤è€Œç”¢ç”Ÿé æœŸå¤–çš„çµæžœï¼Œæ¯”å¦‚åžæŽ‰callbackåŸ·è¡Œæ™‚æ‹‹å‡ºçš„éŒ¯èª¤æˆ–è€…ä¾‹å¤–ï¼ŒéžåŒæ­¥ä»»å‹™AåŸ·è¡Œcallbackæ™‚æ‹‹å‡ºéŒ¯èª¤ï¼Œä½†æ²’æœ‰éŒ¯èª¤è™•ç†ä¾†è™•ç†ã€å› ç³»çµ±æŽ¥å—åˆ°éŒ¯èª¤è€ŒæŽ¡å–é è¨­çš„éŒ¯èª¤è™•ç†ï¼Œè€ŒéŒ¯èª¤è™•ç†æ˜¯ä»¥åŒæ­¥åŸ·è¡Œä¾†åŸ·è¡Œï¼Œè€Œcallbackæ˜¯ä»¥éžåŒæ­¥ä¾†åŸ·è¡Œï¼Œé¡¯ç„¶æœƒä½¿callbackæ•´é«”è®ŠæˆZalgo


åœ¨Promise ä¸­åˆ†åˆ¥é‡å°é€™å¹¾å€‹å•é¡Œä¾†å¢žå¼·åŸ·è¡Œcallbackçš„è¢«ä¿¡ä»»ç¨‹åº¦

### å¤ªæ—©åŸ·è¡Œcallback

> å¤ªæ—©åŸ·è¡Œcallbackï¼šç•¶åŸ·è¡Œä»»å‹™Aæ™‚ï¼Œcallbackæ˜¯å¦å°±è·Ÿè‘—ä»»å‹™Açš„åŸ·è¡Œè€Œè·Ÿè‘—åŸ·è¡Œï¼Ÿ


åœ¨Promiseä¸­ï¼Œcallbackåªè¦æ”¾å…¥Promise APIä¸‹çš„thenã€catchã€finallyé€™äº›èªžæ³•çš„è©±ï¼Œå°±æœƒä»¥éžåŒæ­¥ä¾†åŸ·è¡Œcallback
```
Promise(...)
.then(callback);
```

å¦å¤–å³ä½¿PromiseæŒ‡å®šä»»å‹™æ˜¯ç«‹å³æœƒå±¥è¡Œçš„ä»»å‹™ï¼Œå¦‚ä»¥ä¸‹ï¼Œcallbackä»ä»¥éžåŒæ­¥ä»»å‹™åž‹å¼ä¾†è¢«æŽ’ç¨‹åŽ»åŸ·è¡Œã€‚
```
new Promise((resolve, reject) => {
	resolve(10);
})
.then(callback);
```

### å¤ªæ™šåŸ·è¡Œcallback

> å¤ªæ™šåŸ·è¡Œcallbackï¼šè‹¥ä»»å‹™Aæ˜¯ä»¥éžåŒæ­¥ä¾†åŸ·è¡Œcallbackï¼Œé€™æœƒå› çˆ²æŽ’ç¨‹ç·£æ•…è€Œä½¿callbackçš„åŸ·è¡Œè¢«æŽ’åˆ°å¾ˆå¾Œé ­ï¼Œç”šè‡³è¢«å…¶ä»–ä»»å‹™çµ¦æ’éšŠåŸ·è¡Œï¼Œç„¡æ³•åŠæ™‚ä»¥é©ç•¶çš„æ™‚æ©Ÿé»žåŸ·è¡Œ

åœ¨Promiseä¸­ï¼ŒéžåŒæ­¥ä»»å‹™çš„æŽ’ç¨‹æœƒæŒ‰ç…§thenã€catchã€finallyçš„å‡ºç¾é †åºä¾†é€²è¡Œï¼Œä¹Ÿå°±æ˜¯å¯ä»¥è—‰ç”±promise.thençµ¦å®šçš„APIä½ç½®ä¾†ç”±ä¸Šè‡³ä¸‹æŒ‰ç…§ä½ç½®é †åºåŽ»æŽ’ç¨‹éžåŒæ­¥ä»»å‹™callbackï¼Œå¦‚ä¸‹ï¼šPromiseæœƒè£½é€ fulfilledç‹€æ…‹æˆ–è€…rejectedç‹€æ…‹çš„promiseï¼Œä¸¦ä¸”å‘¼å«å…¶promiseçš„thenä¾†è®“callback1å…ˆåŸ·è¡Œï¼ŒæŽ¥è‘—åœ¨åŸ·è¡Œcallback2ï¼Œæœ€å¾Œåœ¨åŸ·è¡Œcallback3
```
Promise(...)
.then(callback1, callback1)
.then(callback2, callback2)
.then(callback3, callback3)
```

### å‘¼å«callbackçš„æ¬¡æ•¸è¶…éŽä¸€æ¬¡æˆ–è€…æ²’å‘¼å«callback

> å‘¼å«callbackçš„æ¬¡æ•¸è¶…éŽä¸€æ¬¡æˆ–è€…æ²’å‘¼å«callback

callbacké©åˆçš„åŸ·è¡Œæ¬¡æ•¸æœƒæ˜¯1æ¬¡ï¼Œè€Œåœ¨Promiseä¸­ï¼Œæ‰€æœ‰ç¶“ç”±Promise.thenæ‰€è¨»å†Šçš„callbackï¼Œåªè¦è©²Promiseè¢«è§£æž(resolve)æˆ–è€…è¢«æ‹’çµ•(rejected)ï¼Œå…¶å°æ‡‰çš„callbackå°±åªæœƒå› ç‚ºPromise.thenè€Œè¢«åŸ·è¡Œä¸€æ¬¡ã€‚

ä½†ä¸ä¿è­‰å°‡ç›¸åŒcallbackè¨»å†Šåœ¨å¤šå€‹Promise.thenè€Œç”¢ç”Ÿå‡ºè¶…éŽä¸€æ¬¡çš„callbackä¹‹åŸ·è¡Œæ¬¡æ•¸ï¼Œç„¶è€ŒåŸ·è¡Œæ¬¡æ•¸çš„æ±ºå®šæœƒæ˜¯ç”±è¨»å†Šæ–¹ä¾†æ±ºå®šï¼Œè€Œéžäº¤ç”±åŽŸæœ¬ç„¡æ³•ä¿¡ä»»çš„éžåŒæ­¥ä»»å‹™Aä¾†æ±ºå®š

### æ²’æœ‰å‚³å…¥ä»»ä½•å¿…è¦çš„åƒæ•¸è‡³callback

> æ²’æœ‰å‚³å…¥ä»»ä½•å¿…è¦çš„åƒæ•¸å’Œç’°å¢ƒçµ¦callbackï¼šè‹¥callbackæ˜¯ä»¥éžåŒæ­¥ä»»å‹™ä¾†åŸ·è¡Œï¼Œå…¶åƒæ•¸æ˜¯å¦æœƒä»¥ä»»å‹™Açš„åŸ·è¡Œçµæžœç‚ºä¸»ä¸¦åŠ ä»¥è™•ç†ï¼Ÿ

åœ¨Promiseä¸­ï¼Œéƒ½æœƒå°‡fulfilledç‹€æ…‹æˆ–è€…rejectedç‹€æ…‹çš„å…§å®¹ç•¶ä½œcallbackçš„åƒæ•¸ä¾†å¡«å…¥ï¼Œæ‰€ä»¥åªè¦è¨­å®šfulfilledç‹€æ…‹æˆ–è€…rejectedç‹€æ…‹çš„å…§å®¹ä»¥åŠè®“callbackè¨­å®šæˆåˆé©å½¢å¼çš„å¼•æ•¸å½¢å¼ï¼Œå°±èƒ½ç¢ºä¿callbackèƒ½ç²å–åˆ°åƒæ•¸ä¾†åŸ·è¡Œã€‚


### å› callbackåŸ·è¡Œæ™‚æ‹‹å‡ºéŒ¯èª¤è€Œç”¢ç”Ÿé æœŸå¤–çš„çµæžœ





> å› callbackåŸ·è¡Œæ™‚æ‹‹å‡ºéŒ¯èª¤è€Œç”¢ç”Ÿé æœŸå¤–çš„çµæžœï¼Œæ¯”å¦‚åžæŽ‰callbackåŸ·è¡Œæ™‚æ‹‹å‡ºçš„éŒ¯èª¤æˆ–è€…ä¾‹å¤–ï¼ŒéžåŒæ­¥ä»»å‹™AåŸ·è¡Œcallbackæ™‚æ‹‹å‡ºéŒ¯èª¤ï¼Œä½†æ²’æœ‰éŒ¯èª¤è™•ç†ä¾†è™•ç†ã€å› ç³»çµ±æŽ¥å—åˆ°éŒ¯èª¤è€ŒæŽ¡å–é è¨­çš„éŒ¯èª¤è™•ç†ï¼Œè€ŒéŒ¯èª¤è™•ç†æ˜¯ä»¥åŒæ­¥åŸ·è¡Œä¾†åŸ·è¡Œï¼Œç„¶è€Œcallbackæ˜¯ä»¥éžåŒæ­¥ä¾†åŸ·è¡Œï¼Œé¡¯ç„¶æœƒä½¿callbackæ•´é«”è®ŠæˆZalgo


#### æœªæœ‰å°æ‡‰éŒ¯èª¤è™•ç†ä¾†æ‡‰å°callbackè¢«åŸ·è¡Œæ™‚æ‰€æ‹‹å‡ºçš„éŒ¯èª¤


å•é¡Œæè¿°ï¼š
ç•¶åŒ…è¦†è‘—å°æ‡‰callbackçš„promise objectè¢«åŸ·è¡Œæ™‚ï¼Œè‹¥æ‹‹å‡ºéŒ¯èª¤çš„è©±ï¼Œpromise æœƒè‡ªå‹•å°‡éŒ¯èª¤åŒ…è£æˆrejectedç‹€æ…‹çš„promiseä¾†å›žå‚³ï¼ŒæŽ¥è‘—ä¹‹å¾Œçš„éŒ¯èª¤è™•ç†å¾ˆæœ‰å¯èƒ½æœƒå› ç‚ºè©²object æœªè¨»å†Šè‘—éŒ¯èª¤è™•ç†çš„callbackè€Œæœªèƒ½è™•ç†ã€‚


è§£æ³•ï¼š
1. è¨»å†Šæ–¹åªéœ€è¦åœ¨å¾Œé ­è¨»å†Šè² è²¬éŒ¯èª¤è™•ç†çš„callbackå°±èƒ½è§£æ±º
2. ç›´æŽ¥ä¿®æ”¹ä»¥æœ€ä¸€é–‹å§‹çš„Promise objectæ‰€æ“æœ‰çš„ç‹€æ…‹ç‚ºrejectedï¼Œé€²è€Œè®“å®ƒåŸ·è¡Œè©²Promise objectåŽŸæœ¬çš„éŒ¯èª¤è™•ç†ã€‚


#### å› éŒ¯èª¤è™•ç†è€Œä½¿callbackçš„åŸ·è¡Œæ–¹å¼æœƒæ¼”è®ŠæˆZalgo

å•é¡Œæè¿°ï¼š

é æœŸæƒ…æ³ä¸‹ï¼Œé‚„æœ‰è¡ç”Ÿå‡ºZalgoå•é¡Œæ©Ÿæœƒï¼Œæ¯”å¦‚ç”±ç³»çµ±çš„å…§å»ºéŒ¯èª¤è™•ç†æ””æˆªåˆ°éŒ¯èª¤ï¼Œä¸¦ä¸”ä»¥åŒæ­¥å½¢å¼ä¾†åŸ·è¡ŒéŒ¯èª¤ï¼Œç„¶è€Œåœ¨é€™è£çš„callbackæœ¬èº«å°±å—åˆ°Promiseè€Œä»¥éžåŒæ­¥åŸ·è¡Œï¼Œé‚£éº¼æœƒä½¿æ•´é«”çš„callback(å«éŒ¯èª¤è™•ç†)åœ¨åŸ·è¡Œä¸Šè®Šæˆé›£ä»¥å€åˆ†å…¶åŸ·è¡Œæ–¹å¼çš„Zalgo

è§£æ³•ï¼š

1. åœ¨Promiseä¸­ï¼Œæœƒå°‡æ‰€æœ‰ç™¼ç”Ÿåœ¨callbackä¸Šçš„éŒ¯èª¤å’ŒåŸ·è¡ŒéŒ¯èª¤å…¨ä»¥rejectedç‹€æ…‹çš„promiseä¾†å›žå‚³çµ¦ä¸‹ä¸€å€‹Promise.thenæˆ–è€…Promise.catchä¾†æŽ¥æ”¶ï¼Œç•¶ä»–å€‘æŽ¥æ”¶åˆ°æ™‚ï¼Œå°±æœƒä»¥éžåŒæ­¥ä»»å‹™çš„å½¢å¼ä¾†åŸ·è¡ŒéŒ¯èª¤è™•ç†ï¼Œç¢ºä¿å¦ä¸€å€‹æ½›åœ¨çš„å•é¡Œ- éŒ¯èª¤è™•ç†æœƒä¸æœƒè‡´ä½¿callbackçš„åŸ·è¡Œè®ŠæˆZalgo


æ¯”å¦‚ï¼šç•¶callback1åŸ·è¡Œæ™‚æ‹‹å‡ºéŒ¯èª¤æ™‚ï¼Œé€™æ™‚ç³»çµ±æœƒç›´æŽ¥ä»¥fullfilledç‹€æ…‹çš„promiseä¾†å‘¼å«å®ƒæ“æœ‰çš„catchæˆ–è€…thenä¾†åŸ·è¡Œå°æ‡‰éŒ¯èª¤è™•ç†callbackã€‚
```
new Promise((resolve, reject) => {
	resolve(10);
})
.then(callback1)
.catch(callback2) // æˆ–è€… .then(callback1, callback1)
```



## è¤‡ç¿’


---
Status: #ðŸŒ± 
Tags:
[[JavaScript]]
Links:
References: