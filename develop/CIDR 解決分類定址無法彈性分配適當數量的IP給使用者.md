## 描述
  
### 背景
根據[[@WuLeiBieYuJianLuYou2022]]所描述的CIDR衍生背景：
> 1.  在之前的分類定址[[分類定址是將IP分個群組來重新定義使用者能用的IP群組是什麼]]中，IP位址的分配把IP位址的32位元按每8位元為一段分開。這使得字首必須為8，16或者24位元。因此，可分配的最小的位址塊有256（24位元字首，8位元主機位址，28=256）個位址，而這對大多數企業來說太少了。大一點的位址塊包含65536（16位元字首，16位元主機，216=65536）個位址，而這對大公司來說都太多了。
> 2.  無類別區隔路由CIDR技術 依需求善用有限IP位址


重點：
- 在過去以ABCDEF類別來將IP分子網域或者以固定遮罩數來分配子網域，但分出來的子網域夠分配的IP會沒辦法滿足大多數企業的分配需求，不是子網域能夠分配的IP遠超過需求，就是子網域能夠分配的IP遠低於需求(不能夠足夠分配)
- CIDR是以 **根據IP需求來切分出適當數量的IP給需求方**為主的方法


### CIDR

CIDR 是 Classless Inter-Domain Routing 的縮寫，其技術主要是
- 以目前所處的實際子網域再進一步區分成內部(承認)的子網域來減緩IP分配過多過少的問題
- 同時由於內部(承認)的子網域，所以進一步調整內部路由好讓封包能在內部傳遞上能順利傳遞至正確主機

> IPv4的CIDR位址塊的表示方法和IPv4位址的表示方法是相似的：由四部分組成的點分十進位位址，後跟一個斜線，最後是範圍在0到32之間的一個數字：_A.B.C.D/N_。點分十進位的部分和IPv4位址一樣是一個被分成四個八位位組的32位元二進位數。斜線後面的數字就是**字首長度**，也就是從左到右，被位址塊里的位址所共享的位的數目。當只需說明大概時，十進位部分有時會被省略，因此，_/20_就表示一個字首長度是20的CIDR位址塊。如果一個IP位址的前N位與一個CIDR位址塊的字首是相同的話，那麼就說這個位址屬於這個CIDR位址塊，也可以說是與CIDR位址塊的字首匹配。


> CIDR用**可變長子網路遮罩** （**VLSM**,Variable Length Subnet Masking），根據各人需要來分配IP位址，而不是按照一個全網路約定的規則。所以，網路/主機的劃分可以在位址內的任意位置進行。這個劃分可以是遞迴進行的，即通過增加遮罩位數，來使一部分位址被繼續分為更小的部分。整個網際網路現在都在使用CIDR/VLSM網路位址。除此之外，CIDR也應用在其他方面，尤其是大型私人網路。在普通大小的區域網路里則較少應用，因為這些區域網路一般使用私有網路。

重點：
	- 由於傳統上還是以全網路制定的規則來區分子網域，但仍會有實際分配大於需求或者小於需求的配給問題
	- 在這樣背景之下，CIDR技術是以現有從外部公認拿到的子網域進一步在內部區分更細的子網域，其具體技術為VLSM (Variable Length Subnet Masking)
	- VLSM技術具體會以此實際外部公認的子網域遮罩來增加遮罩位數來獲取更細小的網域 
	- IP在CIDR 表示方法為如下，A.B.C.D為IP位址，N定義是指遮罩從左邊到右邊有多少個連續1
	```
	A.B.C.D/N
	```
	若N為23，就代表著遮罩為如下，其中從左邊數來有23個1，遮罩與A.B.C.D搭配就代表著IP位址前23位為該子網域的識別IP
	```
	1111 1111 . 111 1111 . 1111 1110 . xxxx xxxx
	```
	- 若兩個A.B.C.D/N的IP中，前面N位bit皆為一樣且N也一樣的話，兩個IP皆是在同一個子網域。
	
舉例：
引用[[@hukaizhiWuLeiBieQuGeLuYouCIDRJiShuYiXuQiuShanYongYouXianIPWeiZhiWangGuanRen]]所提到的例子來說明：

假若自己被分配172.16.32.0/20這個網域，然而實際上要分配IP的主機數量是10個，所以理論以上述提到的網域設定，每一個子網域可以分配

$2^{32-20}-2 = 4094$ 個IP

這對於只需要10個IP來說，一個子網域就分配4094個IP是過於浪費了，為此就使用CIDR對以下網域設定進行額外的子網域切分
```
172.16.32.0/20
=> 
172.16.32.0/28
```

那麼在172.16.32.0/20中可切分出以/28為主的子網域，其中xxxx是在內部(承認)切分出網域中，每一個內部定義的網域所能夠拿到的獨特序號
```
// 172.16.32.0/28
172.16.0010 0000.0000 xxxx
// 172.16.32.16/28
172.16.0010 0000.0001 xxxx
// 172.16.32.32/28
172.16.0010 0000 0010 xxxx
// 172.16.32.48/28
172.16.0010 0000 0011 xxxx
.
.
.
```

從/20切分出/28的子網域數有
$2^{28-20} = 256$ 個子網域

且在這樣切分之下，每一個進一步切分的子網域可以分配
$2^{4} - 2 =14$個IP

一個子網域就分配14個IP，這對於只需要10個IP來說，不算是太大的浪費，比起原本一個子網域只會分配4094個IP來說，這已經算是減少許多浪費。
## 複習



#🧠 CIDR衍生背景是什麼 ->->-> `在過去以ABCDEF類別來將IP分子網域或者以固定遮罩數來分配子網域，但分出來的子網域夠分配的IP會沒辦法滿足大多數企業的分配需求，不是子網域能夠分配的IP遠超過需求，就是子網域能夠分配的IP遠低於需求(不能夠足夠分配)`
<!--SR:!2022-05-21,3,250-->

#🧠 CIDR是什麼樣技術？用途是？ ->->-> `以目前所處的實際子網域再進一步區分成內部(承認)的子網域來減緩IP分配過多過少的問題，同時由於內部(承認)的子網域，所以進一步調整內部路由好讓封包能在內部傳遞上能順利傳遞至正確主機`
<!--SR:!2022-05-19,1,230-->

#🧠 CIDR 技術中，A.B.C.D/N所指的是什麼？ IP？遮罩？關係是什麼？->->-> `IP在CIDR 表示方法為如下，A.B.C.D為IP位址，N定義是指遮罩從左邊到右邊有多少個連續1，若兩個A.B.C.D/N的IP中，前面N位bit皆為一樣且N也一樣的話，兩個IP皆是在同一個子網域`
<!--SR:!2022-05-21,3,250-->

#🧠 CIDR 中所使用的VLSM (Variable Length Subnet Masking) 技術是什麼->->-> `其技術具體會以此實際外部公認的子網域遮罩來增加遮罩位數來獲取更細小的網域`
<!--SR:!2022-05-21,3,250-->
	
#🧠 假若自己被分配172.16.32.0/20這個網域，然而實際上要分配IP的主機數量是10個，那麼繼續使用前面提到的網域，會浪費4084個IP，請問如何切分會更省？ ->->-> `使用CIDR來以172.16.32.0/20繼續切分成172.16.32.0/28會更省，原因為會多出4個，但比起172.16.32.0/29來說，卻是適當的。`
<!--SR:!2022-05-21,3,250-->
	
	
---
Status: #🌱 
Tags:
[[Network]]
Links:
[[CIDR 解決分類定址無法彈性分配適當數量的IP給使用者]]
[[分類定址是將IP分個群組來重新定義使用者能用的IP群組是什麼]]
[[網路遮罩是用來判斷目前IP所屬的子網域是什麼]]
[[一個IP群組上一定會有負責用來識別整個IP群組以及廣播位址]]
References:
[[@WuLeiBieYuJianLuYou2022]]
[[@hukaizhiWuLeiBieQuGeLuYouCIDRJiShuYiXuQiuShanYongYouXianIPWeiZhiWangGuanRen]]

