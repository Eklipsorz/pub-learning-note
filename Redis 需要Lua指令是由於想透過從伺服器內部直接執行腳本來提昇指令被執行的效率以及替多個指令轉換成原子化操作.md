
## æè¿°

[[@KuaiSuRuMenRedisHuJiaoLuaZhiLingMaJiShiYongChangJingJieShaoZiMuGeBuLuoGeMdEditor]] æ‰€æè¿°ï¼š

> **ç°¡è€Œè¨€ä¹‹ï¼šLuaæŒ‡ä»¤ç¢¼å¸¶ä¾†æ•ˆèƒ½çš„æå‡**ã€‚

> -   å¾ˆå¤šæ‡‰ç”¨çš„æœå‹™ä»»å‹™åŒ…å«å¤šæ­¥redisæ“ä½œä»¥åŠä½¿ç”¨å¤šå€‹rediså‘½ä»¤ï¼Œé€™æ™‚ä½ å¯ä»¥ä½¿ç”¨RedisçµåˆLuaæŒ‡ä»¤ç¢¼ï¼Œæœƒç‚ºä½ çš„æ‡‰ç”¨å¸¶ä¾†æ›´å¥½çš„æ•ˆèƒ½ã€‚
> -   å¦å¤–åŒ…å«åœ¨ä¸€å€‹Luaè…³æœ¬é‡Œé¢çš„rediså‘½ä»¤å…·å‚™åŸå­æ€§ï¼Œç•¶ä½ é¢å°é«˜ä½µç™¼å ´æ™¯ä¸‹çš„redisè³‡æ–™åº«æ“ä½œæ™‚ï¼Œå¯ä»¥æœ‰æ•ˆé¿å…å¤šåŸ·è¡Œç·’æ“ä½œç”¢ç”Ÿé«’è³‡æ–™ã€‚

[[@RedisXueXiZhiluaJianShu]] æ‰€æè¿°ï¼š

> redisåœ¨2.6å¼€å§‹åŠ å…¥äº†luaè„šæœ¬ï¼Œä½¿ç”¨luaè„šæœ¬æœ‰å¦‚ä¸‹å¥½å¤„:

> -   **å‡å°‘ç½‘ç»œå¼€é”€**ã€‚å¤åˆæ“ä½œéœ€è¦å‘Rediså‘é€å¤šæ¬¡è¯·æ±‚ï¼Œå¦‚ä¸Šä¾‹ï¼Œè€Œæ˜¯ç”¨è„šæœ¬åŠŸèƒ½å®ŒæˆåŒæ ·çš„æ“ä½œåªéœ€è¦å‘é€ä¸€ä¸ªè¯·æ±‚å³å¯ï¼Œå‡å°‘äº†ç½‘ç»œå¾€è¿”æ—¶å»¶ã€‚
> -   **åŸå­æ“ä½œ**ã€‚Redisä¼šå°†æ•´ä¸ªè„šæœ¬ä½œä¸ºä¸€ä¸ªæ•´ä½“æ‰§è¡Œï¼Œä¸­é—´ä¸ä¼šè¢«å…¶ä»–å‘½ä»¤æ’å…¥ã€‚æ¢å¥è¯è¯´åœ¨ç¼–å†™è„šæœ¬çš„è¿‡ç¨‹ä¸­æ— éœ€æ‹…å¿ƒä¼šå‡ºç°ç«æ€æ¡ä»¶ï¼Œä¹Ÿå°±æ— éœ€ä½¿ç”¨äº‹åŠ¡ã€‚äº‹åŠ¡å¯ä»¥å®Œæˆçš„æ‰€æœ‰åŠŸèƒ½éƒ½å¯ä»¥ç”¨è„šæœ¬æ¥å®ç°
> -   **å¤ç”¨**ã€‚å®¢æˆ·ç«¯å‘é€çš„è„šæœ¬ä¼šæ°¸ä¹…å­˜å‚¨åœ¨Redisä¸­ï¼Œè¿™å°±æ„å‘³ç€å…¶ä»–å®¢æˆ·ç«¯ï¼ˆå¯ä»¥æ˜¯å…¶ä»–è¯­è¨€å¼€å‘çš„é¡¹ç›®ï¼‰å¯ä»¥å¤ç”¨è¿™ä¸€è„šæœ¬è€Œä¸éœ€è¦ä½¿ç”¨ä»£ç å®ŒæˆåŒæ ·çš„é€»è¾‘

[[@redisScriptingLuaRedis]]
> Redis lets users upload and execute Lua scripts on the server. Scripts can employ programmatic control structures and use most of theÂ [commands](https://redis.io/commands)Â while executing to access the database. Because scripts execute in the server, reading and writing data from scripts is very efficient.

> Redis guarantees the script's atomic execution. While executing the script, all server activities are blocked during its entire runtime. These semantics mean that all of the script's effects either have yet to happen or had already happened.

> Scripting offers several properties that can be valuable in many cases. These include:

> -   Providing locality by executing logic where data lives. Data locality reduces overall latency and saves networking resources.
> -   Blocking semantics that ensure the script's atomic execution.
> -   Enabling the composition of simple capabilities that are either missing from Redis or are too niche to a part of it.

é‡é»ï¼š
- Redis ç‚ºä»€éº¼éœ€è¦LuaæŒ‡ä»¤ç¢¼? ä¸»è¦åŸå› æœ‰å…©å€‹ï¼š
	- æ˜¯é€éå¾ä¼ºæœå™¨å…§éƒ¨ç›´æ¥åŸ·è¡Œè…³æœ¬ä¾†ææ˜‡æŒ‡ä»¤è¢«åŸ·è¡Œçš„æ•ˆç‡ï¼Œè€Œä¸æ˜¯ä¼ºæœå™¨å’Œè«‹æ±‚æ–¹é‚„éš”è‘—ç¶²è·¯ä¾†é€²è¡Œå‚³é
	- å¯¦ç¾å¤šå€‹æŒ‡ä»¤çš„åŸå­åŒ–ï¼šé€éè…³æœ¬å…§å®¹ä¾†å®šç¾©å“ªäº›æŒ‡ä»¤è¦è¢«åˆä½µåœ¨ä¸€å€‹æª”æ¡ˆï¼Œæ¥è‘—åŸ·è¡Œæ™‚ï¼ŒRediså°±ç›´æ¥ä»¥é‚£æª”æ¡ˆä¾†åŸ·è¡Œ
- é€™æ¨£æœƒå¸¶ä¾†ä»¥ä¸‹å¹¾å€‹å¥½è™•ï¼š
	- æœ¬èº«å°±æœ‰çš„åŸå­åŒ–ç‰¹æ€§ï¼šç•¶Redisä¼ºæœå™¨åŸ·è¡Œluaè…³æœ¬æ™‚æœƒä¿è­‰é€™äº›è…³æœ¬æ‰€å®šç¾©çš„æŒ‡ä»¤å°‡æœƒæ˜¯ä»¥åŸå­åŒ–ä¾†åŸ·è¡Œï¼Œå…·é«”æœƒæ˜¯ç•¶åŸ·è¡Œluaè…³æœ¬æ™‚ï¼Œåœ¨åŸ·è¡ŒæœŸé–“ï¼Œä¼ºæœå™¨æ‰€æœ‰æ´»å‹•å°‡æœƒè¢«é˜»å¡ï¼Œç›´åˆ°luaè…³æœ¬è¢«åŸ·è¡Œå®Œç•¢
	- æ¸›å°‘ç¶²è·¯é–‹éŠ·ï¼šé€éå¤šå€‹æŒ‡ä»¤åˆä½µæˆå–®ä¸€æŒ‡ä»¤ï¼Œå¯ä½¿åŸæœ¬Nå€‹æŒ‡ä»¤æ‰€ç”¢ç”Ÿå‡ºä¾†çš„Nå€‹è«‹æ±‚ è½‰æ›æˆåªéœ€è¦ä¸€å€‹è«‹æ±‚ï¼Œè€Œé€™å€‹è«‹æ±‚å°±æ˜¯è«‹æ±‚ä¼ºæœå™¨åŸ·è¡ŒæŒ‡å®šè…³æœ¬å…§å®¹
	- é‡è¤‡ä½¿ç”¨ï¼šä»¥luaç¨‹å¼è…³æœ¬ä¾†æ¨¡çµ„åŒ–å¯é‡è¤‡ä½¿ç”¨çš„åŠŸèƒ½ï¼Œåœ¨ä¸‹ä¸€æ¬¡éœ€è¦åŒæ¨£åŠŸèƒ½æ™‚ï¼Œå°±è¼‰å…¥å·²ç¶“å®šç¾©å¥½çš„luaè…³æœ¬

## è¤‡ç¿’
#ğŸ§  Redis ç‚ºä»€éº¼éœ€è¦LuaæŒ‡ä»¤ç¢¼ï¼Ÿ ->->-> `æ˜¯é€éå¾ä¼ºæœå™¨å…§éƒ¨ç›´æ¥åŸ·è¡Œè…³æœ¬ä¾†ææ˜‡æŒ‡ä»¤è¢«åŸ·è¡Œçš„æ•ˆç‡ï¼Œè€Œä¸æ˜¯ä¼ºæœå™¨å’Œè«‹æ±‚æ–¹é‚„éš”è‘—ç¶²è·¯ä¾†é€²è¡Œå‚³éã€å¯¦ç¾å¤šå€‹æŒ‡ä»¤çš„åŸå­åŒ–ï¼šé€éè…³æœ¬å…§å®¹ä¾†å®šç¾©å“ªäº›æŒ‡ä»¤è¦è¢«åˆä½µåœ¨ä¸€å€‹æª”æ¡ˆï¼Œæ¥è‘—åŸ·è¡Œæ™‚ï¼ŒRediså°±ç›´æ¥ä»¥é‚£æª”æ¡ˆä¾†åŸ·è¡Œ`

#ğŸ§  Redis é‘²å…¥LuaæŒ‡ä»¤ç¢¼æœƒæœ‰ä»€éº¼å¥½è™•ï¼Ÿ ->->-> `æ¸›å°‘ç¶²è·¯é–‹éŠ·ã€å¯¦ç¾åŸå­åŒ–ç‰¹æ€§ã€å¯ä»¥å®šç¾©æˆå¯é‡è¤‡ä½¿ç”¨çš„ç¨‹å¼æ¨¡çµ„`

#ğŸ§   Redis é‘²å…¥LuaæŒ‡ä»¤ç¢¼å¦‚ä½•å¯¦ç¾æ¸›å°‘ç¶²è·¯é–‹éŠ·->->-> `é€éå¤šå€‹æŒ‡ä»¤åˆä½µæˆå–®ä¸€æŒ‡ä»¤ï¼Œå¯ä½¿åŸæœ¬Nå€‹æŒ‡ä»¤æ‰€ç”¢ç”Ÿå‡ºä¾†çš„Nå€‹è«‹æ±‚ è½‰æ›æˆåªéœ€è¦ä¸€å€‹è«‹æ±‚ï¼Œè€Œé€™å€‹è«‹æ±‚å°±æ˜¯è«‹æ±‚ä¼ºæœå™¨åŸ·è¡ŒæŒ‡å®šè…³æœ¬å…§å®¹`

#ğŸ§  Redis æ¡ç”¨Luaå…·é«”å¦‚ä½•å¯¦ç¾åŸå­åŒ–æ“ä½œï¼Ÿ->->-> `å…·é«”æœƒæ˜¯ç•¶åŸ·è¡Œluaè…³æœ¬æ™‚ï¼Œåœ¨åŸ·è¡ŒæœŸé–“ï¼Œä¼ºæœå™¨æ‰€æœ‰æ´»å‹•å°‡æœƒè¢«é˜»å¡ï¼Œç›´åˆ°luaè…³æœ¬è¢«åŸ·è¡Œå®Œç•¢`

---
Status: #ğŸŒ± 
Tags:
[[Redis]] - [[Lua]]
Links:
References:
[[@redisScriptingLuaRedis]]
[[@RedisXueXiZhiluaJianShu]]
[[@KuaiSuRuMenRedisHuJiaoLuaZhiLingMaJiShiYongChangJingJieShaoZiMuGeBuLuoGeMdEditor]]

