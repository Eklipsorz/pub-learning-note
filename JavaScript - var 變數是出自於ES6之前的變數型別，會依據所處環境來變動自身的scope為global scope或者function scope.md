

## æè¿°
JavaScript - var è®Šæ•¸æœ¬èº«æ²’scopeæ¦‚å¿µï¼Œæ‰€ä»¥ç•¶åœ¨æª”æ¡ˆå…¨åŸŸå®£å‘Šå°±æ–¼æª”æ¡ˆçš„ä¸€é–‹å§‹å°±åˆ†é…è¨˜æ†¶é«”ï¼Œè€Œç•¶åœ¨å‡½å¼å®£å‘Šå°±ç­‰æ–¼åœ¨å‡½å¼ä¸€é–‹å§‹åˆ†é…è¨˜æ†¶é«”

[[@ithomeBianShuJiChu]] æ‰€æè¿°ï¼š
> ## varè®Šæ•¸çš„æœ‰æ•ˆç¯„åœ
> æœ‰æ•ˆç¯„åœè¬›çš„å°ˆæ¥­ä¸€é»å«`ä½œç”¨åŸŸ(scope)`ï¼Œvarè®Šæ•¸æ˜¯éµç…§ `function scope`ã€‚
> ### ç”šéº¼æ˜¯ã€Œvarè®Šæ•¸éµç…§ `function scope`ã€
> è¬›äººè©±å°±æ˜¯ï¼š`var`é—œéµå­—ä»¤å‡ºçš„è®Šæ•¸ï¼Œä»–çš„æœ‰æ•ˆç¯„åœä»¥`function`ç•Œå®šã€‚


[[@chengshimanongJSXuanGaoBianShuVar]]

> åœ¨ ES6 å‰ï¼Œä¸¦æ²’æœ‰å€å¡Šä½œç”¨åŸŸï¼ˆblock scopeï¼‰çš„æ¦‚å¿µï¼Œåƒ…æœ‰å…¨åŸŸï¼ˆglobal scopeï¼‰èˆ‡å‡½å¼ä½œç”¨åŸŸï¼ˆfunction scopeï¼‰ï¼Œæ‰€ä»¥ `var` å®£å‘Šçš„è®Šæ•¸ï¼Œå…·æœ‰å‡½å¼ä½œç”¨åŸŸï¼ˆfunction scopeï¼‰çš„æ€§è³ªï¼Œä»£è¡¨**åˆ‡åˆ†æœ€å°å–®ä½çš„æœ‰æ•ˆç¯„åœæ˜¯ function**ã€‚

> ç›´åˆ° ES6 å¾Œï¼Œæ–°å¢å€å¡Šåˆ‡åˆ†çš„æ¦‚å¿µï¼Œ `let / const` å®£å‘Šçš„è®Šæ•¸ï¼Œæ‰å…·æœ‰å€å¡Šä½œç”¨åŸŸï¼ˆblock scopeï¼‰çš„æ€§è³ªï¼Œ**åˆ‡åˆ†æœ€å°å–®ä½çš„æœ‰æ•ˆç¯„åœæ˜¯ blcok**ã€‚

é‡é»ï¼š
- ES6 å‰æ˜¯æ²’æœ‰block scopeï¼Œåªæœ‰global scope æ¦‚å¿µå’Œfunction scope æ¦‚å¿µ
- var è®Šæ•¸æœ¬èº«å‡ºè‡ªæ–¼ES6ä¹‹å‰çš„èªæ³•ï¼Œæ‰€ä»¥å…¶ä½œç”¨åŸŸæœƒä¾æ“šè®Šæ•¸æ‰€è™•çš„ç’°å¢ƒä¾†æ±ºå®šè‡ªå·±æ˜¯global scope ? é‚„æ˜¯function scope
- let/const æ˜¯å‡ºè‡ªæ–¼ES6ï¼Œæ‰€ä»¥æœƒæœ‰block scopeã€function scopeã€global scopeï¼Œä¸”æœ€å°scopeå–®ä½æ˜¯block scope
### var è®Šæ•¸è‹¥æ”¾åœ¨block scopeçš„è©±
var è®Šæ•¸ç”±æ–¼æ˜¯å‡ºè‡ªæ–¼åªæœ‰global scopeå’Œfunction scopeçš„ES6ä»¥å‰ç‰ˆæœ¬ï¼Œè‹¥é‡åˆ°ES6å‡ºç¾çš„block scopeï¼Œæœƒç›´æ¥å¿½è¦–block scopeï¼Œä¸¦ä¸”ä¾æ“šå…¶block scopeåŸæœ¬è™•æ–¼çš„scopeæ˜¯å¦ç‚ºfunction scopeä¾†æ±ºå®šè‡ªå·±çš„scopeæ˜¯å¦ç‚ºfunction scope

æ¯”å¦‚èªªvar è¢«æ”¾ç½®block scope
```
function xxx() {
	{
		{
			var x = 100
		}
	}
}
```
ï¼Œä½†ç³»çµ±æœƒé€™æ¨£å­çœ‹å¾…xè®Šæ•¸ï¼šç›´æ¥å¿½è¦–block scopeï¼Œä¸¦æ±ºå®šå…¶varè®Šæ•¸ç‚ºfunction scope
```
function xxx() {

	var x = 100
	
}
```

### var è®Šæ•¸è‹¥è™•æ–¼function scope
var è®Šæ•¸åªæœƒåœ¨è©²å‡½å¼èƒ½å¤ è¢«è­˜åˆ¥ï¼Œä¸¦ä¸”ç•¶åŸ·è¡Œåˆ°è©²å‡½å¼ä¹‹å‰ï¼Œç³»çµ±æœƒå…ˆè³¦äºˆè¨˜æ†¶é«”ç©ºé–“ä»¥åŠåˆå§‹å€¼undefinedçµ¦å®šæ‰€æœ‰è™•åœ¨functionçš„varè®Šæ•¸ï¼Œç›´åˆ°æ­£å¼åŸ·è¡Œæ™‚ï¼Œå°±æ›´æ”¹å…¶å…§å®¹ï¼Œæœ€å¾ŒåŸ·è¡Œåˆ°å‡½å¼è¦çµæŸæ™‚ï¼Œå°±æœƒé‡‹æ”¾varè®Šæ•¸çš„è¨˜æ†¶é«”

###  var è®Šæ•¸è‹¥è™•æ–¼global scope 

 varè®Šæ•¸æœƒè®Šæˆæ•´å€‹æª”æ¡ˆéƒ½èƒ½å¤ è¢«è­˜åˆ¥ï¼Œä¸¦ä¸”ç•¶JSæ ¸å¿ƒåŸ·è¡Œä¹‹å‰å°±æœƒå…ˆè³¦äºˆè¨˜æ†¶é«”ç©ºé–“ä»¥åŠåˆå§‹å€¼undefinedçµ¦å®šæ‰€æœ‰è™•åœ¨å…¨åŸŸçš„varè®Šæ•¸ï¼Œç›´åˆ°æ­£å¼åŸ·è¡Œæ™‚ï¼Œå°±æœƒæ›´æ”¹å…¶å…§å®¹ï¼Œæœ€å¾ŒåŸ·è¡Œåˆ°æª”æ¡ˆè¦çµæŸåŸ·è¡Œï¼Œå°±æœƒé‡‹æ”¾varè®Šæ•¸çš„è¨˜æ†¶é«”
 


#### èˆ‰ä¾‹1ï¼šåœ¨æª”æ¡ˆå…¨åŸŸä¸‹å®£å‘Švar

ç•¶åŸ·è¡Œæª”æ¡ˆçš„å…¨åŸŸå‰ï¼Œæœƒå…ˆåˆ†é…è¨˜æ†¶é«”ç©ºé–“çµ¦varè®Šæ•¸ï¼Œä¸¦è¨­ç½®é è¨­åˆå§‹å€¼-undefinedï¼Œåœ¨é€™æœƒæ˜¯è¨­å®štestç‚ºundefinedï¼Œéš¨å¾Œæ­£å¼åŸ·è¡Œå¾Œï¼Œå°±æŒ‰ç…§test = a ä¾†æŒ‡æ´¾å…¶è®Šæ•¸
```
var test = a

function xxx() {

}

console.log(test)
```

åœ¨å…¨åŸŸå®£å‘Šçš„varè®Šæ•¸æœƒä»¥æ•´å€‹æª”æ¡ˆçš„å…¨åŸŸä½œç‚ºscopeä¾†åˆ†é…è¨˜æ†¶é«”ã€åˆå§‹å€¼åˆ†é…ã€é‡‹æ”¾è¨˜æ†¶é«”

#### èˆ‰ä¾‹2ï¼šåœ¨å‡½å¼ä¸‹å®£å‘Švar

ç•¶æ”¹åœ¨å‡½å¼å…§å®£å‘Švarè®Šæ•¸æ™‚ï¼Œä¸¦æƒ³åœ¨å…¨åŸŸä¸‹å°å‡ºå…¶å€¼

```
function xxx() {
	var test = a
}

console.log(test)
```
é‚£éº¼æœƒç²å–ä»¥ä¸‹éŒ¯èª¤è¨Šæ¯ï¼Œä¾†è¡¨ç¤ºä»–å€‘æ‰¾ä¸åˆ°varè®Šæ•¸-test
```
ReferenceError: test is not defined
```

å¯è‹¥æ˜¯å°‡functionæ”¹æˆå¤šå±¤{}çš„è©±ï¼Œå»å¯ä»¥å°å‡º'hi'

```
{	
	{
		var test = 'hi'
	}
}

console.log(test)
```

å¾é€™è£¡å¯ä»¥å¾—çŸ¥varè®Šæ•¸åªæœƒç”Ÿæ•ˆæ–¼å‡½å¼ï¼Œä¸¦ä»¥å‡½å¼ç•¶ä½œå¦ä¸€å€‹æª”æ¡ˆçš„å…¨åŸŸä¾†å­˜æ´»ï¼Œç•¶å‡½å¼è¦å‘¼å«ä¹‹å‰ï¼Œå°±åˆ†é…è¨˜æ†¶é«”çµ¦testã€åˆ†é…åˆå§‹å€¼undefinedçµ¦testã€åœ¨å‡½å¼çµæŸå¾Œé‡‹æ”¾è¨˜æ†¶é«”
```
function xxx() {
	var test = a
}
```

## è¤‡ç¿’
#ğŸ§  åœ¨ES6ä¹‹å‰çš„scopeæ˜¯æœ‰å“ªäº›ç¨®é¡(æç¤ºï¼šå…¨xã€å‡½x)->->-> `åªæœ‰global scopeã€function scope`

#ğŸ§   var è®Šæ•¸æœ‰æ²’æœ‰scope æ¦‚å¿µï¼Ÿ å…·é«”ä¾†èªªæ˜¯ä»€éº¼ï¼Ÿ å®ƒå‡ºè‡ªæ–¼ES6? ES6ä»¥å‰ï¼Ÿ->->-> `varè®Šæ•¸æ˜¯æœ‰çš„ï¼Œå…·é«”ä¾†èªªå®ƒå‡ºè‡ªæ–¼åªæœ‰global scopeã€function scopeçš„ES6ä»¥å‰ç‰ˆæœ¬ï¼Œè€Œvarè®Šæ•¸çš„scopeæœ¬èº«æœƒä¾è³´è‘—è‡ªå·±æ‰€è™•çš„ç’°å¢ƒæ˜¯ä¸æ˜¯å‡½å¼è€Œæ±ºå®šæ˜¯å¦ç‚ºfunction scopeï¼Ÿé‚„æ˜¯global scope`

#ğŸ§   var è®Šæ•¸è‹¥è™•æ–¼function scopeï¼Œé€™èªªæ˜ä»€éº¼ï¼Ÿ(æç¤ºï¼šè­˜åˆ¥ã€è¨˜æ†¶é«”ã€åˆå§‹å€¼ã€é‡‹æ”¾) ->->-> `var è®Šæ•¸åªæœƒåœ¨è©²å‡½å¼èƒ½å¤ è¢«è­˜åˆ¥ï¼Œä¸¦ä¸”ç•¶åŸ·è¡Œåˆ°è©²å‡½å¼ä¹‹å‰ï¼Œç³»çµ±æœƒå…ˆè³¦äºˆè¨˜æ†¶é«”ç©ºé–“ä»¥åŠåˆå§‹å€¼undefinedçµ¦å®šæ‰€æœ‰è™•åœ¨functionçš„varè®Šæ•¸ï¼Œç›´åˆ°æ­£å¼åŸ·è¡Œæ™‚ï¼Œå°±æ›´æ”¹å…¶å…§å®¹ï¼Œæœ€å¾ŒåŸ·è¡Œåˆ°å‡½å¼è¦çµæŸæ™‚ï¼Œå°±æœƒé‡‹æ”¾varè®Šæ•¸çš„è¨˜æ†¶é«”`

#ğŸ§   var è®Šæ•¸è‹¥è™•æ–¼global scopeï¼Œé€™èªªæ˜ä»€éº¼ï¼Ÿ(æç¤ºï¼šè­˜åˆ¥ã€è¨˜æ†¶é«”ã€åˆå§‹å€¼ã€é‡‹æ”¾) ->->->  `varè®Šæ•¸æœƒè®Šæˆæ•´å€‹æª”æ¡ˆéƒ½èƒ½å¤ è¢«è­˜åˆ¥ï¼Œä¸¦ä¸”ç•¶JSæ ¸å¿ƒåŸ·è¡Œä¹‹å‰å°±æœƒå…ˆè³¦äºˆè¨˜æ†¶é«”ç©ºé–“ä»¥åŠåˆå§‹å€¼undefinedçµ¦å®šæ‰€æœ‰è™•åœ¨å…¨åŸŸçš„varè®Šæ•¸ï¼Œç›´åˆ°æ­£å¼åŸ·è¡Œæ™‚ï¼Œå°±æœƒæ›´æ”¹å…¶å…§å®¹ï¼Œæœ€å¾ŒåŸ·è¡Œåˆ°æª”æ¡ˆè¦çµæŸåŸ·è¡Œï¼Œå°±æœƒé‡‹æ”¾varè®Šæ•¸çš„è¨˜æ†¶é«”`

#ğŸ§  var è®Šæ•¸è‹¥æ”¾åœ¨block scopeçš„è©±ï¼Œç³»çµ±æœƒå¦‚ä½•æ±ºå®švarè®Šæ•¸çš„scope ->->-> `var è®Šæ•¸ç”±æ–¼æ˜¯å‡ºè‡ªæ–¼åªæœ‰global scopeå’Œfunction scopeçš„ES6ä»¥å‰ç‰ˆæœ¬ï¼Œè‹¥é‡åˆ°ES6å‡ºç¾çš„block scopeï¼Œæœƒç›´æ¥å¿½è¦–block scopeï¼Œä¸¦ä¸”ä¾æ“šå…¶block scopeåŸæœ¬è™•æ–¼çš„scopeæ˜¯å¦ç‚ºfunction scopeä¾†æ±ºå®šè‡ªå·±çš„scopeæ˜¯å¦ç‚ºfunction scope`


---
Status: #ğŸŒ± 
Tags:
[[JavaScript]]
Links:
References:
[[@chengshimanongJSXuanGaoBianShuVar]]
[[@ithomeBianShuJiChu]]