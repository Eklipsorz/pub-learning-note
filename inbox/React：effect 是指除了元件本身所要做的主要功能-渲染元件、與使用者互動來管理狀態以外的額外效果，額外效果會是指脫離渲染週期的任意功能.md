## æè¿°


### React: effect
[[side effect æ˜¯æŒ‡èª¿ç”¨è€…åŸ·è¡Œç‰¹å®šæ“ä½œæˆ–è¡¨é”å¼æˆ–å‡½å¼è€Œå¾—åˆ°é™¤äº†å›å‚³å€¼çµ¦èª¿ç”¨è€…é€™å€‹ä¸»è¦æ•ˆæœä»¥å¤–çš„é¡å¤–æ•ˆæœï¼Œside effect é€šå¸¸æœƒæ˜¯å½±éŸ¿ä¸»èª¿ç”¨è€…æ‰€ä½¿ç”¨çš„å…±äº«è³‡æºä¹‹æ•ˆæœ]]

[[@academindReactcompleteguidecodeButtonModule]]
![](https://res.cloudinary.com/dqfxgtyoi/image/upload/v1663086596/blog/react/effect/react-vs-side-effect_yt8q3n.png)

é‡é»ï¼š
- Effect ç­‰åŒæ–¼ Side Effectï¼Œeffect æœ¬èº«æ˜¯æŒ‡ç‰¹å®šè™•ç†çš„çµæœï¼Œåœ¨é€™è£¡æ³›æŒ‡è‘—åŠŸèƒ½
- Side Effect æ˜¯æŒ‡é™¤äº†ä¸»è¦æ•ˆæœä»¥å¤–çš„é¡å¤–æ•ˆæœï¼š
	- ä¸»è¦æ•ˆæœæœƒæ˜¯æŒ‡å…ƒä»¶æœ¬èº«æ‰€è¦åšçš„ä¸»è¦åŠŸèƒ½-æ¸²æŸ“å…ƒä»¶ã€èˆ‡ä½¿ç”¨è€…äº’å‹•ä¾†ç®¡ç†ç‹€æ…‹ï¼Œå¯¦éš›ä¸Šæœƒä»¥å…ƒä»¶è¢«åŸ·è¡Œä¾†ç”¢å‡ºVirtual DOMè‡³æ¸²æŸ“å¯¦éš›DOMçµæ§‹çš„å¾ªç’°å…§æ‰€å®šç¾©çš„ä»»å‹™å…§å®¹ä¾†ç•¶ä½œä¸»è¦åŠŸèƒ½
	- é¡å¤–æ•ˆæœæœƒæ˜¯æŒ‡é™¤äº†ä¸»è¦æ•ˆæœä»¥å¤–çš„ä»»æ„åŠŸèƒ½ï¼Œä½†åŠŸèƒ½ç¨®é¡æœƒæ˜¯è™•æ–¼ **è„«é›¢å…ƒä»¶è¢«åŸ·è¡Œä¾†ç”¢å‡ºVirtual DOMè‡³æ¸²æŸ“å¯¦éš›DOMçµæ§‹çš„å¾ªç’°** çš„ç‹€æ…‹ä¸‹æ‰èƒ½è¢«æ­£å¸¸åŸ·è¡Œï¼Œå¦å‰‡è‹¥æ˜¯åœ¨èƒ½åœ¨é‚£å¾ªç’°å…§åŸ·è¡Œçš„è©±ï¼Œå°±æœƒè¢«Reactè¦–ç‚ºä¸»è¦åŠŸèƒ½è€ŒåŸ·è¡Œ æˆ–è€… é‡åˆ°ç„¡é™å¾ªç’°çš„å•é¡Œ
	- Side Effect æ¡ˆä¾‹ï¼š
		- åœ¨ç€è¦½å™¨å„²å­˜ç©ºé–“å…§å„²å­˜è³‡æ–™
		- å‚³éè«‹æ±‚è‡³å¾Œç«¯ä¼ºæœå™¨ï¼Œç„¶å¾Œæ¥æ”¶åˆ°å›æ‡‰å°±è§¸ç™¼ç‹€æ…‹æ›´æ–°ã€‚



### æ½›åœ¨å•é¡Œ

#### effect å¯¦ç¾ä»£ç¢¼æ”¾é€²renderçš„è©±
> if we would send a http reqest
> Then we would send this request whenever this function re-runs.

> -> æ¯ç•¶é€™å€‹å‡½å¼é‡è¤‡åŸ·è¡Œï¼Œå°±æœƒç™¼é€è«‹æ±‚

> So for example, whenever this state changes and might sometimes be what you want but definitely not always. And if in response to your http request

> you for example eventually change some state, you would even create an infinite loop



å¦‚æœeffect å¯¦ç¾ä»£ç¢¼æœƒæ˜¯ç™¼é€http è«‹æ±‚ï¼Œä¸¦ä¸”ä»¥å›æ‡‰è§¸ç™¼æ¸²æŸ“é€±æœŸï¼Œæ¥è‘—åœ¨æŠŠå…¶å¯¦ç¾ä»£ç¢¼æ”¾é€²renderçš„è©±ï¼Œæœƒè¡ç”Ÿå‡ºç„¡é™é‡è¤‡å‘¼å«ï¼š
	- ä¸€é–‹å§‹åŸ·è¡Œå…ƒä»¶çš„renderä¾†é–‹å§‹æ¸²æŸ“ï¼Œä¸¦ç™¼é€è«‹æ±‚ï¼Œæ¥è‘—æ¸²æŸ“ç•¶å‰å…ƒä»¶
	- ç­‰åˆ°è«‹æ±‚å›æ‡‰å‚³åˆ°å…ƒä»¶ï¼Œå°±è§¸ç™¼æ¸²æŸ“é€±æœŸ
	- ç”±æ–¼è§¸ç™¼æ¸²æŸ“ï¼Œåˆå†ä¸€æ¬¡å‘¼å«renderï¼Œæ¥è‘—åˆç™¼é€è«‹æ±‚ï¼Œæ¸²æŸ“ç•¶å‰å…ƒä»¶
	- ç­‰åˆ°è«‹æ±‚å›æ‡‰å‚³åˆ°å…ƒä»¶ï¼Œå°±è§¸ç™¼æ¸²æŸ“é€±æœŸ
	- å¾Œé¢å…¨éƒ½æ˜¯é€™å…©å€‹

```
render() {

	// send a request

	// handler 
	const requestHandler = () => {
		setXXXX(XXXX);
	}

	// template
	return (
		....
	)
}
```

#### ç¸½çµ
ä½†å¦‚æœæ’é™¤æ‰httpè«‹æ±‚å’Œå›æ‡‰çš„è©±ï¼Œåªè¦æ˜¯èƒ½å¤ è§¸ç™¼æ¸²æŸ“é€±æœŸçš„side effect æ”¾åœ¨render çš†æœƒæœ‰ç„¡é™è¿´åœˆçš„å•é¡Œï¼Œç„¶è€Œæœ¬èº«ä¸¦ä¸æœƒè§¸ç™¼æ¸²æŸ“é€±æœŸçš„side effect æ”¾åœ¨render æœ¬èº«æœƒå› ç‚ºä¸æœƒå†æ¬¡å‘¼å«renderè€Œä¸æœƒæœ‰ç„¡é™è¿´åœˆçš„å•é¡Œã€‚


ç¸½çµï¼š
- åªè¦æ˜¯èƒ½å¤ è§¸ç™¼æ¸²æŸ“é€±æœŸçš„side effect æ”¾åœ¨ render æˆ–è€… function componentå…§éƒ¨çš„è©±ï¼Œå°±æœƒæœ‰ç„¡é™è¿´åœˆçš„æ½›åœ¨å•é¡Œ
- åªè¦ä¸èƒ½å¤ æ¸²æŸ“é€±æœŸçš„side effect æ”¾åœ¨ render æˆ–è€… function componentå…§éƒ¨çš„è©±ï¼Œå°±ä¸æœƒæœ‰ç„¡é™è¿´åœˆçš„æ½›åœ¨å•é¡Œ


#### è§£æ³•

å°‡èƒ½å¤ è§¸ç™¼æ¸²æŸ“é€±æœŸçš„side effect æ”¹æ”¾é€²ä¸€å€‹ç¨ç«‹çš„åŸ·è¡Œç’°å¢ƒï¼Œæ¯”å¦‚
	- function componentï¼šä½¿ç”¨useEffectæ‰€å»ºç«‹çš„åŸ·è¡Œç’°å¢ƒ
	- classï¼šä½¿ç”¨ç”Ÿå‘½é€±æœŸå‡½å¼ï¼Œé€šå¸¸æœƒæ”¾åœ¨
		- componentDidMount
		- componentDidUpdate
		- componentWillUnmount

#### ç¾å¯¦å±¤é¢
é€šå¸¸æœƒæƒ³é€éeffectä¾†å¯¦ç¾åŠŸèƒ½çš„å¯¦ä¾‹æœƒæ˜¯å‰ç«¯å‘å¾Œç«¯ä¼ºæœå™¨è«‹æ±‚ä¸¦ä»¥å…¶è«‹æ±‚å›æ‡‰è§¸ç™¼æ¸²æŸ“ï¼Œè€Œä½¿ç”¨é »ç‡æ¥µç‚ºå¸¸è¦‹ï¼Œä¸¦ä¸”é€™æ¨£ç­‰åŒæ–¼éœ€è¦èƒ½å¤ è§¸ç™¼æ¸²æŸ“é€±æœŸçš„side effect ï¼Œå› æ­¤æ‰å¿…é ˆè€ƒæ…®side effectè¦åœ¨å“ªå€‹åŸ·è¡Œç’°å¢ƒåŸ·è¡Œã€‚

## è¤‡ç¿’

#ğŸ§  React ï¼šeffect æ˜¯ã„“ ->->-> ``



---
Status: #ğŸŒ± #ğŸ““ 
Tags:
[[React]]
Links:
[[side effect æ˜¯æŒ‡èª¿ç”¨è€…åŸ·è¡Œç‰¹å®šæ“ä½œæˆ–è¡¨é”å¼æˆ–å‡½å¼è€Œå¾—åˆ°é™¤äº†å›å‚³å€¼çµ¦èª¿ç”¨è€…é€™å€‹ä¸»è¦æ•ˆæœä»¥å¤–çš„é¡å¤–æ•ˆæœï¼Œside effect é€šå¸¸æœƒæ˜¯å½±éŸ¿ä¸»èª¿ç”¨è€…æ‰€ä½¿ç”¨çš„å…±äº«è³‡æºä¹‹æ•ˆæœ]]
References:
[[@academindReactcompleteguidecodeButtonModule]]