## æè¿°


### å•é¡ŒèƒŒæ™¯

useEffect åœ¨é‡åˆ°é »ç¹ç™¼é€äº‹ä»¶è§¸ç™¼çš„å ´æ™¯ä¸‹æ˜¯å–å¾—æœ€è¿‘æœ€æ–°å›æ‡‰ä½œç‚ºæœ€å¾Œçµæœä¾†è™•ç†çš„è©±ï¼Œå–å¾—æœ€è¿‘è¼ƒæ–°å›æ‡‰ä½œç‚ºæœ€å¾Œçµæœä¹‹å‰ï¼Œæœƒå› ç‚ºNå€‹äº‹ä»¶è§¸ç™¼è€Œç”¢ç”ŸNå€‹è¦åŸ·è¡Œeffectçš„æ¸²æŸ“è«‹æ±‚ï¼Œä½†é€™Nå€‹æ¸²æŸ“è«‹æ±‚çš„è™•ç†æˆæœ¬å°æ–¼çµè«–è€Œè¨€ï¼Œæ˜¯ä¸å¿…è¦çš„æµªè²»


### è§£æ±ºç›®æ¨™
ç‚ºäº†èƒ½åœ¨é »ç¹ç™¼é€äº‹ä»¶è§¸ç™¼çš„å ´æ™¯ä¸‹æ˜¯å–å¾—æœ€è¿‘æœ€æ–°å›æ‡‰ ä¸¦ä¸” ç›¡å¯èƒ½æ¸›å°‘åœ¨å–å¾—ä¹‹å‰çš„è«‹æ±‚è™•ç†æˆæœ¬ï¼Œæœƒæ¡ç”¨ä»¥ä¸‹ç­–ç•¥ï¼š
	- æ¯ä¸€æ¬¡äº‹ä»¶è§¸ç™¼çš„è™•ç†æœƒæ˜¯ä»¥
		- æ¸…é™¤ä¸Šä¸€å€‹è™•ç†æ‰€ç”¢ç”Ÿçš„éåŒæ­¥è¨ˆæ™‚ä»»å‹™(timer task)
		- ç”Ÿæˆä¸€å€‹éåŒæ­¥è¨ˆæ™‚ä»»å‹™ (timer task)
	- æ¯ä¸€æ¬¡äº‹ä»¶è§¸ç™¼çš„è™•ç†æœƒæ˜¯ä»¥
		- æ¸…é™¤ä¸Šä¸€å€‹è™•ç†æ‰€ç”¢ç”Ÿçš„éåŒæ­¥ä»»å‹™
		- ç”Ÿæˆä¸€å€‹éåŒæ­¥ä»»å‹™


[[debouncing åœ¨é›»è…¦é–‹ç™¼å¯¦è¸çš„æ‰‹æ®µï¼Œåœ¨é€£çºŒç™¼é€äº‹ä»¶è§¸ç™¼çš„å ´æ™¯ä¸‹ï¼Œä»¥ç¢ºä¿èƒ½å–å¾—æœ€å¾Œçš„äº‹ä»¶è§¸ç™¼è³‡è¨Šçš„å½¢å¼ä¾†é™ä½è«‹æ±‚æ–¹å’Œè™•ç†æ–¹ä¹‹é–“çš„å›æ‡‰é€Ÿåº¦ã€‚]]
#### ä½¿ç”¨setTimeout + cleanup
åœ¨é€™è£¡æ˜¯æ¡å–
	- æ¯ä¸€æ¬¡äº‹ä»¶è§¸ç™¼çš„è™•ç†æœƒæ˜¯ä»¥
		- æ¸…é™¤ä¸Šä¸€å€‹è™•ç†æ‰€ç”¢ç”Ÿçš„éåŒæ­¥è¨ˆæ™‚ä»»å‹™(timer task)
		- ç”Ÿæˆä¸€å€‹éåŒæ­¥è¨ˆæ™‚ä»»å‹™ (timer task)
å¯¦ç¾æ–¹å¼ç‚ºï¼š
- æ¯ä¸€æ¬¡effectè§¸ç™¼å°±æ¸…é™¤ä¸Šä¸€å€‹effectè§¸ç™¼è™•ç†ç”Ÿæˆçš„éåŒæ­¥è¨ˆæ™‚ä»»å‹™(timer task)ï¼šä»¥effect çš„cleanupä¾†å¯¦ç¾ï¼Œå…¶identifieræœƒæ˜¯è¨˜éŒ„ä¸Šä¸€å€‹è™•ç†è€Œç”Ÿæˆçš„è¨ˆæ™‚ä»»å‹™ID
```
return () => {
		clearTimeout(identifier);
}
```
- ç‚ºç•¶å‰effectè§¸ç™¼è™•ç†è€Œç”Ÿæˆä¸€å€‹éåŒæ­¥è¨ˆæ™‚ä»»å‹™ï¼šä»¥setTimeout(callback,500)ä¾†ç”ŸæˆéåŒæ­¥ä»»å‹™ï¼Œä¸¦å›å‚³å…¶ä»»å‹™IDä½œç‚ºcleanupçš„ä¾æ“š
```
    const identifier = setTimeout(() => {
	    // do something
	    setState(....);
    }, 500);
```


æœ€å¾Œæœƒæ˜¯ï¼š

```
 useEffect(() => {
    const identifier = setTimeout(() => {
	    // do something
	    setState(....);
    }, 500);

	return () => {
		clearTimeout(identifier);
	}
	
  }, dependencies);
```


å¦‚æœæˆ‘å€‘æƒ³è¦å»é€éUIçš„äº’å‹•ä¾†é€http è«‹æ±‚ï¼Œè‹¥åŒæ¨£ä»¥æœ€è¿‘çµæœä½œç‚ºæœ€å¾Œçµæœä¾†è™•ç†ï¼Œé‚£éº¼å°±èƒ½ä½¿ç”¨setTimeoutå’Œcleanupä¾†è™•ç†ï¼Œä»¥ç¢ºä¿æœ€å¾Œè«‹æ±‚åªæœƒæ˜¯ä¸€å€‹ä¸”æœƒæ˜¯ä»¥æœ€æ–°æœ€è¿‘çš„çµæœä¾†ç™¼é€



### cleanup function

[[Reactï¼šuseEffect cleanup æŠ€è¡“ä¸»è¦æ˜¯åœæ­¢ç•¶å‰side effectæ‰€ç”¢ç”Ÿçš„éåŒæ­¥ä»»å‹™]]



### clearTimout åŠŸç”¨

[[@mdnClearTimeoutWebAPIs]]
>  The global clearTimeout() method cancels a timeout previously established by calling setTimeout().

> If the parameter provided does not identify a previously established action, this method does nothing. 

```
clearTimeout(timeoutID)
```


é‡é»ï¼š
- clearTimeout å–æ¶ˆé‚„æœªåŸ·è¡Œå®Œæˆçš„setTimeoutä»»å‹™
- clearTimeout(timeoutID) çš„ timeoutID ï¼š
	- timeoutID æ˜¯ timeoutä»»å‹™ID
	- timeoutID å¯ä»¥setTimeouté‚£é‚Šå–å¾—

## è¤‡ç¿’

---
Status: #ğŸŒ± #ğŸ““ 
Tags:
[[React]]
Links:
[[Reactï¼šuseEffect & Dependencies ä¹‹é–“é—œä¿‚å°±åœ¨æ–¼æ¯ä¸€æ¬¡effectè¢«è§¸ç™¼æ™‚æœƒæª¢æŸ¥æ˜¯å¦æœ‰ä»»ä¸€dependencyæœ‰æ”¹è®Šè€ŒåŸ·è¡Œå°æ‡‰çš„callback]]
[[Reactï¼šuseEffect ä½¿ç”¨æ–¹å¼æ˜¯æ›¿ç•¶å‰å…ƒä»¶è¨»å†Šeffecté€™å€‹hookä¸¦æ–¼æ¯å€‹æ¸²æŸ“éšæ®µä¸‹ä¾†åˆ¤å®šæ˜¯å¦èƒ½åŸ·è¡Œå°æ‡‰çš„callback]]
[[Reactï¼šeffect æ˜¯æŒ‡é™¤äº†å…ƒä»¶æœ¬èº«æ‰€è¦åšçš„ä¸»è¦åŠŸèƒ½-æ¸²æŸ“å…ƒä»¶ã€èˆ‡ä½¿ç”¨è€…äº’å‹•ä¾†ç®¡ç†ç‹€æ…‹ä»¥å¤–çš„é¡å¤–æ•ˆæœï¼Œé¡å¤–æ•ˆæœæœƒæ˜¯æŒ‡è„«é›¢æ¸²æŸ“é€±æœŸçš„ä»»æ„åŠŸèƒ½]]
[[Reactï¼šuseEffect cleanup æŠ€è¡“ä¸»è¦æ˜¯åœæ­¢ç•¶å‰side effectæ‰€ç”¢ç”Ÿçš„éåŒæ­¥ä»»å‹™]]
[[debouncing åœ¨é›»è…¦é–‹ç™¼å¯¦è¸çš„æ‰‹æ®µï¼Œåœ¨é€£çºŒç™¼é€äº‹ä»¶è§¸ç™¼çš„å ´æ™¯ä¸‹ï¼Œä»¥ç¢ºä¿èƒ½å–å¾—æœ€å¾Œçš„äº‹ä»¶è§¸ç™¼è³‡è¨Šçš„å½¢å¼ä¾†é™ä½è«‹æ±‚æ–¹å’Œè™•ç†æ–¹ä¹‹é–“çš„å›æ‡‰é€Ÿåº¦ã€‚]]
References:
[[@mdnClearTimeoutWebAPIs]]
[[@pomingleeDrLeeBlog2013]]
[[@geeksforgeeksDebouncingJavaScript2018]]