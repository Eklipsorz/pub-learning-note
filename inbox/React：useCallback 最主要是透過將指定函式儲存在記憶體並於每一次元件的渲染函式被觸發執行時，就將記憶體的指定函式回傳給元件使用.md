## æè¿°

[[React.memo æ¯”å°æ–¹å¼æœƒæ¡ç”¨æ–¼JSçš„currProp === prevProp è€Œè¡ç”Ÿå‡ºpropså°æ‡‰è‘—ç‰©ä»¶çš„å…ƒä»¶aæœƒå› ç‚ºæ¸²æŸ“å‡½å¼ä¸€ç›´é‚Šå‘¼å«é‚Šé‡å»ºç‰©ä»¶è€Œç„¡æ³•è®“å…ƒä»¶aèƒ½å¤ æ­£å¸¸ä½¿ç”¨memo]]

[[@ithomeDay9ReactHookPianRenShi]]
```jsx
const memoizedCallback = useCallback(
  () => {
    doSomething(a, b);
  },
  [a, b],
);
```

> -   ç¬¬ä¸€å€‹åƒæ•¸æ˜¯ callback function
> -   ç¬¬äºŒå€‹åƒæ•¸æ˜¯ä¸€å€‹é™£åˆ—ï¼Œæ­¤é™£åˆ—ä¸ä½œç‚ºå‚³åˆ° callback function çš„åƒæ•¸
	    -   `useCallback(callback)`: å¦‚æœæ²’æœ‰åŠ ä¸Šé€™å€‹é™£åˆ—ï¼Œæ¯æ¬¡éƒ½æœƒé‡æ–°åŸ·è¡Œå‡½å¼å»ç”¢ç”Ÿæ–°çš„å‡½å¼
	    -   `useCallback(callback, [])`: ç©ºé™£åˆ—çš„è©±ï¼Œå›å‚³çš„å‡½å¼ä¸æœƒæ”¹è®Š
	    -   `useCallback(callback, [...someValues])`: æœ‰åŠ ä¸Šä¸€äº›å…ƒç´ å€¼çš„è©±ï¼Œç•¶å…ƒç´ å€¼æ”¹è®Šæ™‚æœƒé‡æ–°æ›´æ–°å›å‚³çš„å‡½å¼

é‡é»ï¼š
- useCallback æœ€ä¸»è¦æ˜¯é€éå°‡æŒ‡å®šå‡½å¼å„²å­˜åœ¨è¨˜æ†¶é«”ä¸¦æ–¼æ¯ä¸€æ¬¡å…ƒä»¶çš„æ¸²æŸ“å‡½å¼è¢«è§¸ç™¼åŸ·è¡Œæ™‚ï¼Œæœƒæª¢æ¸¬ä¾è³´æ˜¯å¦è®Šå‹•ä¾†å°‡å„²å­˜è¨˜æ†¶é«”å…§çš„æŒ‡å®šå‡½å¼å›å‚³çµ¦å…ƒä»¶ä½¿ç”¨ï¼Œé€™è§£æ±ºäº†ï¼š
	- ç”±propså°æ‡‰è‘—ç‰©ä»¶çš„å…ƒä»¶Aæœƒå› ç‚ºJSåŸç”Ÿæ¯”å°å•é¡Œä»¥åŠæ¯ä¸€æ¬¡æ¸²æŸ“å‡½å¼è¢«å‘¼å«å°±é‡å»ºç‰©ä»¶è€Œå°è‡´å…ƒä»¶Açš„propsæ¯”å°çµæœéƒ½ä¸ä¸€æ¨£ï¼Œé€²è€Œç„¡æ³•æ­£å¸¸ä½¿ç”¨memo
- useCallback å¦‚åŒåç¨±é‚£æ¨£ï¼Œæœƒå°ˆé–€å„²å­˜ä¸€å€‹ç‰¹å®šfunctionä½œç‚ºä»¥å¾Œæ–¹ä¾¿åŸ·è¡Œç”¨
- èªæ³•ï¼š 
	- ç¬¬ä¸€å€‹åƒæ•¸æ˜¯ç”¨å‡½å¼ç‰©ä»¶ä¾†å®šç¾©æ¯ä¸€æ¬¡æ‰€å»ºç«‹çš„å‡½å¼ç‰©ä»¶ä¹‹åŸºæœ¬å‡½å¼æ¶æ§‹-baseFunction
	- ç¬¬äºŒå€‹åƒæ•¸æœƒæ˜¯ä¾è³´é …ç›®æ‰€æ§‹æˆçš„é™£åˆ—ï¼Œæ±ºå®šæ˜¯å¦è¦åœ¨åŸºæœ¬å‡½å¼æ¶æ§‹baseFunctionæ­é…ç›®å‰çš„ä¾è³´é …ç›®ä¾†å»ºç«‹æ–°çš„å‡½å¼ç‰©ä»¶ï¼Œå…¶å‡½å¼ç‰©ä»¶æœƒæ“æœ‰æ–°çš„closure
	- å›å‚³å€¼æœƒæ˜¯baseFunctionç‚ºä¸»çš„æ–°å‡½å¼ç‰©ä»¶
		- è‹¥deps ç‚ºç©ºé™£åˆ—ï¼Œå°±æœƒè¢«ç³»çµ±èªå®šä¸æœƒè¢«æ”¹è®Šçš„ä¾è³´é …ç›®ï¼Œå›å‚³çš„å‡½å¼ç‰©ä»¶å°±æœƒä»¥è¨˜æ†¶é«”å…§çš„ç›®å‰æœ€æ–°å‡½å¼ç‰©ä»¶å›å‚³ï¼Œè€Œä¸é‡æ–°ä»¥baseFunctionç‚ºä¸»ä¾†å¾è€Œå»ºç«‹æ–°å‡½å¼ç‰©ä»¶
		- è‹¥æ²’æ·»åŠ \[deps\]ï¼Œå°±æœƒè¢«ç³»çµ±èªå®šç‚ºä¸€ç›´è¢«æ”¹è®Šçš„ä¾è³´é …ç›®ï¼Œé€²è€Œæ¯ä¸€æ¬¡åŸ·è¡Œéƒ½æœƒé‡æ–°ä»¥baseFunctionç‚ºä¸»ä¾†å»ºç«‹æ–°çš„å‡½å¼ç‰©ä»¶å›å‚³
		- è‹¥æ·»åŠ \[a, b\]ï¼Œæœƒå…ˆåˆ¤æ–·aæˆ–è€…bæ˜¯å¦æœ‰ä»»ä¸€è®Šå‹•ï¼Œæœ‰è®Šå‹•æ‰é‡æ–°ä»¥baseFunctionç‚ºä¸»ä¾†å»ºç«‹æ–°çš„å‡½å¼ç‰©ä»¶å›å‚³ï¼›æ²’è®Šå‹•å°±ä¸åŸ·è¡Œï¼Œç›´æ¥å›å‚³è¨˜æ†¶é«”å…§çš„ç›®å‰æœ€æ–°å‡½å¼ç‰©ä»¶
```
const callbackResult = useCallback(baseFunction, [a, b])
```

### useCallback ä½•æ™‚æª¢æŸ¥ä¸¦è§¸ç™¼ï¼Ÿ
[[@vencovskyAnswerWhenUse2019]]

> useCallback
> On every render, everything that's inside a functional component will run again.

é‡é»ï¼š
- æ¯ä¸€æ¬¡åŸ·è¡Œå…ƒä»¶çš„renderå‡½å¼å°±æœƒåŸ·è¡ŒuseCallbackï¼Œä¸¦æª¢æŸ¥useCallbackæ‰€ä¾è³´çš„å…§å®¹æ˜¯å¦æœ‰è®Šå‹•ã€‚

### function è¢«å„²å­˜åœ¨å“ªï¼Ÿ

åŸºæœ¬ä¸Šæœƒå„²å­˜åœ¨React é«”ç³»ä¸‹å…§éƒ¨çš„å„²å­˜å€å¡Š


## è¤‡ç¿’


---
Status: #ğŸŒ± #ğŸ“
Tags:
[[React]]
Links:
[[React.memo æ¯”å°æ–¹å¼æœƒæ¡ç”¨æ–¼JSçš„currProp === prevProp è€Œè¡ç”Ÿå‡ºpropså°æ‡‰è‘—ç‰©ä»¶çš„å…ƒä»¶aæœƒå› ç‚ºæ¸²æŸ“å‡½å¼ä¸€ç›´é‚Šå‘¼å«é‚Šé‡å»ºç‰©ä»¶è€Œç„¡æ³•è®“å…ƒä»¶aèƒ½å¤ æ­£å¸¸ä½¿ç”¨memo]]

References:
[[@reactHooksAPICanKao]]
[[@ithomeDay9ReactHookPianRenShi]]