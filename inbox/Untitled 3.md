## 描述

[[@ithomeDay04DOM]]
> DOM 節點與瀏覽器中的渲染引擎綁定，當我們在操作 DOM 的時候就會連帶觸發瀏覽器的渲染引擎進行一連串更新畫面的流程，因此 DOM 的操作在效能上是相對昂貴的動作，當畫面上有大量的 DOM 在短時間內異動時更容易出現畫面上的卡頓等等問題。因此，在瀏覽器中盡可能地減少 DOM 操作 —— 具體來說，應該是「以最少的 DOM 操作來達到所需要的畫面結果」，將會是前端效能優化的重要關鍵。


重點：
- 傳統上為了讓瀏覽器呈現想要的畫面，會以能用DOM 節點表示畫面上的元件並且使用其 API方式來決定畫面，而對應DOM API會被轉換出一系列指示瀏覽如何更新畫面的指令或者渲染指令。
- 潛在問題：
	- 若在短時間內發生大量DOM API來決定畫面是什麼，那麼就產生出大量的渲染指令來告知瀏覽器要如何渲染
- 對於前端開發來說，效能可以從 **以最少的DOM操作來達到所想要的畫面結果** 來進行改善。

### Virtual DOM 是什麼

[[@ithomeDay04DOM]]
> 意義上來說，Virtual DOM 是真實 DOM 的虛構描述體，它實際上也是一種樹狀結構的資料。

> **每一個 Virtual DOM element 的資料都是普通的 JavaScript 物件變數，內容則嘗試在描述一個真實的 DOM element 預計要長的樣子**（像是元素類型、屬性、子元素有哪些…等等資訊）。接著透過負責渲染畫面的程式處理後，就能將 Virtual DOM element 轉換並產生成實際的 DOM element，以更新瀏覽器的實際畫面。

重點：
- Virtual DOM 節點/結構 本身是指電腦程式針對對應Real DOM 節點/結構 來生成相同特性和行為的DOM 物件結構，只是該DOM物件結構只能夠存在於特定系統上，在這裡會存在於React層級上
- Virtual DOM 節點/結構 在React上的結構：
	- 主要會以JS物件來對應Real DOM節點
	- 其屬性(property)會有對應Real DOM節點會有的資訊，如元素種類、屬性值(attribute)、包含的子節點會有什麼
- Virtual DOM


### Virtual DOM為何出現？

> 你可以想像 Virtual DOM 就像是畫面產生的模擬彩排場，每次有新 UI 畫面產生的需求時，我們可以用以下流程來完成畫面更新：

> 1.  **透過事先定義好的模板程式來產生新的 Virtual DOM Tree ，作為新的彩排結果**
> 2.  **並且與此前最後一次舊畫面用的 Virtual DOM Tree 進行兩棵樹的結構細節比較，其中差異之處才是本次畫面更新中真正有需要變更的部分**
> 3.  將新舊 Virtual DOM Tree 中有差異的部分更新到真實的 DOM Tree 中，以完成瀏覽器畫面的更新

> 透過這個流程，我們就可以將真實的 DOM 操作範圍最小化，並限縮在這些真正需要變更的地方，來盡可能的減少因 DOM 操作而造成的效能花費。

![](https://miro.medium.com/max/1400/1*ZXE-64hJcWYfNjmWAjiRmw.png)








### Virtual 命名緣由
virtual adj 
> You can use virtual to indicate that something is so nearly true that for most purposes it can be regarded as true.

virtual adj
> objects and activities are generated by a computer to simulate real objects and activities.

virtual adj
> made to appear to exist by the use of computer software, for example on the internet

重點：
- 由程式或者電腦依照實體物件A擁有的特徵、行為來生成另一個相同特徵、行為的物件B，但物件A和物件B本身的存在性質上會是不一樣，比如物件A存在於現實，而物件B只存在於電腦或者特定系統中

## 複習


---
Status: #🌱 #📓 
Tags:
[[React]]
Links:
References:
[[@ithomeDay04DOM]]