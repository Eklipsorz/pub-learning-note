## 描述

[[@ithomeDay04DOM]]
> DOM 節點與瀏覽器中的渲染引擎綁定，當我們在操作 DOM 的時候就會連帶觸發瀏覽器的渲染引擎進行一連串更新畫面的流程，因此 DOM 的操作在效能上是相對昂貴的動作，當畫面上有大量的 DOM 在短時間內異動時更容易出現畫面上的卡頓等等問題。因此，在瀏覽器中盡可能地減少 DOM 操作 —— 具體來說，應該是「以最少的 DOM 操作來達到所需要的畫面結果」，將會是前端效能優化的重要關鍵。


重點：
- 傳統上為了讓瀏覽器呈現想要的畫面，會以能用DOM 節點表示畫面上的元件並且使用其 API方式來決定畫面，而對應DOM API會被轉換出一系列指示瀏覽如何更新畫面的指令或者渲染指令。
- 潛在問題：
	- 若在短時間內發生大量DOM API來決定畫面是什麼，那麼就產生出大量的渲染指令來告知瀏覽器要如何渲染，以至於讓畫面的呈現效率下降
- 對於前端開發來說，效能可以從 **以最少的 DOM API操作來達到所想要的畫面結果** 來進行改善。

### Virtual DOM 是什麼

[[@ithomeDay04DOM]]
> 意義上來說，Virtual DOM 是真實 DOM 的虛構描述體，它實際上也是一種樹狀結構的資料。

> **每一個 Virtual DOM element 的資料都是普通的 JavaScript 物件變數，內容則嘗試在描述一個真實的 DOM element 預計要長的樣子**（像是元素類型、屬性、子元素有哪些…等等資訊）。接著透過負責渲染畫面的程式處理後，就能將 Virtual DOM element 轉換並產生成實際的 DOM element，以更新瀏覽器的實際畫面。



重點：
- Virtual DOM 節點/結構 本身是指電腦程式針對對應Real DOM 節點/結構 來生成相同特性和行為的DOM 物件結構，只是該DOM物件結構只能夠存在於特定系統上，在這裡會存在於React層級上
- React 主要會以Virtual DOM為單位來處理元件的構建
- Virtual DOM 節點/結構 在React上的結構：
	- 主要會以JS物件來對應Real DOM節點
	- 其屬性(property)會有對應Real DOM節點會有的資訊，如元素種類、屬性值(attribute)、包含的子節點會有什麼
- Virtual DOM 節點/結構 在React層級上會有程式模組專門轉換成 對應的Real DOM元素

### Real DOM vs. Virtual DOM

> 雖然每次重新產生畫面的 Virtual DOM 資料，並且與舊有的 Virtual DOM 進行詳細的樹狀結構比較都會有效能上的花費，但是畢竟操作的是普通的 JavaScript 物件資料，並且與真實的 DOM 不同的是，**Virtual DOM 並沒有與瀏覽器的渲染引擎做直接的綁定**，因此整體來說還是比頻繁且大量的操作真實 DOM 的效能花費要低了許多。


重點：
- 用途：Real DOM是直接表達對應畫面且指示瀏覽器該如何渲染；Virtual DOM是從Real DOM抽離出來的版本，該版本僅描述對應畫面的 DOM結構，並沒辦法指示瀏覽器該如何渲染，用途為描述用的藍圖
- 誰能直接告知瀏覽器如何渲染：Real DOM 能直接指示 ； Virtual DOM沒辦法
- 如何指示瀏覽器來渲染畫面，不分直接或者間接：Real DOM 能直接指示 ； Virtual DOM 先轉換成對應Real DOM，然後以Real DOM來指示渲染畫面


### Virtual DOM為何出現？
[[@ithomeDay04DOM]]
> 你可以想像 Virtual DOM 就像是畫面產生的模擬彩排場，每次有新 UI 畫面產生的需求時，我們可以用以下流程來完成畫面更新：

> 1.  **透過事先定義好的模板程式來產生新的 Virtual DOM Tree ，作為新的彩排結果**
> 2.  **並且與此前最後一次舊畫面用的 Virtual DOM Tree 進行兩棵樹的結構細節比較，其中差異之處才是本次畫面更新中真正有需要變更的部分**
> 3.  將新舊 Virtual DOM Tree 中有差異的部分更新到真實的 DOM Tree 中，以完成瀏覽器畫面的更新

> 透過這個流程，我們就可以將真實的 DOM 操作範圍最小化，並限縮在這些真正需要變更的地方，來盡可能的減少因 DOM 操作而造成的效能花費。

![](https://miro.medium.com/max/1400/1*ZXE-64hJcWYfNjmWAjiRmw.png)

重點：
- Virtual DOM 概念的提出原因：
	- 為了實現 **以最少的Real DOM操作來達到所想要的畫面結果**。
-  **以最少的Real DOM操作來達到所想要的畫面結果** ：會將真正要修改的DOM 結構和操作僅限於真正需要的地方，而非整體。

- 首先先以JS層級來將Real DOM結構抽離出 **僅描述相對應畫面的DOM結構**，並以此結構作為藍圖來指示要如何修改對應的Real DOM結構。 該藍圖就是Virtual DOM：
		- 以將要渲染在Real DOM Tree的畫面轉換成對應的Virtual DOM結構
		- 第一項所獲得的結構與目前畫面對應的Virtual DOM結構比較差異
		- 獲取差異後，就交給React層級的轉換程式來轉換成對應Real DOM節點/結構來更新目前DOM Tree更新，其對應Real DOM節點/結構會是以差異為主，而非以整體。



### 誤解：Virtual DOM 是從真實 DOM 複製一份出來的 copy

[[@ithomeDay04DOM]]
> Virtual DOM 是從真實 DOM 複製一份出來的 copy

重點：
- Virtual DOM 是從真實 DOM 複製一份出來的 copy 這項論點是錯的。
- Virtual DOM 本身是從Real DOM抽離出來的版本，該版本僅描述著對應畫面的DOM結構。


### Virtual 命名緣由
virtual adj 
> You can use virtual to indicate that something is so nearly true that for most purposes it can be regarded as true.

virtual adj
> objects and activities are generated by a computer to simulate real objects and activities.

virtual adj
> made to appear to exist by the use of computer software, for example on the internet

重點：
- 由程式或者電腦依照實體物件A擁有的特徵、行為來生成另一個相同特徵、行為的物件B，但物件A和物件B本身的存在性質上會是不一樣，比如物件A存在於現實，而物件B只存在於電腦或者特定系統中

## 複習

#🧠 在沒使用Virtual DOM時代前，前端開發者都是使用什麼介面和處理來讓瀏覽器呈現想要的畫面？ ->->-> `DOM 節點表示畫面上的元件並且使用其 API方式來決定畫面`
<!--SR:!2022-10-13,9,250-->

#🧠 傳統上為了讓瀏覽器呈現想要的畫面，會以能用DOM 節點表示畫面上的元件並且使用其 API方式來決定畫面，DOM API能夠被瀏覽器直接執行並渲染畫面嗎？ ->->-> `不能`
<!--SR:!2022-10-04,3,250-->

#🧠 傳統上為了讓瀏覽器呈現想要的畫面，會以能用DOM 節點表示畫面上的元件並且使用其 API方式來決定畫面，DOM API不能夠被瀏覽器直接執行並渲染畫面 ，那麼如何才能被瀏覽器執行並渲染畫面？ ->->-> `轉換成一系列能夠讓瀏覽器解析並執行的指令或者渲染指令`
<!--SR:!2022-10-04,3,250-->

#🧠 傳統上為了讓瀏覽器呈現想要的畫面，會以能用DOM 節點表示畫面上的元件並且使用其 API方式來決定畫面，而對應DOM API會被轉換出一系列指示瀏覽如何更新畫面的指令或者渲染指令，其潛在問題是什麼？ ->->-> `若在短時間內發生大量DOM API來決定畫面是什麼，那麼就產生出大量的渲染指令來告知瀏覽器要如何渲染，以至於讓畫面的呈現效率下降`
<!--SR:!2022-10-13,9,250-->


#🧠 以DOM API來決定更新畫面，面對其潛在問題-若在短時間內發生大量DOM API來決定畫面是什麼，會使呈現效率下降來說，要以什麼方向來改善->->-> `對於前端開發來說，效能可以從 **以最少的 DOM API操作來達到所想要的畫面結果** 來進行改善。`
<!--SR:!2022-10-14,10,250-->


#🧠 Virtual 命名緣由 ->->-> `由程式或者電腦依照實體物件A擁有的特徵、行為來生成另一個相同特徵、行為的物件B，但物件A和物件B本身的存在性質上會是不一樣，比如物件A存在於現實，而物件B只存在於電腦或者特定系統中`
<!--SR:!2022-10-14,10,250-->

#🧠 Virtual DOM 概念的提出原因？ ->->-> `為了實現 **以最少的Real DOM操作來達到所想要的畫面結果**`
<!--SR:!2022-10-04,3,250-->

#🧠 Virtual DOM 概念的提出原因是為了實現 **以最少的Real DOM操作來達到所想要的畫面結果**，具體會是什麼概念？ ->->-> `會將真正要修改的DOM 結構和操作僅限於真正需要的地方，而非整體。`
<!--SR:!2022-10-04,3,250-->

#🧠 Virtual DOM 概念的提出原因是為了實現 **以最少的Real DOM操作來達到所想要的畫面結果**：會將真正要修改的DOM 結構和操作僅限於真正需要的地方，而非整體，那麼具體上如何實現？ ->->-> `首先先以JS層級來將Real DOM結構抽離出 **僅描述相對應畫面的DOM結構**，並以此結構作為藍圖來指示要如何修改對應的Real DOM結構。 該藍圖就是Virtual DOM，		- 以將要渲染在Real DOM Tree的畫面轉換成對應的Virtual DOM結構 - 第一項所獲得的結構與目前畫面對應的Virtual DOM結構比較差異 - 獲取差異後，就交給React層級的轉換程式來轉換成對應Real DOM節點/結構來更新目前DOM Tree更新，其對應Real DOM節點/結構會是以差異為主，而非以整體。`
<!--SR:!2022-10-13,9,250-->

#🧠 以Virtual DOM做為畫面的藍圖，具體如何實現會將真正要修改的DOM 結構和操作僅限於真正需要的地方，而非整體 ->->-> `		- 以將要渲染在Real DOM Tree的畫面轉換成對應的Virtual DOM結構 - 第一項所獲得的結構與目前畫面對應的Virtual DOM結構比較差異 - 獲取差異後，就交給React層級的轉換程式來轉換成對應Real DOM節點/結構來更新目前DOM Tree更新，其對應Real DOM節點/結構會是以差異為主，而非以整體。`
<!--SR:!2022-10-04,3,250-->

#🧠 Virtual DOM 就是 Real DOM的副本？ ->->-> `並不算，Virtual DOM 本身是從Real DOM抽離出來的版本，該版本僅描述著對應畫面的DOM結構。`
<!--SR:!2022-10-04,3,250-->

#🧠 Virtual 命名緣由為由程式或者電腦依照實體物件A擁有的特徵、行為來生成另一個相同特徵、行為的物件B，但物件A和物件B本身的存在性質上會是不一樣，比如物件A存在於現實，而物件B只存在於電腦或者特定系統中，那麼Virtaul DOM又會是？ ->->-> `Virtual DOM 節點/結構 本身是指電腦程式針對對應Real DOM 節點/結構 來生成相同特性和行為的DOM 物件結構，只是該DOM物件結構只能夠存在於特定系統上，在這裡會存在於React層級上`
<!--SR:!2022-10-04,3,250-->


#🧠 每個Virtual DOM與Real DOM 之間的關係是？ ->->-> `每個Virtual DOM最主要會對應著特定Real DOM`
<!--SR:!2022-10-04,3,250-->

#🧠 Virtual DOM是由誰製作？ ->->-> `由JS程式模組來打造`
<!--SR:!2022-10-14,10,250-->

#🧠 Virtual DOM是由JS程式模組來打造，那麼其結構會是什麼？詳細說明 ->->-> `	- 主要會以JS物件來對應Real DOM節點 - 其屬性(property)會有對應Real DOM節點會有的資訊，如元素種類、屬性值(attribute)、包含的子節點會有什麼`
<!--SR:!2022-10-13,9,250-->

#🧠 在ReactJS和瀏覽器這兩者中，誰專門識別並處理Virtual DOM和Real DOM ->->-> `ReactJS負責Virtual DOM；瀏覽器負責Real DOM`
<!--SR:!2022-10-04,3,250-->

#🧠 React 以什麼來定義畫面？ 或者說JSX元素背後會是什麼？->->-> `Virtual DOM結構`
<!--SR:!2022-10-04,3,250-->


#🧠 Virtual DOM在Reac.js會是什麼結構 ->->-> `物件`
<!--SR:!2022-10-04,3,250-->

#🧠 Virtual DOM在Reac.js會是物件，那麼屬性會是什麼？ ->->-> `其屬性(property)會有對應Real DOM節點會有的資訊，如元素種類、屬性值(attribute)、包含的子節點會有什麼`
<!--SR:!2022-10-12,8,250-->


#🧠 ReactJS以Virtual DOM來定義畫面，可Virtual DOM能夠讓瀏覽器轉換成渲染指令來渲染畫面嗎？ ->->-> `不能`
<!--SR:!2022-10-14,10,250-->


#🧠 ReactJS以Virtual DOM來定義畫面，可Virtual DOM不能夠直接讓瀏覽器轉換成渲染指令來渲染畫面，那要如何做 ->->-> `在ReactJS層級上定義一個程式模組來幫助轉換成對應的Real DOM結構`
<!--SR:!2022-10-04,3,250-->

#🧠 Real DOM vs. Virtual DOM 本質上的差別？ ->->-> `Real DOM是代表著對應畫面並能夠讓瀏覽器解析成一系列渲染指令，Virtual DOM則是從Real DOM抽離出來的版本，其版本只能夠代表對應畫面，並不能夠直接被瀏覽器解析成一系列渲染指令`
<!--SR:!2022-10-04,3,250-->

#🧠 Real DOM vs. Virtual DOM，各自的用途為何 ->->-> `Real DOM是直接表達對應畫面且指示瀏覽器該如何渲染；Virtual DOM是從Real DOM抽離出來的版本，該版本僅描述對應畫面的 DOM結構，並沒辦法指示瀏覽器該如何渲染，用途為描述用的藍圖`
<!--SR:!2022-10-13,9,250-->

#🧠 Real DOM vs. Virtual DOM，誰能直接告知瀏覽器如何渲染->->-> `Real DOM 能直接指示 ； Virtual DOM沒辦法`
<!--SR:!2022-10-14,10,250-->

#🧠 Real DOM vs. Virtual DOM，如何指示瀏覽器來渲染畫面，不分直接或者間接 ->->-> `Real DOM 能直接指示 ； Virtual DOM 先轉換成對應Real DOM，然後以Real DOM來指示渲染畫面`
<!--SR:!2022-10-14,10,250-->

#🧠 Real DOM vs. Virtual DOM 差別(請簡答，共三個)->->-> `用途、誰能直接告知瀏覽器如何渲染、如何指示瀏覽器來渲染畫面，不分直接或者間接`
<!--SR:!2022-10-14,10,250-->




---
Status: #🌱 
Tags:
[[React]]
Links:
References:
[[@ithomeDay04DOM]]