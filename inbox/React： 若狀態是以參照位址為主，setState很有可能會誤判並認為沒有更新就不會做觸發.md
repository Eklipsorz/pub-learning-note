## æè¿°
[[@chenxuqinghymanXieReactDeShiHouChangChangTingDao2018]]
> Immutable ä¸­æ–‡ç¿»è­¯ç‚º**ä¸è®Šçš„**ï¼Œç°¡å–®ä¾†èªªï¼Œæˆ‘å€‘æ¯æ¬¡æ“ä½œ React state çš„æ™‚å€™ï¼ŒåŽŸæœ¬çš„ state æ˜¯ä¸è®Šçš„ï¼Œæœ‰è®Šæ›´åˆ°çš„ç‰©ä»¶è¨˜æ†¶é«”ä½ç½®è¦èˆ‡åŽŸæœ¬çš„è¨˜æ†¶é«”ä½ç½®ä¸åŒã€‚

> -   Reactåº•å±¤æºç¢¼æœ‰é˜²å‘†æ©Ÿåˆ¶ï¼Œå¦‚æžœä»Šå¤©useStateçš„è³‡æ–™ç‚ºç‰©ä»¶ï¼Œå‰‡è¦æ³¨æ„ç‰©ä»¶æ˜¯å‚³å€ä¸æ˜¯å‚³å€¼ï¼Œæ‰€ä»¥è¦æƒ³è¾¦æ³•åŠƒåˆ†æ–°çš„è¨˜æ†¶é«”ç©ºé–“å„²å­˜æ–°é™£åˆ—ï¼Œè®“ReactçŸ¥é“ç¾åœ¨çš„è³‡æ–™æ˜¯æ–°çš„ä½å€ä¸æ˜¯åŽŸæœ¬çš„ä½å€ã€‚


é‡é»žï¼š
- è‹¥useState æˆ–è€… state æ˜¯ä»¥ç‰©ä»¶ç‚ºä¸»çš„è©±ï¼Œæœƒä»¥æ¯æ¬¡çš„è¨˜æ†¶é«”ä½å€ä¸åŒæ‰æœƒæ›´æ”¹ç‹€æ…‹ï¼Œè‹¥ç›¸åŒçš„è©±ï¼Œå°±æœƒèªç‚ºç›¸åŒè€Œä¸æ›´æ–°å’Œè§¸ç™¼ï¼Œæ›è¨€ä¹‹ï¼Œè‹¥åœ¨åŒä¸€å€‹ç‰©ä»¶ä¸Šå¢žåŠ å±¬æ€§ï¼Œä¸¦ä¾æ­¤ä¾†è¦æ±‚æ›´æ–°ç‹€æ…‹çš„è©±ï¼Œæœƒå› ç‚ºå¢žåŠ å‰å’Œå¢žåŠ å¾Œçš„ç‰©ä»¶è¨˜æ†¶é«”ä½ç½®éƒ½ä¸€æ¨£è€Œä¸å…è¨±æ›´æ–°å’Œè§¸ç™¼
```
setState(object)
```
- è§£æ±ºè¾¦æ³•ç‚ºï¼š
	- é‡æ–°å»ºç«‹æ–°å€‹ç‰©ä»¶ä¾†å­˜æ”¾èˆŠç‹€æ…‹å’Œæ–°ç‹€æ…‹ï¼Œä¸¦å°‡æ–°ç‰©ä»¶æŒ‡å®šç‚ºsetStateè¦æ›´æ–°çš„ç‹€æ…‹
	```
	setState(newObject)
	```


### ç¯„ä¾‹1

åœ¨é€™è£¡ï¼Œç”±æ–¼usersåœ¨æ–°å¢žå‰å’Œæ–°å¢žå¾Œéƒ½æ˜¯ä¸€æ¨£çš„è¨˜æ†¶é«”ä½å€ï¼Œæ‰€ä»¥æœƒè¢«ç³»çµ±èªç‚ºæ²’è®Šå‹•è€Œä¸æ›´æ–°å’Œè§¸ç™¼
```
  const [users, setUsers] = useState(initUsers);
  const itemAddHandler = (data) => {
    const callback = (users) => {
      const newUsers = users;
      newUsers.unshift(data);
      return newUsers;
    };
    setUsers(callback);
  };
```

è§£æ³•ç‚ºï¼š
```
  const itemAddHandler = (data) => {
    const callback = (users) => {
      return [data, ...users];
    };
    setUsers(callback);
  };
```

## è¤‡ç¿’

#ðŸ§  è‹¥useState æˆ–è€… state æ˜¯ä»¥ç‰©ä»¶ç‚ºä¸»çš„è©±ï¼Œæœƒä»¥ä»€éº¼ä¾†å€åˆ†ç‹€æ…‹æ˜¯å¦æ”¹è®Šæ‰æœƒè§¸ç™¼æ›´æ–°å’Œæ¸²æŸ“ï¼Ÿ->->-> `ä¾æ“šè‘—ä½ç½®æ˜¯å¦ç›¸åŒï¼Œè‹¥ç›¸åŒå°±ä»£è¡¨æ²’æ”¹è®Šï¼Œè‹¥ä¸ç›¸åŒå°±ä»£è¡¨æ”¹è®Š`


#ðŸ§  è‹¥useState æˆ–è€… state æ˜¯ä»¥ç‰©ä»¶ç‚ºä¸»çš„è©±ï¼Œæœƒæ˜¯ä»¥ç‹€æ…‹çš„ä¸åŒä¾†å€åˆ†æ˜¯å¦æ”¹è®Šï¼Œé‚£éº¼ä¸åŒæœƒå¦‚ä½•ï¼Ÿç›¸åŒåˆæ˜¯å¦‚ä½•ï¼Ÿ ->->-> `ç›¸åŒçš„è©±ï¼Œæœƒä¸å…è¨±æ›´æ–°ç‹€æ…‹å’Œè§¸ç™¼ï¼›ä¸åŒçš„è©±ï¼Œå…è¨±æ›´æ–°ç‹€æ…‹å’Œè§¸ç™¼`


#ðŸ§  è‹¥ç‹€æ…‹ç‚ºä¸€å€‹ç‰©ä»¶ï¼Œä¸¦æ–¼åŒä¸€å€‹ç‰©ä»¶ä¸Šå¢žåŠ å±¬æ€§ï¼Œä¸¦ä¾æ­¤ä¾†è¦æ±‚æ›´æ–°ç‹€æ…‹çš„è©±ï¼Œè¦æ€Žéº¼åšæ‰èƒ½ç¢ºå¯¦æ›´æ–°ç‹€æ…‹ ->->-> `é‡æ–°å»ºç«‹æ–°å€‹ç‰©ä»¶ä¾†å­˜æ”¾èˆŠç‹€æ…‹å’Œæ–°ç‹€æ…‹ï¼Œä¸¦å°‡æ–°ç‰©ä»¶æŒ‡å®šç‚ºsetStateè¦æ›´æ–°çš„ç‹€æ…‹`

#ðŸ§  Reactï¼šè«‹å•é€™èƒ½æ­£å¸¸æ¸²æŸ“å‡ºæ–°å¢žçš„é …ç›®å—Žï¼Ÿ ç‚ºä»€éº¼![](https://res.cloudinary.com/dqfxgtyoi/image/upload/v1662403267/blog/react/state/object-wrong-useState-example_jwtgvz.png) ->->-> `ä¸èƒ½ï¼Œç”±æ–¼ç‹€æ…‹æ˜¯ä»¥ç‰©ä»¶ç‚ºä¸»ï¼Œæ‰€ä»¥æœƒä»¥åƒç…§ä½å€çš„ä¸åŒä¾†å€åˆ†æ˜¯å¦ç‹€æ…‹æ”¹è®Šï¼Œè‹¥ä¸ä¸€æ¨£å°±ç‹€æ…‹æ”¹è®Šï¼›åä¹‹ï¼Œè‹¥ä¸€æ¨£å°±ç‹€æ…‹ä¸æ”¹è®Šï¼Œåœ¨é€™è£¡æ˜¯å±¬æ–¼å¾Œè€…ï¼Œä½¿ç”¨ç›¸åŒçš„è¨˜æ†¶é«”ä½å€ä¾†å¢žåŠ æ–°å…ƒç´ ã€‚`

#ðŸ§  Reactï¼šä»¥ä¸‹ç¨‹å¼ç¢¼ä¸èƒ½å¤ æ¸²æŸ“å‡ºæ–°å¢žçš„é …ç›®ï¼Œè«‹å•å¦‚ä½•æ”¹å–„ï¼Œæ‰èƒ½ç§€å‡ºæ–°å¢žçš„å…§å®¹ï¼Ÿ![](https://res.cloudinary.com/dqfxgtyoi/image/upload/v1662403267/blog/react/state/object-wrong-useState-example_jwtgvz.png)->->-> ``


---
Status: #ðŸŒ± 
Tags:
[[React]]
Links:
References:
[[@reactReact2022]]
[[@chenxuqinghymanXieReactDeShiHouChangChangTingDao2018]]