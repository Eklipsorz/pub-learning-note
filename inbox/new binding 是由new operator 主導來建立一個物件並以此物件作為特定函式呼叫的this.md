## æè¿°
> ### **04ã€new ç¶å®š**

> æº–ç¢ºä¾†èªªï¼Œjs ä¸­çš„æ§‹é€ å‡½æ•¸åªæ˜¯ä½¿ç”¨ new èª¿ç”¨çš„æ™®é€šå‡½æ•¸ï¼Œå®ƒä¸¦ä¸æ˜¯ä¸€å€‹é¡ï¼Œæœ€çµ‚è¿”å›çš„å°è±¡ä¹Ÿä¸æ˜¯ä¸€å€‹å¯¦ä¾‹ï¼Œåªæ˜¯çˆ²äº†ä¾¿æ–¼ç†è§£ç¿’æ…£é€™éº¼èªªç½·äº†ã€‚

> é‚£éº¼ new ä¸€å€‹å‡½æ•¸ç©¶ç«Ÿç™¼ç”Ÿäº†ä»€éº¼å‘¢ï¼Œå¤§è‡´åˆ†çˆ²ä¸‰æ­¥ï¼š

> 1.  å‰µå»ºä¸€ä»½æ–°ç©ºç™½ç‰©ä»¶ï¼›
> 2.  å°‡æ–°å»ºæ§‹çš„ç‰©ä»¶è¨­å®šç‚ºé‚£å€‹å‡½å¼å‘¼å«çš„this binding
> 3.  å°‡ thiså’Œèª¿ç”¨åƒæ•¸å‚³çµ¦æ§‹é€ å™¨å°‡ç©ºç™½ç‰©ä»¶æ“æœ‰çš„å±¬æ€§ã€æ–¹æ³•é€²è¡Œå¡«å……ï¼›
   4.  è‹¥æ§‹é€ å™¨æ²’æœ‰æ‰‹å‹•è¿”å›å°è±¡ï¼Œå‰‡å›å‚³ç›®å‰ç‰©ä»¶
    

> é€™å€‹éç¨‹æˆ‘å€‘ç¨±ä¹‹çˆ²æ§‹é€ èª¿ç”¨ï¼Œæˆ‘å€‘ä¾†çœ‹å€‹ä¾‹å­ï¼š

```
function Fn(){
    this.name = 'è½é¢¨æ˜¯é¢¨';
};
let echo = new Fn();
echo.name//è½é¢¨æ˜¯é¢¨
```

> åœ¨ä¸Šæ–¹ä»£ç¢¼ä¸­ï¼Œæ§‹é€ èª¿ç”¨å‰µå»ºäº†ä¸€å€‹æ–°å°è±¡ echoï¼Œè€Œåœ¨å‡½æ•¸é«”å…§ï¼Œthis å°‡æŒ‡å‘æ–°å°è±¡ echo ä¸Šï¼ˆå¯ä»¥æŠ½è±¡ç†è§£çˆ²æ–°å°è±¡å°±æ˜¯ thisï¼‰ã€‚

> è‹¥å°æ–¼ new å…·é«”éç¨‹æœ‰ç–‘æƒ‘ï¼Œæˆ–è€…ä¸çŸ¥é“æ€éº¼æ‰‹å‹•å¯¦ç¾ä¸€å€‹ new æ–¹æ³•ï¼Œå¯ä»¥é–±è®€åšä¸»é€™ç¯‡æ–‡ç« Â js new ä¸€å€‹å°è±¡çš„éç¨‹ï¼Œå¯¦ç¾ä¸€å€‹ç°¡å–®çš„ new æ–¹æ³•


> ä»€éº¼æ˜¯å»ºæ§‹å™¨(constructor) ã€‚åœ¨JSä¸­ï¼Œå»ºæ§‹å™¨åªæ˜¯å‰é¢æ¥è‘—new operatorè¢«å‘¼å«çš„å‡½å¼ï¼Œä»–å€‘ä¸¦æ²’è¢«æ¥é™„åˆ°é¡åˆ¥ä¸Šï¼Œä¹Ÿä¸æœƒå¯¦é«”åŒ–ä¸€å€‹é¡åˆ¥ã€‚ä»–å€‘ç”šè‡³ä¸æ˜¯ä¸€ç¨®ç‰¹æ®Šçš„å‡½å¼ã€‚ä»–å€‘åªæ˜¯æ­£è¦çš„å‡½å¼ï¼Œä½†èª¿ç”¨æ™‚ï¼Œå…¶è¡Œç‚ºå¯¦è³ªä¸Šæ˜¯è¢«å‰é¢çš„newæ‰€æŒç®¡

> åœ¨å‡½å¼å‰é¢æ·»åŠ newé—œéµä¾†å‘¼å«å‡½å¼ï¼Œæœƒå¾å‡½å¼å‘¼å«è½‰æ›æˆå»ºæ§‹å¼å‘¼å«(constructor call)ï¼š
	- å¯¦éš›ä¸Šä¸¦æ²’æœ‰constructor functionï¼Œåªæœ‰å‡½å¼çš„å»ºæ§‹å‘¼å«(constructor call)

å…·é«”çš„å»ºæ§‹å‘¼å«æœƒæ˜¯ä»¥ä¸‹æµç¨‹
> 1.  å‰µå»ºä¸€ä»½æ–°ç©ºç™½ç‰©ä»¶ï¼›ï¼ˆå³ç‚ºå»ºæ§‹ constructorï¼‰
> 2.  è¨­å®šè©²ç‰©ä»¶çš„protype
> 3.  å°‡æ–°å»ºæ§‹çš„ç‰©ä»¶è¨­å®šç‚ºé‚£å€‹å»ºæ§‹å¼å‘¼å«çš„this
> 4.  åŸ·è¡Œå»ºæ§‹å¼å¥½è®“thiså’Œç›¸å°æ‡‰ç‰©ä»¶å±¬æ€§éƒ½å»ºç«‹å¥½
   4.  è‹¥æ§‹é€ å™¨æ²’æœ‰æ‰‹å‹•è¿”å›å°è±¡ï¼Œå‰‡å›å‚³ç›®å‰ç‰©ä»¶


é‡é»ï¼š
- function æœƒæ˜¯æŒ‡ç‰¹å®šå‡½å¼ï¼Œfunction()ç‚ºç‰¹å®šå‡½å¼çš„å‘¼å«ï¼Œè‹¥å‰é¢æ·»åŠ newé€™operatorå°±æ˜¯å¾å‡½å¼å‘¼å«è½‰æ›æˆå»ºæ§‹å¼å‘¼å«(constructor call) æˆ–è€… constructor å°±æ˜¯ new operator + function call 
- constructor call ä¸»è¦æœƒå»ºæ§‹ä¸€å€‹æ“æœ‰ç‰¹å®šæ–¹æ³•å’Œå±¬æ€§çš„ç‰©ä»¶ä¸¦å›å‚³ï¼Œè€Œfunctionå‰‡æ˜¯å…·é«”å®šç¾©ç‰©ä»¶æœƒæœ‰ä»€éº¼æ¨£å±¬æ€§å’Œæ–¹æ³•
- å…·é«”å»ºæ§‹å‘¼å«æœƒæ˜¯ä»¥ä¸‹æµç¨‹ï¼š
	- å»ºç«‹ä¸€å€‹æ–°ç©ºç™½ç‰©ä»¶
	- è¨­å®šè©²ç‰©ä»¶çš„protypeå±¬æ€§
	- å°‡æ–°ç©ºç™½ç‰©ä»¶è¨­å®šæˆfunctionå‘¼å«çš„this
	- åŸ·è¡Œfunctionå¥½è®“thiså’Œåƒæ•¸è¨­å®šå°æ‡‰ç‰©ä»¶
	- è‹¥constructor æ²’æœ‰æ‰‹å‹•å›å‚³ç‰©ä»¶ï¼Œå‰‡è‡ªå‹•å›å‚³ç›®å‰è¨­å®šå¥½çš„ç‰©ä»¶
- ç´°ç¯€ï¼š
	- å¯¦éš›ä¸Šæ˜¯ä¸å­˜åœ¨constructor functionï¼Œåªæœ‰å¾å‡½å¼å‘¼å«è½‰æ›è€Œä¾†çš„å»ºæ§‹å¼å‘¼å«
- new binding æ˜¯ç”±new operator ä¸»å°ä¾†å»ºç«‹ä¸€å€‹ç‰©ä»¶ä¸¦ä»¥æ­¤ç‰©ä»¶ä½œç‚ºç‰¹å®šå‡½å¼å‘¼å«çš„this



#### æ¡ˆä¾‹ 1

```
function Fn(){
    this.name = 'è½é¢¨æ˜¯é¢¨';
};
let echo = new Fn();
echo.name
```

```
function Fn(){
    this.name = 'è½é¢¨æ˜¯é¢¨';
};
let echo = new Fn();
echo.name//è½é¢¨æ˜¯é¢¨
```

#### æ¡ˆä¾‹ 2

```
function foo(a) {
	this.a = a;
}

var bar = new foo(2)
console.log(bar.a)
```

## è¤‡ç¿’

#ğŸ§  new binding æ˜¯ä»€éº¼æ¨£çš„binding ->->-> `ç”±new operator ä¾†ä¸»å°å»ºç«‹ä¸€å€‹ç‰©ä»¶ä¸¦ä»¥æ­¤ç‰©ä»¶è¨­å®šå‡½å¼å‘¼å«çš„this`

#ğŸ§  JSï¼šconstructor call æ˜¯ä»€éº¼ï¼Ÿ  ->->-> `åœ¨ç‰¹å®šå‡½å¼å‘¼å«å‰é¢æ·»åŠ newé€™operatorå°±æ˜¯å¾å‡½å¼å‘¼å«è½‰æ›æˆå»ºæ§‹å¼å‘¼å«(constructor call)`


#ğŸ§  JSï¼šconstructor call å›å‚³ä»€éº¼ï¼Ÿ ->->-> `ç‰©ä»¶`

#ğŸ§  JSï¼šconstructor çš„æ§‹æˆï¼Ÿ->->-> `new operator + function call `

#ğŸ§  JSï¼šconstructor call ä¸»è¦æ˜¯åšä»€éº¼ï¼Ÿ ->->-> `æœƒå»ºæ§‹ä¸€å€‹æ“æœ‰ç‰¹å®šæ–¹æ³•å’Œå±¬æ€§çš„ç‰©ä»¶ä¸¦å›å‚³`

#ğŸ§  function æœƒæ˜¯æŒ‡ç‰¹å®šå‡½å¼ï¼Œfunction()ç‚ºç‰¹å®šå‡½å¼çš„å‘¼å«ï¼Œè‹¥å‰é¢æ·»åŠ newé€™operatorå°±æ˜¯å¾å‡½å¼å‘¼å«è½‰æ›æˆå»ºæ§‹å¼å‘¼å«(constructor call)ï¼Œé‚£éº¼functionæœƒæ˜¯åšä»€éº¼ç”¨çš„ï¼Ÿ ->->-> `å…·é«”å®šç¾©ç‰©ä»¶æœƒæœ‰ä»€éº¼æ¨£å±¬æ€§å’Œæ–¹æ³•`

#ğŸ§  JSï¼šconstructor call å…·é«”æµç¨‹ç‚ºä½•ï¼Ÿ->->-> `	- å»ºç«‹ä¸€å€‹æ–°ç©ºç™½ç‰©ä»¶ - è¨­å®šè©²ç‰©ä»¶çš„protypeå±¬æ€§ - å°‡æ–°ç©ºç™½ç‰©ä»¶è¨­å®šæˆfunctionå‘¼å«çš„this - åŸ·è¡Œfunctionå¥½è®“thiså’Œåƒæ•¸è¨­å®šå°æ‡‰ç‰©ä»¶ - è‹¥constructor æ²’æœ‰æ‰‹å‹•å›å‚³ç‰©ä»¶ï¼Œå‰‡è‡ªå‹•å›å‚³ç›®å‰è¨­å®šå¥½çš„ç‰©ä»¶`


#ğŸ§  è«‹å•echo.nameæœƒæ˜¯ä»€éº¼ï¼Ÿ![](https://res.cloudinary.com/dqfxgtyoi/image/upload/v1665562058/blog/javascript/this-binding/new-binding/new-binding-example_xcsbfn.png) ->->-> `è½é¢¨æ˜¯é¢¨`

#ğŸ§  è«‹ç”¨ä¸‹é¢ç¨‹å¼ç¢¼ä¾†èªªæ˜new binding![](https://res.cloudinary.com/dqfxgtyoi/image/upload/v1665562058/blog/javascript/this-binding/new-binding/new-binding-example-result_yk8bq8.png) ->->-> `é¦–å…ˆ new operatoræœƒå…ˆå»ºç«‹ä¸€å€‹ç‰©ä»¶ï¼Œä¸¦ä¸”ç‚ºFné€™å‘¼å«è¨­å®šthisç‚ºé‚£æ–°ç‰©ä»¶ï¼Œæ¥è‘—åŸ·è¡ŒFnä¾†è¨­å®šname`



---
Status: #ğŸŒ± 
Tags:
[[JavaScript]]
Links:
References:
[[@readfogZhongJavaScriptDeBangDing]]