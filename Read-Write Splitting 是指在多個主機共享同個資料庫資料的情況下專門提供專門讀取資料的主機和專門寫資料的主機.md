## æè¿°

è®€å¯«åˆ†é›¢(Read/Write Splitting)æ˜¯æŒ‡åœ¨å¤šå€‹ä¸»æ©Ÿå…±äº«åŒå€‹è³‡æ–™åº«è³‡æ–™çš„æƒ…æ³ä¸‹å°ˆé–€æä¾›å°ˆé–€è®€å–è³‡æ–™çš„ä¸»æ©Ÿå’Œå°ˆé–€å¯«è³‡æ–™çš„ä¸»æ©Ÿï¼Œé€™äº›ä¸»æ©Ÿéƒ½ä¸æœƒæ˜¯ç›¸åŒçš„

### ä¸»è¦è§£æ±ºä»€éº¼æ¨£çš„å•é¡Œï¼Ÿ
1. è³‡æ–™åº«çš„è®€å¯«å£“åŠ›æœƒé›†ä¸­æ–¼åŒä¸€å€‹ä¸»æ©Ÿæˆ–è€…åŒä¸€å€‹ä¸»æ©Ÿç¾¤çµ„ï¼Œé€™ä½¿å¾—é€™äº›ä¸»æ©Ÿå®¹æ˜“ç•¶æ©Ÿã€å´©æ½°ã€ä¸å¤ªç©©å®š

### å…·é«”ä¾†èªªçš„è®€å¯«åˆ†é›¢
1. ç”±ç‰¹å®šä¸»æ©Ÿè² è²¬å…±äº«è‡ªå·±çš„è³‡æ–™åº«çµ¦å‰©ä¸‹çš„ä¸»æ©Ÿä¾†é”æˆ **å¤šå€‹ä¸»æ©Ÿå…±äº«åŒä¸€å€‹è³‡æ–™åº«è³‡æ–™**ï¼Œåœ¨é€™æƒ…æ³ä¸‹ï¼Œæœƒåˆ†é…è®€å–è³‡æ–™æ¬Šé™çµ¦ä¸€äº›ä¸»æ©Ÿï¼Œè€Œå¯«å…¥æ¬Šé™ä¹Ÿçµ¦å¦ä¸€éƒ¨åˆ†çš„ä¸»æ©Ÿï¼Œè®€å¯«æ¬Šé™è³¦äºˆçš„ä¸»æ©Ÿéƒ½ä¸æœƒç›¸åŒï¼Œçˆ¾å¾Œå®¢æˆ¶ç«¯æˆ–è€…ä½¿ç”¨è€…è‹¥è¦è®€å–è³‡æ–™ï¼Œå°±å»æ‰¾æ“æœ‰è®€å–æ¬Šé™çš„ä¸»æ©Ÿç™¼é€è®€è«‹æ±‚ï¼›è‹¥è¦å¯«å…¥è³‡æ–™ï¼Œå°±å»æ‰¾æ“æœ‰å¯«å…¥æ¬Šé™çš„ä¸»æ©Ÿç™¼é€å¯«è«‹æ±‚

ç„¶è€Œè®€å¯«åˆ†é›¢ä¸‹ï¼Œè‹¥æ“æœ‰å¯«å…¥æ¬Šé™çš„ä¸»æ©Ÿè®Šå¤šçš„è©±ï¼Œå¯èƒ½æœƒé€ æˆè³‡æ–™ä¸Šä¸ä¸€è‡´ï¼Œæˆ–è€…éœ€è¦æ§ç®¡é€™äº›ä¸»æ©Ÿå¯«å…¥çš„åŸ·è¡Œé †åºï¼Œä½¿ä»–å€‘ä¸æœƒåŒæ™‚å¯«å…¥åŒä¸€å€‹å€¼ï¼Œä»¥é€ æˆrace conditionã€‚

è€Œæ“æœ‰è®€æ¬Šé™çš„ä¸»æ©Ÿæ•¸é‡è‹¥è®Šå¤šçš„è©±ï¼Œæœƒä½¿å¾—masterè¦åŒæ­¥çš„æˆæœ¬ä¹Ÿè·Ÿè‘—å¢åŠ ï¼Œå› çˆ²masterä¸»æ©Ÿè¦å¤šå‘é€™ä¸€äº›ä¸»æ©ŸåŒæ­¥åŒä¸€ä»½è³‡æ–™ï¼Œç„¶è€Œä¹Ÿæœƒè€ƒé‡ç”±æ–¼è®€å–ä¸¦ä¸æœƒç”¢ç”Ÿä¸€è‡´æ€§ä»¥åŠä¸»æ©Ÿæ•¸è¶Šå¤šæœƒå¢åŠ è®€å–æ•ˆç‡ï¼Œæ‰€ä»¥æœƒé€éæ•¸é‡è®Šå¤šä¾†å¹³å‡åˆ†æ”¤åŒä¸€ä»½è³‡æ–™çš„è®€å–è«‹æ±‚ã€‚

#### å¯¦éš›è³¦äºˆå¯«æ¬Šé™çš„ä¸»æ©Ÿæ•¸
1. ç›¸å°æ–¼è¢«è³¦äºˆè®€æ¬Šé™çš„ä¸»æ©Ÿæ•¸è€Œè¨€ï¼Œé€šå¸¸æœƒç”±å°‘é‡çš„ä¸»æ©Ÿä¾†è¢«è³¦äºˆå¯«æ¬Šé™ï¼Œå¸¸è¦‹æ•¸é‡æœƒæ˜¯1å€‹

#### å¯¦éš›è³¦äºˆè®€æ¬Šé™
1. ç›¸å°æ–¼è¢«è³¦äºˆå¯«æ¬Šé™çš„ä¸»æ©Ÿæ•¸è€Œè¨€ï¼Œé€šå¸¸æœƒç”±è¼ƒå¤šçš„ä¸»æ©Ÿä¾†è¢«è³¦äºˆè®€æ¬Šé™ï¼Œå¸¸è¦‹æ•¸é‡æœƒæ˜¯1å€‹ä»¥ä¸Šï¼Œé€™ä¹ŸåŒ…å«è‘—masterä¸»æ©Ÿ

#### ç¸½çµï¼šå¸¸è¦‹è®€å¯«åˆ†é›¢çš„æ•¸é‡
1. è¢«è³¦äºˆå¯«æ¬Šé™çš„ä¸»æ©Ÿæ•¸æœƒæ˜¯1å€‹æˆ–è€…å°‘é‡ï¼Œè‡³å°‘æœƒæ¯”è³¦äºˆè®€æ¬Šé™çš„ä¸»æ©Ÿé‚„å°‘å¾ˆå¤š
2. è¢«è³¦äºˆè®€æ¬Šé™çš„ä¸»æ©Ÿæ•¸æœƒæ˜¯1å€‹ä»¥ä¸Šæˆ–è€…å¤šï¼Œè‡³å°‘æœƒæ¯”è³¦äºˆè®€æ¬Šé™çš„ä¸»æ©Ÿé‚„å¤šå¾ˆå¤š

#### Redis çš„è®€å¯«åˆ†é›¢
1. ä¸»è¦æœƒä»¥master-slaveçµæ§‹ä¾†å¯¦ç¾ï¼šç”±ä¸€å€‹masterä¸»æ©Ÿè² è²¬å°‡è³‡æ–™åº«è³‡æ–™å…±äº«çµ¦å¤šå€‹slaveä¸»æ©Ÿï¼Œä¾†è®“å¤§å®¶å…±äº«è‘—åŒå€‹è³‡æ–™ï¼Œæ¥è‘—è³¦äºˆå¯«æ¬Šé™çµ¦master ä¸»æ©Ÿï¼›è³¦äºˆè®€æ¬Šé™çµ¦slave ä¸»æ©Ÿ

### è®€å¯«åˆ†é›¢çš„å ´æ™¯
åœ¨é€™è£¡æœƒä»¥å¸¸è¦‹è®€å¯«åˆ†é›¢çš„æ•¸é‡ç‚ºä¸»ï¼š
1. é©ç”¨æ–¼è®€è«‹æ±‚é å¤§æ–¼å¯«è«‹æ±‚çš„å ´æ™¯ã€æ›´æ–°å°‘å’ŒæŸ¥è©¢å¤šçš„å ´æ™¯

> ç•¶æ¥­å‹™å°æ–¼è³‡æ–™åº«è®€èˆ‡å¯«çš„æ“ä½œæ•¸é‡å·®è·éå¸¸å¤§æ™‚ï¼Œç‚ºäº†é¿å…è³‡æ–™åº«çš„å¯«å…¥å½±éŸ¿æŸ¥è©¢çš„æ•ˆç‡æ™‚ï¼Œå»ºè­°æ¡ç”¨è®€å¯«åˆ†é›¢æŠ€è¡“ã€‚

> **PSï¼š**è³‡æ–™åº«ä¸ä¸€å®šè¦è®€å¯«åˆ†é›¢ï¼Œå¦‚æœç¨‹åºä½¿ç”¨è³‡æ–™åº«è¼ƒå¤šæ™‚ï¼Œè€Œæ›´æ–°å°‘ï¼ŒæŸ¥è©¢å¤šçš„æƒ…æ³ä¸‹æœƒè€ƒæ…®ä½¿ç”¨ï¼Œåˆ©ç”¨è³‡æ–™åº«ä¸»å¾åŒæ­¥ ï¼Œå¯ä»¥æ¸›å°‘è³‡æ–™åº«å£“åŠ›ï¼Œæé«˜æ€§èƒ½ã€‚

 >  å°æ–¼è®€æ“ä½œç‚ºä¸»çš„æ‡‰ç”¨ï¼Œå¯ä»¥ç¢ºä¿å¯«çš„ä¼ºæœå™¨å£“åŠ›æ›´å°ï¼Œè€Œè®€åˆå¯ä»¥æ¥å—é»æ™‚é–“ä¸Šçš„å»¶é²ã€‚  
  

## è¤‡ç¿’
#ğŸ§  Read/Write Splittingæ˜¯ä»€éº¼æ¨£çš„æŠ€è¡“ï¼Ÿ ->->-> `è®€å¯«åˆ†é›¢(Read/Write Splitting)æ˜¯æŒ‡åœ¨å¤šå€‹ä¸»æ©Ÿå…±äº«åŒå€‹è³‡æ–™åº«è³‡æ–™çš„æƒ…æ³ä¸‹å°ˆé–€æä¾›å°ˆé–€è®€å–è³‡æ–™çš„ä¸»æ©Ÿå’Œå°ˆé–€å¯«è³‡æ–™çš„ä¸»æ©Ÿï¼Œé€™äº›ä¸»æ©Ÿéƒ½ä¸æœƒæ˜¯ç›¸åŒçš„`

#ğŸ§  Read/Write Splitting ä¸»è¦è§£æ±ºä»€éº¼æ¨£çš„å•é¡Œï¼Ÿ ->->-> `ä¸»è¦è§£æ±ºè³‡æ–™åº«çš„è®€å¯«å£“åŠ›æœƒé›†ä¸­æ–¼åŒä¸€å€‹ä¸»æ©Ÿæˆ–è€…åŒä¸€å€‹ä¸»æ©Ÿç¾¤çµ„ï¼Œé€™ä½¿å¾—é€™äº›ä¸»æ©Ÿå®¹æ˜“ç•¶æ©Ÿã€å´©æ½°ã€ä¸å¤ªç©©å®š
`
#ğŸ§  Read/Write Splitting çš„å…·é«”å¯¦ç¾å¦‚ä½•å¯¦ç¾å…±äº«è³‡æ–™åº«ï¼Ÿ ->->-> `ç”±ç‰¹å®šä¸»æ©Ÿè² è²¬å…±äº«è‡ªå·±çš„è³‡æ–™åº«çµ¦å‰©ä¸‹çš„ä¸»æ©Ÿä¾†é”æˆ **å¤šå€‹ä¸»æ©Ÿå…±äº«åŒä¸€å€‹è³‡æ–™åº«è³‡æ–™**`

#ğŸ§  Read/Write Splitting çš„å…·é«”å¯¦ç¾ä¸Šå¦‚ä½•åœ¨å…±äº«è³‡æ–™åº«ä¾†æŒ‡å®šè®€å¯«çš„ä¸»æ©Ÿç‚ºä½•ï¼Ÿ(æç¤º:æ¬Šé™)->->-> `åœ¨é€™æƒ…æ³ä¸‹ï¼Œæœƒåˆ†é…è®€å–è³‡æ–™æ¬Šé™çµ¦ä¸€äº›ä¸»æ©Ÿï¼Œè€Œå¯«å…¥æ¬Šé™ä¹Ÿçµ¦å¦ä¸€éƒ¨åˆ†çš„ä¸»æ©Ÿï¼Œè®€å¯«æ¬Šé™è³¦äºˆçš„ä¸»æ©Ÿéƒ½ä¸æœƒç›¸åŒï¼Œçˆ¾å¾Œå®¢æˆ¶ç«¯æˆ–è€…ä½¿ç”¨è€…è‹¥è¦è®€å–è³‡æ–™ï¼Œå°±å»æ‰¾æ“æœ‰è®€å–æ¬Šé™çš„ä¸»æ©Ÿç™¼é€è®€è«‹æ±‚ï¼›è‹¥è¦å¯«å…¥è³‡æ–™ï¼Œå°±å»æ‰¾æ“æœ‰å¯«å…¥æ¬Šé™çš„ä¸»æ©Ÿç™¼é€å¯«è«‹æ±‚`

#ğŸ§  Read/Write Splitting ä¸‹çš„å¯«æ¬Šé™ä¸»æ©Ÿæ•¸éœ€è¦è€ƒé‡åˆ°ä»€éº¼æ¨£çš„å•é¡Œï¼ˆæç¤ºï¼šä¸€è‡´æ€§) ->->-> `ç„¶è€Œè®€å¯«åˆ†é›¢ä¸‹ï¼Œè‹¥æ“æœ‰å¯«å…¥æ¬Šé™çš„ä¸»æ©Ÿè®Šå¤šçš„è©±ï¼Œå¯èƒ½æœƒé€ æˆè³‡æ–™ä¸Šä¸ä¸€è‡´ï¼Œæˆ–è€…éœ€è¦æ§ç®¡é€™äº›ä¸»æ©Ÿå¯«å…¥çš„åŸ·è¡Œé †åºï¼Œä½¿ä»–å€‘ä¸æœƒåŒæ™‚å¯«å…¥åŒä¸€å€‹å€¼ï¼Œä»¥é€ æˆrace conditionã€‚`

#ğŸ§  Read/Write Splitting ä¸‹çš„è®€æ¬Šé™ä¸»æ©Ÿæ•¸éœ€è¦è€ƒé‡åˆ°ä»€éº¼æ¨£çš„å•é¡Œï¼ˆæç¤ºï¼šåŒæ­¥æˆæœ¬å¥½å¤šå–”ã€æˆ‘è¦è®€åå€‹) ->->-> `æ“æœ‰è®€æ¬Šé™çš„ä¸»æ©Ÿæ•¸é‡è‹¥è®Šå¤šçš„è©±ï¼Œæœƒä½¿å¾—masterè¦åŒæ­¥çš„æˆæœ¬ä¹Ÿè·Ÿè‘—å¢åŠ ï¼Œå› çˆ²masterä¸»æ©Ÿè¦å¤šå‘é€™ä¸€äº›ä¸»æ©ŸåŒæ­¥åŒä¸€ä»½è³‡æ–™ï¼Œç„¶è€Œä¹Ÿæœƒè€ƒé‡ç”±æ–¼è®€å–ä¸¦ä¸æœƒç”¢ç”Ÿä¸€è‡´æ€§ä»¥åŠä¸»æ©Ÿæ•¸è¶Šå¤šæœƒå¢åŠ è®€å–æ•ˆç‡ï¼Œæ‰€ä»¥æœƒé€éæ•¸é‡è®Šå¤šä¾†å¹³å‡åˆ†æ”¤åŒä¸€ä»½è³‡æ–™çš„è®€å–è«‹æ±‚ã€‚`

#ğŸ§  Read/Write Splitting ï¼šå¯¦éš›è³¦äºˆå¯«æ¬Šé™çš„ä¸»æ©Ÿæ•¸ æœƒæ˜¯ï¼Ÿ(æç¤ºï¼šè«‹æ‹¿è®€æ¬Šé™çš„ä¸»æ©Ÿæ•¸ä¾†æ¯”è¼ƒ)->->-> `ç›¸å°æ–¼è¢«è³¦äºˆè®€æ¬Šé™çš„ä¸»æ©Ÿæ•¸è€Œè¨€ï¼Œé€šå¸¸æœƒç”±å°‘é‡çš„ä¸»æ©Ÿä¾†è¢«è³¦äºˆå¯«æ¬Šé™ï¼Œå¸¸è¦‹æ•¸é‡æœƒæ˜¯1å€‹`

#ğŸ§  Read/Write Splitting ï¼šå¯¦éš›è³¦äºˆè®€æ¬Šé™çš„ä¸»æ©Ÿæ•¸ æœƒæ˜¯ï¼Ÿ(æç¤ºï¼šè«‹æ‹¿å¯«æ¬Šé™çš„ä¸»æ©Ÿæ•¸ä¾†æ¯”è¼ƒ) ->->-> `ç›¸å°æ–¼è¢«è³¦äºˆå¯«æ¬Šé™çš„ä¸»æ©Ÿæ•¸è€Œè¨€ï¼Œé€šå¸¸æœƒç”±è¼ƒå¤šçš„ä¸»æ©Ÿä¾†è¢«è³¦äºˆè®€æ¬Šé™ï¼Œå¸¸è¦‹æ•¸é‡æœƒæ˜¯1å€‹ä»¥ä¸Šï¼Œé€™ä¹ŸåŒ…å«è‘—masterä¸»æ©Ÿ`


#ğŸ§  Read/Write Splitting çš„å ´æ™¯ç‚ºä½•ï¼Ÿ (ä»¥1å€‹å¯«æ¬Šé™ä¸»æ©Ÿå’Œå¤šå€‹è®€æ¬Šé™ä¸»æ©Ÿä¾†èªªæ˜)->->-> `é©ç”¨æ–¼è®€è«‹æ±‚é å¤§æ–¼å¯«è«‹æ±‚çš„å ´æ™¯ã€æ›´æ–°å°‘å’ŒæŸ¥è©¢å¤šçš„å ´æ™¯`

---
Status: #ğŸŒ± 
Tags:
[[Database]]
Links:
[[redis master-slave æ¶æ§‹æ˜¯ masterä¸»æ©Ÿè² è²¬å°è³‡æ–™åšå¯«å…¥ï¼Œslaveä¸»æ©Ÿè² è²¬å°è³‡æ–™åšå­˜å–]]
References:
[[@laowangtanyunweiWeiShiMoZiLiaoKuDuXieFenLiNengTiGaoZiLiaoKuDeXingNeng]]
